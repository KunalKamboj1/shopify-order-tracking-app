import{h as Cw,i as Pw}from"/build/_shared/chunk-6NMBHPI4.js";import{m as xw,n as Ow}from"/build/_shared/chunk-OBODZUPL.js";import{a as y,b as p,c as Ft,d as Tu,e as P,f as Rw,h as Ts}from"/build/_shared/chunk-G3AUNIWY.js";var Iu=p((M1,Tw)=>{Tw.exports={Polaris:{ActionMenu:{Actions:{moreActions:"More actions"},RollupActions:{rollupButton:"View actions"}},ActionList:{SearchField:{clearButtonLabel:"Clear",search:"Search",placeholder:"Search actions"}},Avatar:{label:"Avatar",labelWithInitials:"Avatar with initials {initials}"},Autocomplete:{spinnerAccessibilityLabel:"Loading",ellipsis:"{content}\u2026"},Badge:{PROGRESS_LABELS:{incomplete:"Incomplete",partiallyComplete:"Partially complete",complete:"Complete"},TONE_LABELS:{info:"Info",success:"Success",warning:"Warning",critical:"Critical",attention:"Attention",new:"New",readOnly:"Read-only",enabled:"Enabled"},progressAndTone:"{toneLabel} {progressLabel}"},Banner:{dismissButton:"Dismiss notification"},Button:{spinnerAccessibilityLabel:"Loading"},Common:{checkbox:"checkbox",undo:"Undo",cancel:"Cancel",clear:"Clear",close:"Close",submit:"Submit",more:"More"},ContextualSaveBar:{save:"Save",discard:"Discard"},DataTable:{sortAccessibilityLabel:"sort {direction} by",navAccessibilityLabel:"Scroll table {direction} one column",totalsRowHeading:"Totals",totalRowHeading:"Total"},DatePicker:{previousMonth:"Show previous month, {previousMonthName} {showPreviousYear}",nextMonth:"Show next month, {nextMonth} {nextYear}",today:"Today ",start:"Start of range",end:"End of range",months:{january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},days:{monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday"},daysAbbreviated:{monday:"Mo",tuesday:"Tu",wednesday:"We",thursday:"Th",friday:"Fr",saturday:"Sa",sunday:"Su"}},DiscardConfirmationModal:{title:"Discard all unsaved changes",message:"If you discard changes, you\u2019ll delete any edits you made since you last saved.",primaryAction:"Discard changes",secondaryAction:"Continue editing"},DropZone:{single:{overlayTextFile:"Drop file to upload",overlayTextImage:"Drop image to upload",overlayTextVideo:"Drop video to upload",actionTitleFile:"Add file",actionTitleImage:"Add image",actionTitleVideo:"Add video",actionHintFile:"or drop file to upload",actionHintImage:"or drop image to upload",actionHintVideo:"or drop video to upload",labelFile:"Upload file",labelImage:"Upload image",labelVideo:"Upload video"},allowMultiple:{overlayTextFile:"Drop files to upload",overlayTextImage:"Drop images to upload",overlayTextVideo:"Drop videos to upload",actionTitleFile:"Add files",actionTitleImage:"Add images",actionTitleVideo:"Add videos",actionHintFile:"or drop files to upload",actionHintImage:"or drop images to upload",actionHintVideo:"or drop videos to upload",labelFile:"Upload files",labelImage:"Upload images",labelVideo:"Upload videos"},errorOverlayTextFile:"File type is not valid",errorOverlayTextImage:"Image type is not valid",errorOverlayTextVideo:"Video type is not valid"},EmptySearchResult:{altText:"Empty search results"},Frame:{skipToContent:"Skip to content",navigationLabel:"Navigation",Navigation:{closeMobileNavigationLabel:"Close navigation"}},FullscreenBar:{back:"Back",accessibilityLabel:"Exit fullscreen mode"},Filters:{moreFilters:"More filters",moreFiltersWithCount:"More filters ({count})",filter:"Filter {resourceName}",noFiltersApplied:"No filters applied",cancel:"Cancel",done:"Done",clearAllFilters:"Clear all filters",clear:"Clear",clearLabel:"Clear {filterName}",addFilter:"Add filter",clearFilters:"Clear all",searchInView:"in:{viewName}"},FilterPill:{clear:"Clear",unsavedChanges:"Unsaved changes - {label}"},IndexFilters:{searchFilterTooltip:"Search and filter",searchFilterTooltipWithShortcut:"Search and filter (F)",searchFilterAccessibilityLabel:"Search and filter results",sort:"Sort your results",addView:"Add a new view",newView:"Custom search",SortButton:{ariaLabel:"Sort the results",tooltip:"Sort",title:"Sort by",sorting:{asc:"Ascending",desc:"Descending",az:"A-Z",za:"Z-A"}},EditColumnsButton:{tooltip:"Edit columns",accessibilityLabel:"Customize table column order and visibility"},UpdateButtons:{cancel:"Cancel",update:"Update",save:"Save",saveAs:"Save as",modal:{title:"Save view as",label:"Name",sameName:"A view with this name already exists. Please choose a different name.",save:"Save",cancel:"Cancel"}}},IndexProvider:{defaultItemSingular:"Item",defaultItemPlural:"Items",allItemsSelected:"All {itemsLength}+ {resourceNamePlural} are selected",selected:"{selectedItemsCount} selected",a11yCheckboxDeselectAllSingle:"Deselect {resourceNameSingular}",a11yCheckboxSelectAllSingle:"Select {resourceNameSingular}",a11yCheckboxDeselectAllMultiple:"Deselect all {itemsLength} {resourceNamePlural}",a11yCheckboxSelectAllMultiple:"Select all {itemsLength} {resourceNamePlural}"},IndexTable:{emptySearchTitle:"No {resourceNamePlural} found",emptySearchDescription:"Try changing the filters or search term",onboardingBadgeText:"New",resourceLoadingAccessibilityLabel:"Loading {resourceNamePlural}\u2026",selectAllLabel:"Select all {resourceNamePlural}",selected:"{selectedItemsCount} selected",undo:"Undo",selectAllItems:"Select all {itemsLength}+ {resourceNamePlural}",selectItem:"Select {resourceName}",selectButtonText:"Select",sortAccessibilityLabel:"sort {direction} by"},Loading:{label:"Page loading bar"},Modal:{iFrameTitle:"body markup",modalWarning:"These required properties are missing from Modal: {missingProps}"},Page:{Header:{rollupActionsLabel:"View actions for {title}",pageReadyAccessibilityLabel:"{title}. This page is ready"}},Pagination:{previous:"Previous",next:"Next",pagination:"Pagination"},ProgressBar:{negativeWarningMessage:"Values passed to the progress prop shouldn\u2019t be negative. Resetting {progress} to 0.",exceedWarningMessage:"Values passed to the progress prop shouldn\u2019t exceed 100. Setting {progress} to 100."},ResourceList:{sortingLabel:"Sort by",defaultItemSingular:"item",defaultItemPlural:"items",showing:"Showing {itemsCount} {resource}",showingTotalCount:"Showing {itemsCount} of {totalItemsCount} {resource}",loading:"Loading {resource}",selected:"{selectedItemsCount} selected",allItemsSelected:"All {itemsLength}+ {resourceNamePlural} in your store are selected",allFilteredItemsSelected:"All {itemsLength}+ {resourceNamePlural} in this filter are selected",selectAllItems:"Select all {itemsLength}+ {resourceNamePlural} in your store",selectAllFilteredItems:"Select all {itemsLength}+ {resourceNamePlural} in this filter",emptySearchResultTitle:"No {resourceNamePlural} found",emptySearchResultDescription:"Try changing the filters or search term",selectButtonText:"Select",a11yCheckboxDeselectAllSingle:"Deselect {resourceNameSingular}",a11yCheckboxSelectAllSingle:"Select {resourceNameSingular}",a11yCheckboxDeselectAllMultiple:"Deselect all {itemsLength} {resourceNamePlural}",a11yCheckboxSelectAllMultiple:"Select all {itemsLength} {resourceNamePlural}",Item:{actionsDropdownLabel:"Actions for {accessibilityLabel}",actionsDropdown:"Actions dropdown",viewItem:"View details for {itemName}"},BulkActions:{actionsActivatorLabel:"Actions",moreActionsActivatorLabel:"More actions"}},SkeletonPage:{loadingLabel:"Page loading"},Tabs:{newViewAccessibilityLabel:"Create new view",newViewTooltip:"Create view",toggleTabsLabel:"More views",Tab:{rename:"Rename view",duplicate:"Duplicate view",edit:"Edit view",editColumns:"Edit columns",delete:"Delete view",copy:"Copy of {name}",deleteModal:{title:"Delete view?",description:"This can\u2019t be undone. {viewName} view will no longer be available in your admin.",cancel:"Cancel",delete:"Delete view"}},RenameModal:{title:"Rename view",label:"Name",cancel:"Cancel",create:"Save",errors:{sameName:"A view with this name already exists. Please choose a different name."}},DuplicateModal:{title:"Duplicate view",label:"Name",cancel:"Cancel",create:"Create view",errors:{sameName:"A view with this name already exists. Please choose a different name."}},CreateViewModal:{title:"Create new view",label:"Name",cancel:"Cancel",create:"Create view",errors:{sameName:"A view with this name already exists. Please choose a different name."}}},Tag:{ariaLabel:"Remove {children}"},TextField:{characterCount:"{count} characters",characterCountWithMaxLength:"{count} of {limit} characters used"},TooltipOverlay:{accessibilityLabel:"Tooltip: {label}"},TopBar:{toggleMenuLabel:"Toggle menu",SearchField:{clearButtonLabel:"Clear",search:"Search"}},MediaCard:{dismissButton:"Dismiss",popoverButton:"Actions"},VideoThumbnail:{playButtonA11yLabel:{default:"Play video",defaultWithDuration:"Play video of length {duration}",duration:{hours:{other:{only:"{hourCount} hours",andMinutes:"{hourCount} hours and {minuteCount} minutes",andMinute:"{hourCount} hours and {minuteCount} minute",minutesAndSeconds:"{hourCount} hours, {minuteCount} minutes, and {secondCount} seconds",minutesAndSecond:"{hourCount} hours, {minuteCount} minutes, and {secondCount} second",minuteAndSeconds:"{hourCount} hours, {minuteCount} minute, and {secondCount} seconds",minuteAndSecond:"{hourCount} hours, {minuteCount} minute, and {secondCount} second",andSeconds:"{hourCount} hours and {secondCount} seconds",andSecond:"{hourCount} hours and {secondCount} second"},one:{only:"{hourCount} hour",andMinutes:"{hourCount} hour and {minuteCount} minutes",andMinute:"{hourCount} hour and {minuteCount} minute",minutesAndSeconds:"{hourCount} hour, {minuteCount} minutes, and {secondCount} seconds",minutesAndSecond:"{hourCount} hour, {minuteCount} minutes, and {secondCount} second",minuteAndSeconds:"{hourCount} hour, {minuteCount} minute, and {secondCount} seconds",minuteAndSecond:"{hourCount} hour, {minuteCount} minute, and {secondCount} second",andSeconds:"{hourCount} hour and {secondCount} seconds",andSecond:"{hourCount} hour and {secondCount} second"}},minutes:{other:{only:"{minuteCount} minutes",andSeconds:"{minuteCount} minutes and {secondCount} seconds",andSecond:"{minuteCount} minutes and {secondCount} second"},one:{only:"{minuteCount} minute",andSeconds:"{minuteCount} minute and {secondCount} seconds",andSecond:"{minuteCount} minute and {secondCount} second"}},seconds:{other:"{secondCount} seconds",one:"{secondCount} second"}}}}}}});var Hu=p(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});var Iw="https://cdn.shopify.com/shopifycloud/app-bridge.js";Is.APP_BRIDGE_URL=Iw});function Kt(e){let t=unescape(encodeURIComponent(e));return Uint8Array.from(t,(r,n)=>t.charCodeAt(n))}function Hs(e){let t=String.fromCharCode.apply(null,e);return decodeURIComponent(escape(t))}function jt(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;for(let n of e)t.set(n,r),r+=n.length;return t}function qu(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var qs=y(()=>{});function Mu(e){return e instanceof Uint8Array?t=>e[t]:e}function Ms(e,t,r,n,o){let i=Mu(e),s=Mu(r);for(let a=0;a<o;++a)if(i(t+a)!==s(n+a))return!1;return!0}function Hw(e){let t=new Array(256).fill(e.length);if(e.length>1)for(let r=0;r<e.length-1;r++)t[e[r]]=e.length-1-r;return t}var Ue,xt,Un,ku,Du,Lu=y(()=>{qs();Ue=Symbol("Match"),xt=class{constructor(t){this._lookbehind=new Uint8Array,typeof t=="string"?this._needle=t=Kt(t):this._needle=t,this._lastChar=t[t.length-1],this._occ=Hw(t)}feed(t){let r=0,n,o=[];for(;r!==t.length;)[r,...n]=this._feed(t,r),o.push(...n);return o}end(){let t=this._lookbehind;return this._lookbehind=new Uint8Array,t}_feed(t,r){let n=[],o=-this._lookbehind.length;if(o<0){for(;o<0&&o<=t.length-this._needle.length;){let i=this._charAt(t,o+this._needle.length-1);if(i===this._lastChar&&this._memcmp(t,o,this._needle.length-1))return o>-this._lookbehind.length&&n.push(this._lookbehind.slice(0,this._lookbehind.length+o)),n.push(Ue),this._lookbehind=new Uint8Array,[o+this._needle.length,...n];o+=this._occ[i]}if(o<0)for(;o<0&&!this._memcmp(t,o,t.length-o);)o++;if(o>=0)n.push(this._lookbehind),this._lookbehind=new Uint8Array;else{let i=this._lookbehind.length+o;return i>0&&(n.push(this._lookbehind.slice(0,i)),this._lookbehind=this._lookbehind.slice(i)),this._lookbehind=Uint8Array.from(new Array(this._lookbehind.length+t.length),(s,a)=>this._charAt(t,a-this._lookbehind.length)),[t.length,...n]}}for(o+=r;o<=t.length-this._needle.length;){let i=t[o+this._needle.length-1];if(i===this._lastChar&&t[o]===this._needle[0]&&Ms(this._needle,0,t,o,this._needle.length-1))return o>r&&n.push(t.slice(r,o)),n.push(Ue),[o+this._needle.length,...n];o+=this._occ[i]}if(o<t.length){for(;o<t.length&&(t[o]!==this._needle[0]||!Ms(t,o,this._needle,0,t.length-o));)++o;o<t.length&&(this._lookbehind=t.slice(o))}return o>0&&n.push(t.slice(r,o<t.length?o:t.length)),[t.length,...n]}_charAt(t,r){return r<0?this._lookbehind[this._lookbehind.length+r]:t[r]}_memcmp(t,r,n){return Ms(this._charAt.bind(this,t),r,this._needle,0,n)}},Un=class{constructor(t,r){this._readableStream=r,this._search=new xt(t)}async*[Symbol.asyncIterator](){let t=this._readableStream.getReader();try{for(;;){let n=await t.read();if(n.done)break;yield*this._search.feed(n.value)}let r=this._search.end();r.length&&(yield r)}finally{t.releaseLock()}}},ku=Symbol("End of Queue"),Du=class{constructor(t){this._chunksQueue=[],this._closed=!1,this._search=new xt(t)}push(...t){if(this._closed)throw new Error("cannot call push after close");this._chunksQueue.push(...t),this._notify&&this._notify()}close(){if(this._closed)throw new Error("close was already called");this._closed=!0,this._chunksQueue.push(ku),this._notify&&this._notify()}async*[Symbol.asyncIterator](){for(;;){let r;for(;!(r=this._chunksQueue.shift());)await new Promise(n=>this._notify=n),this._notify=void 0;if(r===ku)break;yield*this._search.feed(r)}let t=this._search.end();t.length&&(yield t)}}});function Mw(e){let t=e.split(";").map(n=>n.trim());if(t.shift()!=="form-data")throw new Error('malformed content-disposition header: missing "form-data" in `'+JSON.stringify(t)+"`");let r={};for(let n of t){let o=n.split("=",2);if(o.length!==2)throw new Error("malformed content-disposition header: key-value pair not found - "+n+" in `"+e+"`");let[i,s]=o;if(s[0]==='"'&&s[s.length-1]==='"')r[i]=s.slice(1,-1).replace(/\\"/g,'"');else if(s[0]!=='"'&&s[s.length-1]!=='"')r[i]=s;else if(s[0]==='"'&&s[s.length-1]!=='"'||s[0]!=='"'&&s[s.length-1]==='"')throw new Error("malformed content-disposition header: mismatched quotations in `"+e+"`")}if(!r.name)throw new Error("malformed content-disposition header: missing field name in `"+e+"`");return r}function kw(e){let t=[],r=!1,n;for(;typeof(n=e.shift())<"u";){let o=n.indexOf(":");if(o===-1)throw new Error("malformed multipart-form header: missing colon");let i=n.slice(0,o).trim().toLowerCase(),s=n.slice(o+1).trim();switch(i){case"content-disposition":r=!0,t.push(...Object.entries(Mw(s)));break;case"content-type":t.push(["contentType",s])}}if(!r)throw new Error("malformed multipart-form header: missing content-disposition");return Object.fromEntries(t)}async function Dw(e,t){let r=!0,n=!1,o=[[]],i=new xt(Ir);for(;;){let s=await e.next();if(s.done)throw new Error("malformed multipart-form data: unexpected end of stream");if(r&&s.value!==Ue&&qu(s.value.slice(0,2),$u))return[void 0,new Uint8Array];let a;if(s.value!==Ue)a=s.value;else if(!n)a=t;else throw new Error("malformed multipart-form data: unexpected boundary");if(!a.length)continue;r&&(r=!1);let c=i.feed(a);for(let[l,u]of c.entries()){let d=u===Ue;if(!(!d&&!u.length)){if(n&&d)return c.push(i.end()),[o.filter(h=>h.length).map(qw).map(Hs),jt(...c.slice(l+1).map(h=>h===Ue?Ir:h))];(n=d)?o.push([]):o[o.length-1].push(u)}}}}async function*Nu(e,t){let r=jt($u,Kt(t)),n=new Un(r,e)[Symbol.asyncIterator]();for(;;){let i=await n.next();if(i.done)return;if(i.value===Ue)break}let o=new xt(Ir);for(;;){let l=function(f){let m=[];for(let g of o.feed(f))c&&m.push(Ir),(c=g===Ue)||m.push(g);return jt(...m)},[i,s]=await Dw(n,r);if(!i)return;async function a(){let f=await n.next();if(f.done)throw new Error("malformed multipart-form data: unexpected end of stream");return f}let c=!1,u=!1;async function d(){let f=await a(),m;if(f.value!==Ue)m=f.value;else if(!c)m=Ir;else return u=!0,{value:o.end()};return{value:l(m)}}let h=[{value:l(s)}];for(yield{...kw(i),data:{[Symbol.asyncIterator](){return this},async next(){for(;;){let f=h.shift();if(!f)break;if(f.value.length>0)return f}for(;;){if(u)return{done:u,value:void 0};let f=await d();if(f.value.length>0)return f}}}};!u;)h.push(await d())}}var qw,$u,Ir,Uu=y(()=>{Lu();qs();qw=Function.prototype.apply.bind(jt,void 0),$u=Kt("--"),Ir=Kt(`\r
`)});var Ku=p((K1,Hr)=>{"use strict";var Fn={decodeValues:!0,map:!1,silent:!1};function ks(e){return typeof e=="string"&&!!e.trim()}function Ds(e,t){var r=e.split(";").filter(ks),n=r.shift(),o=Lw(n),i=o.name,s=o.value;t=t?Object.assign({},Fn,t):Fn;try{s=t.decodeValues?decodeURIComponent(s):s}catch(c){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+s+"'. Set options.decodeValues to false to disable this feature.",c)}var a={name:i,value:s};return r.forEach(function(c){var l=c.split("="),u=l.shift().trimLeft().toLowerCase(),d=l.join("=");u==="expires"?a.expires=new Date(d):u==="max-age"?a.maxAge=parseInt(d,10):u==="secure"?a.secure=!0:u==="httponly"?a.httpOnly=!0:u==="samesite"?a.sameSite=d:u==="partitioned"?a.partitioned=!0:a[u]=d}),a}function Lw(e){var t="",r="",n=e.split("=");return n.length>1?(t=n.shift(),r=n.join("=")):r=e,{name:t,value:r}}function Fu(e,t){if(t=t?Object.assign({},Fn,t):Fn,!e)return t.map?{}:[];if(e.headers)if(typeof e.headers.getSetCookie=="function")e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var r=e.headers[Object.keys(e.headers).find(function(o){return o.toLowerCase()==="set-cookie"})];!r&&e.headers.cookie&&!t.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=r}if(Array.isArray(e)||(e=[e]),t.map){var n={};return e.filter(ks).reduce(function(o,i){var s=Ds(i,t);return o[s.name]=s,o},n)}else return e.filter(ks).map(function(o){return Ds(o,t)})}function $w(e){if(Array.isArray(e))return e;if(typeof e!="string")return[];var t=[],r=0,n,o,i,s,a;function c(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function l(){return o=e.charAt(r),o!=="="&&o!==";"&&o!==","}for(;r<e.length;){for(n=r,a=!1;c();)if(o=e.charAt(r),o===","){for(i=r,r+=1,c(),s=r;r<e.length&&l();)r+=1;r<e.length&&e.charAt(r)==="="?(a=!0,r=s,t.push(e.substring(n,i)),n=r):r=i+1}else r+=1;(!a||r>=e.length)&&t.push(e.substring(n,e.length))}return t}Hr.exports=Fu;Hr.exports.parse=Fu;Hr.exports.parseString=Ds;Hr.exports.splitCookiesString=$w});var ju=p(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});var Nw=Rw(),Uw=(Pw(),P(Cw)),Fw=Ts();function Kw(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var jw=Kw(Nw),Ww=jw.default.forwardRef((e,t)=>{var r;return Fw.jsx(Uw.Link,{...e,to:(r=e.url)!==null&&r!==void 0?r:e.to,ref:t})});Ls.RemixPolarisLink=Ww});var Wu=p($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});var Bw=(Ow(),P(xw)),Jw=Iu(),Vw=Hu(),Gw=ju(),Kn=Ts();function zw(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Xw=zw(Jw);function Yw(e){let{children:t,apiKey:r,i18n:n,isEmbeddedApp:o=!0,__APP_BRIDGE_URL:i=Vw.APP_BRIDGE_URL,...s}=e;return Kn.jsxs(Kn.Fragment,{children:[o&&Kn.jsx("script",{src:i,"data-api-key":r}),Kn.jsx(Bw.AppProvider,{...s,linkComponent:Gw.RemixPolarisLink,i18n:n||Xw.default,children:t})]})}$s.AppProvider=Yw});var Zw=p(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});var Qw=Wu();Ns.AppProvider=Qw.AppProvider});var L={};Ft(L,{__addDisposableResource:()=>md,__assign:()=>jn,__asyncDelegator:()=>ad,__asyncGenerator:()=>sd,__asyncValues:()=>cd,__await:()=>Wt,__awaiter:()=>ed,__classPrivateFieldGet:()=>fd,__classPrivateFieldIn:()=>hd,__classPrivateFieldSet:()=>pd,__createBinding:()=>Bn,__decorate:()=>Vu,__disposeResources:()=>yd,__esDecorate:()=>zu,__exportStar:()=>rd,__extends:()=>Bu,__generator:()=>td,__importDefault:()=>dd,__importStar:()=>ud,__makeTemplateObject:()=>ld,__metadata:()=>Zu,__param:()=>Gu,__propKey:()=>Yu,__read:()=>Ks,__rest:()=>Ju,__rewriteRelativeImportExtension:()=>gd,__runInitializers:()=>Xu,__setFunctionName:()=>Qu,__spread:()=>nd,__spreadArray:()=>id,__spreadArrays:()=>od,__values:()=>Wn,default:()=>rb});function Bu(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Us(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Ju(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Vu(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function Gu(e,t){return function(r,n){t(r,n,e)}}function zu(e,t,r,n,o,i){function s(R){if(R!==void 0&&typeof R!="function")throw new TypeError("Function expected");return R}for(var a=n.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=!t&&e?n.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d,h=!1,f=r.length-1;f>=0;f--){var m={};for(var g in n)m[g]=g==="access"?{}:n[g];for(var g in n.access)m.access[g]=n.access[g];m.addInitializer=function(R){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(R||null))};var v=(0,r[f])(a==="accessor"?{get:u.get,set:u.set}:u[c],m);if(a==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=s(v.get))&&(u.get=d),(d=s(v.set))&&(u.set=d),(d=s(v.init))&&o.unshift(d)}else(d=s(v))&&(a==="field"?o.unshift(d):u[c]=d)}l&&Object.defineProperty(l,n.name,u),h=!0}function Xu(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function Yu(e){return typeof e=="symbol"?e:"".concat(e)}function Qu(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function Zu(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function ed(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(u){try{l(n.next(u))}catch(d){s(d)}}function c(u){try{l(n.throw(u))}catch(d){s(d)}}function l(u){u.done?i(u.value):o(u.value).then(a,c)}l((n=n.apply(e,t||[])).next())})}function td(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],o=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function rd(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Bn(t,e,r)}function Wn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ks(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function nd(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ks(arguments[t]));return e}function od(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function id(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function Wt(e){return this instanceof Wt?(this.v=e,this):new Wt(e)}function sd(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(f){return function(m){return Promise.resolve(m).then(f,d)}}function a(f,m){n[f]&&(o[f]=function(g){return new Promise(function(v,R){i.push([f,g,v,R])>1||c(f,g)})},m&&(o[f]=m(o[f])))}function c(f,m){try{l(n[f](m))}catch(g){h(i[0][3],g)}}function l(f){f.value instanceof Wt?Promise.resolve(f.value.v).then(u,d):h(i[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,m){f(m),i.shift(),i.length&&c(i[0][0],i[0][1])}}function ad(e){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,i){t[o]=e[o]?function(s){return(r=!r)?{value:Wt(e[o](s)),done:!1}:i?i(s):s}:i}}function cd(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Wn=="function"?Wn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,c){s=e[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}}function ld(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function ud(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Fs(e),n=0;n<r.length;n++)r[n]!=="default"&&Bn(t,e,r[n]);return eb(t,e),t}function dd(e){return e&&e.__esModule?e:{default:e}}function fd(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function pd(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r}function hd(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function md(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}function yd(e){function t(i){e.error=e.hasError?new tb(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,n=0;function o(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,function(s){return t(s),o()})}else n|=1}catch(s){t(s)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return o()}function gd(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,o,i,s){return n?t?".jsx":".js":o&&(!i||!s)?r:o+i+"."+s.toLowerCase()+"js"}):e}var Us,jn,Bn,eb,Fs,tb,rb,$=y(()=>{Us=function(e,t){return Us=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},Us(e,t)};jn=function(){return jn=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},jn.apply(this,arguments)};Bn=Object.create?function(e,t,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};eb=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Fs=function(e){return Fs=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Fs(e)};tb=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};rb={__extends:Bu,__assign:jn,__rest:Ju,__decorate:Vu,__param:Gu,__esDecorate:zu,__runInitializers:Xu,__propKey:Yu,__setFunctionName:Qu,__metadata:Zu,__awaiter:ed,__generator:td,__createBinding:Bn,__exportStar:rd,__values:Wn,__read:Ks,__spread:nd,__spreadArrays:od,__spreadArray:id,__await:Wt,__asyncGenerator:sd,__asyncDelegator:ad,__asyncValues:cd,__makeTemplateObject:ld,__importStar:ud,__importDefault:dd,__classPrivateFieldGet:fd,__classPrivateFieldSet:pd,__classPrivateFieldIn:hd,__addDisposableResource:md,__disposeResources:yd,__rewriteRelativeImportExtension:gd}});var W=p(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.FeatureDeprecatedError=_.BillingError=_.InvalidRequestError=_.UnsupportedClientType=_.MissingRequiredArgument=_.SessionStorageError=_.MissingWebhookCallbackError=_.InvalidWebhookError=_.InvalidSession=_.CookieNotFound=_.BotActivityDetected=_.InvalidOAuthError=_.GraphqlQueryError=_.RestResourceError=_.HttpThrottlingError=_.HttpInternalError=_.HttpRetriableError=_.HttpResponseError=_.HttpMaxRetriesError=_.HttpRequestError=_.PrivateAppError=_.SafeCompareError=_.InvalidDeliveryMethodError=_.MissingJwtTokenError=_.InvalidJwtError=_.InvalidHostError=_.InvalidShopError=_.InvalidHmacError=_.ShopifyError=void 0;var nb=($(),P(L)),F=class extends Error{constructor(...t){super(...t),Object.setPrototypeOf(this,new.target.prototype)}};_.ShopifyError=F;var js=class extends F{};_.InvalidHmacError=js;var Ws=class extends F{};_.InvalidShopError=Ws;var Bs=class extends F{};_.InvalidHostError=Bs;var Js=class extends F{};_.InvalidJwtError=Js;var Vs=class extends F{};_.MissingJwtTokenError=Vs;var Gs=class extends F{};_.InvalidDeliveryMethodError=Gs;var zs=class extends F{};_.SafeCompareError=zs;var Xs=class extends F{};_.PrivateAppError=Xs;var Ys=class extends F{};_.HttpRequestError=Ys;var Qs=class extends F{};_.HttpMaxRetriesError=Qs;var Jn=class extends F{constructor({message:t,code:r,statusText:n,body:o,headers:i}){super(t),this.response={code:r,statusText:n,body:o,headers:i}}};_.HttpResponseError=Jn;var qr=class extends Jn{};_.HttpRetriableError=qr;var Zs=class extends qr{};_.HttpInternalError=Zs;var ea=class extends qr{constructor(t){var{retryAfter:r}=t,n=nb.__rest(t,["retryAfter"]);super(n),this.response.retryAfter=r}};_.HttpThrottlingError=ea;var ta=class extends F{};_.RestResourceError=ta;var ra=class extends F{constructor({message:t,response:r,headers:n}){super(t),this.response=r,this.headers=n}};_.GraphqlQueryError=ra;var na=class extends F{};_.InvalidOAuthError=na;var oa=class extends F{};_.BotActivityDetected=oa;var ia=class extends F{};_.CookieNotFound=ia;var sa=class extends F{};_.InvalidSession=sa;var Vn=class extends F{constructor({message:t,response:r}){super(t),this.response=r}};_.InvalidWebhookError=Vn;var aa=class extends Vn{};_.MissingWebhookCallbackError=aa;var ca=class extends F{};_.SessionStorageError=ca;var la=class extends F{};_.MissingRequiredArgument=la;var ua=class extends F{};_.UnsupportedClientType=ua;var da=class extends F{};_.InvalidRequestError=da;var fa=class extends F{constructor({message:t,errorData:r}){super(t),this.message=t,this.errorData=r}};_.BillingError=fa;var pa=class extends F{};_.FeatureDeprecatedError=pa});var ma=p(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.crypto=st.setCrypto=void 0;var ha;st.crypto=ha;try{st.crypto=ha=crypto}catch{}function ob(e){st.crypto=ha=e}st.setCrypto=ob});var Ot=p(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.HashFormat=void 0;var ib;(function(e){e.Base64="base64",e.Hex="hex"})(ib=Mr.HashFormat||(Mr.HashFormat={}))});var va=p(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.hashString=Fe.asBase64=Fe.asHex=Fe.createSHA256HMAC=void 0;var sb=($(),P(L)),ab=W(),kr=ma(),zn=Ot();function cb(e,t,r=zn.HashFormat.Base64){return sb.__awaiter(this,void 0,void 0,function*(){let n=typeof(kr.crypto===null||kr.crypto===void 0?void 0:kr.crypto.webcrypto)>"u"?kr.crypto:kr.crypto.webcrypto;if(n?.subtle){let o=new TextEncoder,i=yield n.subtle.importKey("raw",o.encode(e),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=yield n.subtle.sign("HMAC",i,o.encode(t));return r===zn.HashFormat.Base64?ga(s):ya(s)}return n.createHmac("sha256",e).update(t).digest(r)})}Fe.createSHA256HMAC=cb;function ya(e){return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("")}Fe.asHex=ya;var Gn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ga(e){let t="",r=new Uint8Array(e);for(let n=0;n<r.length;){let o=r[n++],i=r[n++],s=r[n++],a=o>>2,c=(o&3)<<4|i>>4,l=(i&15)<<2|s>>6,u=s&63;isNaN(i)&&(l=64),isNaN(s)&&(u=64),t+=Gn[a]+Gn[c]+Gn[l]+Gn[u]}return t}Fe.asBase64=ga;function lb(e,t){let r=new TextEncoder().encode(e);switch(t){case zn.HashFormat.Base64:return ga(r);case zn.HashFormat.Hex:return ya(r);default:throw new ab.ShopifyError(`Unrecognized hash format '${t}'`)}}Fe.hashString=lb});var wa=p(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.splitN=void 0;function ub(e,t,r){let n=e.split(t),o=Math.min(Math.abs(r),n.length);return[...n.slice(0,o-1),n.slice(o-1).join(t)]}Xn.splitN=ub});var ba=p(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.flatHeaders=te.removeHeader=te.canonicalizeHeaders=te.addHeader=te.setHeader=te.getHeader=te.getHeaders=te.canonicalizeHeaderName=void 0;function Tt(e){return e.replace(/(^|-)(\w+)/g,(t,r,n)=>r+n.slice(0,1).toUpperCase()+n.slice(1).toLowerCase())}te.canonicalizeHeaderName=Tt;function wd(e,t){let r=[];if(!e)return r;let n=Tt(t);for(let[o,i]of Object.entries(e))Tt(o)===n&&(Array.isArray(i)?r.push(...i):r.push(i));return r}te.getHeaders=wd;function db(e,t){var r;if(e)return(r=wd(e,t))===null||r===void 0?void 0:r[0]}te.getHeader=db;function fb(e,t,r){Yn(e),e[Tt(t)]=[r]}te.setHeader=fb;function pb(e,t,r){Yn(e);let n=Tt(t),o=e[n];o?Array.isArray(o)||(o=[o]):o=[],e[n]=o,o.push(r)}te.addHeader=pb;function vd(e){return typeof e=="number"?e.toString():e}function Yn(e){for(let[t,r]of Object.entries(e)){let n=Tt(t);e[n]||(e[n]=[]),Array.isArray(e[n])||(e[n]=[vd(e[n])]),t!==n&&(delete e[t],e[n].push(...[r].flat().map(o=>vd(o))))}return e}te.canonicalizeHeaders=Yn;function hb(e,t){Yn(e);let r=Tt(t);delete e[r]}te.removeHeader=hb;function mb(e){return Object.entries(e).flatMap(([t,r])=>Array.isArray(r)?r.map(n=>[t,n]):[[t,r]])}te.flatHeaders=mb});var _d=p(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.Cookies=void 0;var Sa=($(),P(L)),bd=va(),Sd=wa(),Qn=ba(),It=class{constructor(t,r,{keys:n=[]}={}){var o,i;this.response=r,this.receivedCookieJar={},this.outgoingCookieJar={},this.keys=[],n&&(this.keys=n);let s=(o=(0,Qn.getHeader)(t.headers,"Cookie"))!==null&&o!==void 0?o:"";this.receivedCookieJar=It.parseCookies(s.split(";"));let a=(i=(0,Qn.getHeaders)(r.headers,"Set-Cookie"))!==null&&i!==void 0?i:[];this.outgoingCookieJar=It.parseCookies(a)}static parseCookies(t){let r=t.filter(o=>o.trim().length>0).map(o=>{let[i,...s]=o.split(";"),[a,c]=(0,Sd.splitN)(i,"=",2).map(l=>l.trim());return[a,Object.assign({name:a,value:c},Object.fromEntries(s.map(l=>(0,Sd.splitN)(l,"=",2).map(u=>u.trim()))))]}),n=Object.fromEntries(r);for(let o of Object.values(n))typeof o.expires=="string"&&(o.expires=new Date(o.expires));return n}static encodeCookie(t){let r="";return r+=`${t.name}=${t.value};`,r+=Object.entries(t).filter(([n])=>!["name","value","expires"].includes(n)).map(([n,o])=>`${n}=${o}`).join("; "),t.expires&&(r+=";",r+=`expires=${t.expires.toUTCString()}`),r}toHeaders(){return Object.values(this.outgoingCookieJar).map(t=>It.encodeCookie(t))}updateHeader(){this.response.headers||(this.response.headers={}),(0,Qn.removeHeader)(this.response.headers,"Set-Cookie"),this.toHeaders().map(t=>(0,Qn.addHeader)(this.response.headers,"Set-Cookie",t))}get(t){var r;return(r=this.receivedCookieJar[t])===null||r===void 0?void 0:r.value}deleteCookie(t){this.set(t,"",{path:"/",expires:new Date(0)})}getAndVerify(t){return Sa.__awaiter(this,void 0,void 0,function*(){let r=this.get(t);if(r&&(yield this.isSignedCookieValid(t)))return r})}get canSign(){var t;return((t=this.keys)===null||t===void 0?void 0:t.length)>0}set(t,r,n={}){this.outgoingCookieJar[t]=Object.assign(Object.assign({},n),{name:t,value:r}),this.updateHeader()}setAndSign(t,r,n={}){return Sa.__awaiter(this,void 0,void 0,function*(){if(!this.canSign)throw Error("No keys provided for signing.");this.set(t,r,n);let o=`${t}.sig`,i=yield(0,bd.createSHA256HMAC)(this.keys[0],r);this.set(o,i,n),this.updateHeader()})}isSignedCookieValid(t){return Sa.__awaiter(this,void 0,void 0,function*(){let r=`${t}.sig`;if(!this.get(t)||!this.get(r))return this.deleteCookie(r),this.deleteCookie(t),!1;let n=this.get(t),o=this.get(r);return(yield Promise.all(this.keys.map(s=>(0,bd.createSHA256HMAC)(s,n)))).includes(o)?!0:(this.deleteCookie(r),this.deleteCookie(t),!1)})}};Zn.Cookies=It});var Ad=p(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0})});var Xe=p(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.setAbstractConvertHeadersFunc=q.abstractConvertHeaders=q.setAbstractConvertResponseFunc=q.abstractConvertResponse=q.setAbstractConvertIncomingResponseFunc=q.abstractConvertIncomingResponse=q.setAbstractConvertRequestFunc=q.abstractConvertRequest=q.setAbstractFetchFunc=q.abstractFetch=q.isOK=void 0;var eo=($(),P(L));eo.__exportStar(_d(),q);eo.__exportStar(ba(),q);eo.__exportStar(wa(),q);eo.__exportStar(Ad(),q);function yb(e){return e.statusCode>=200&&e.statusCode<=299}q.isOK=yb;var gb=()=>{throw new Error("Missing adapter implementation for 'abstractFetch' - make sure to import the appropriate adapter for your platform")};q.abstractFetch=gb;function vb(e){q.abstractFetch=e}q.setAbstractFetchFunc=vb;var wb=()=>{throw new Error("Missing adapter implementation for 'abstractConvertRequest' - make sure to import the appropriate adapter for your platform")};q.abstractConvertRequest=wb;function bb(e){q.abstractConvertRequest=e}q.setAbstractConvertRequestFunc=bb;var Sb=()=>Promise.resolve({});q.abstractConvertIncomingResponse=Sb;function _b(e){q.abstractConvertIncomingResponse=e}q.setAbstractConvertIncomingResponseFunc=_b;var Eb=()=>{throw new Error("Missing adapter implementation for 'abstractConvertResponse' - make sure to import the appropriate adapter for your platform")};q.abstractConvertResponse=Eb;function Ab(e){q.abstractConvertResponse=e}q.setAbstractConvertResponseFunc=Ab;var Rb=()=>{throw new Error("Missing adapter implementation for 'abstractConvertHeaders' - make sure to import the appropriate adapter for your platform")};q.abstractConvertHeaders=Rb;function Cb(e){q.abstractConvertHeaders=e}q.setAbstractConvertHeadersFunc=Cb});var Ht=p(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});var _a=($(),P(L));_a.__exportStar(Ot(),Dr);_a.__exportStar(ma(),Dr);_a.__exportStar(va(),Dr)});var Cd=p(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0})});var Pd=p(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.setAbstractRuntimeString=qt.abstractRuntimeString=void 0;var Pb=()=>{throw new Error("Missing adapter implementation for 'abstractRuntimeString' - make sure to import the appropriate adapter for your platform")};qt.abstractRuntimeString=Pb;function xb(e){qt.abstractRuntimeString=e}qt.setAbstractRuntimeString=xb});var ro=p(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var xd=($(),P(L));xd.__exportStar(Cd(),to);xd.__exportStar(Pd(),to)});var Bt=p(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});var Ea=($(),P(L));Ea.__exportStar(Xe(),Lr);Ea.__exportStar(Ht(),Lr);Ea.__exportStar(ro(),Lr)});var Td=p(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.webApiRuntimeString=xe.webApiFetch=xe.webApiConvertResponse=xe.webApiConvertHeaders=xe.webApiConvertRequest=void 0;var oo=($(),P(L)),no=Bt();function Ob(e){var t;return oo.__awaiter(this,void 0,void 0,function*(){let r=e.rawRequest,n={};for(let[o,i]of r.headers.entries())(0,no.addHeader)(n,o,i);return{headers:n,method:(t=r.method)!==null&&t!==void 0?t:"GET",url:new URL(r.url).toString()}})}xe.webApiConvertRequest=Ob;function Od(e,t){return oo.__awaiter(this,void 0,void 0,function*(){let r=new Headers;return(0,no.flatHeaders)(e??{}).forEach(([n,o])=>r.append(n,o)),Promise.resolve(r)})}xe.webApiConvertHeaders=Od;function Tb(e,t){var r;return oo.__awaiter(this,void 0,void 0,function*(){return new Response(e.body,{status:e.statusCode,statusText:e.statusText,headers:yield Od((r=e.headers)!==null&&r!==void 0?r:{},t)})})}xe.webApiConvertResponse=Tb;function Ib({headers:e,method:t,url:r,body:n}){return oo.__awaiter(this,void 0,void 0,function*(){let o=yield fetch(r,{method:t,headers:(0,no.flatHeaders)(e),body:n}),i=yield o.text();return{statusCode:o.status,statusText:o.statusText,body:i,headers:(0,no.canonicalizeHeaders)(Object.fromEntries(o.headers.entries()))}})}xe.webApiFetch=Ib;function Hb(){return"Web API"}xe.webApiRuntimeString=Hb});var Aa=p(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var $r=Bt(),Nr=Td();(0,$r.setAbstractFetchFunc)(Nr.webApiFetch);(0,$r.setAbstractConvertRequestFunc)(Nr.webApiConvertRequest);(0,$r.setAbstractConvertResponseFunc)(Nr.webApiConvertResponse);(0,$r.setAbstractConvertHeadersFunc)(Nr.webApiConvertHeaders);(0,$r.setAbstractRuntimeString)(Nr.webApiRuntimeString)});var so={};Ft(so,{compare:()=>Dd,compareVersions:()=>kd,satisfies:()=>Mb,validate:()=>qb});var kd,qb,Dd,Mb,Ld,io,Hd,qd,kb,Db,Jt,$d,Md,Lb,ao=y(()=>{kd=(e,t)=>{let r=io(e),n=io(t),o=r.pop(),i=n.pop(),s=Jt(r,n);return s!==0?s:o&&i?Jt(o.split("."),i.split(".")):o||i?o?-1:1:0},qb=e=>typeof e=="string"&&/^[v\d]/.test(e)&&Ld.test(e),Dd=(e,t,r)=>{Lb(r);let n=kd(e,t);return $d[r].includes(n)},Mb=(e,t)=>{let r=t.match(/^([<>=~^]+)/),n=r?r[1]:"=";if(n!=="^"&&n!=="~")return Dd(e,t,n);let[o,i,s,,a]=io(e),[c,l,u,,d]=io(t),h=[o,i,s],f=[c,l??"x",u??"x"];if(d&&(!a||Jt(h,f)!==0||Jt(a.split("."),d.split("."))===-1))return!1;let m=f.findIndex(v=>v!=="0")+1,g=n==="~"?2:m>1?m:1;return!(Jt(h.slice(0,g),f.slice(0,g))!==0||Jt(h.slice(g),f.slice(g))===-1)},Ld=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,io=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");let t=e.match(Ld);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},Hd=e=>e==="*"||e==="x"||e==="X",qd=e=>{let t=parseInt(e,10);return isNaN(t)?e:t},kb=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],Db=(e,t)=>{if(Hd(e)||Hd(t))return 0;let[r,n]=kb(qd(e),qd(t));return r>n?1:r<n?-1:0},Jt=(e,t)=>{for(let r=0;r<Math.max(e.length,t.length);r++){let n=Db(e[r]||"0",t[r]||"0");if(n!==0)return n}return 0},$d={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Md=Object.keys($d),Lb=e=>{if(typeof e!="string")throw new TypeError(`Invalid operator type, expected string but got ${typeof e}`);if(Md.indexOf(e)===-1)throw new Error(`Invalid operator, expected one of ${Md.join("|")}`)}});var Ce=p(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.BillingReplacementBehavior=K.BillingInterval=K.gdprTopics=K.ClientType=K.ShopifyHeader=K.LATEST_API_VERSION=K.LIBRARY_NAME=K.ApiVersion=K.LogSeverity=void 0;var $b;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Debug=3]="Debug"})($b=K.LogSeverity||(K.LogSeverity={}));var Nd;(function(e){e.April22="2022-04",e.July22="2022-07",e.October22="2022-10",e.January23="2023-01",e.April23="2023-04",e.July23="2023-07",e.Unstable="unstable"})(Nd=K.ApiVersion||(K.ApiVersion={}));K.LIBRARY_NAME="Shopify API Library";K.LATEST_API_VERSION=Nd.July23;var Nb;(function(e){e.AccessToken="X-Shopify-Access-Token",e.ApiVersion="X-Shopify-API-Version",e.Domain="X-Shopify-Shop-Domain",e.Hmac="X-Shopify-Hmac-Sha256",e.Topic="X-Shopify-Topic",e.WebhookId="X-Shopify-Webhook-Id",e.StorefrontAccessToken="X-Shopify-Storefront-Access-Token",e.StorefrontPrivateToken="Shopify-Storefront-Private-Token",e.StorefrontSDKVariant="X-SDK-Variant",e.StorefrontSDKVersion="X-SDK-Version"})(Nb=K.ShopifyHeader||(K.ShopifyHeader={}));var Ub;(function(e){e.Rest="rest",e.Graphql="graphql"})(Ub=K.ClientType||(K.ClientType={}));K.gdprTopics=["CUSTOMERS_DATA_REQUEST","CUSTOMERS_REDACT","SHOP_REDACT"];var Fb;(function(e){e.OneTime="ONE_TIME",e.Every30Days="EVERY_30_DAYS",e.Annual="ANNUAL",e.Usage="USAGE"})(Fb=K.BillingInterval||(K.BillingInterval={}));var Kb;(function(e){e.ApplyImmediately="APPLY_IMMEDIATELY",e.ApplyOnNextBillingCycle="APPLY_ON_NEXT_BILLING_CYCLE",e.Standard="STANDARD"})(Kb=K.BillingReplacementBehavior||(K.BillingReplacementBehavior={}))});var Vt=p(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.SHOPIFY_API_LIBRARY_VERSION=void 0;co.SHOPIFY_API_LIBRARY_VERSION="7.7.0"});var Ud=p(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.log=void 0;var lo=Ce();function jb(e){return function(t,r,n={}){if(t>e.logger.level)return;let o=[];e.logger.timestamps&&o.push(`${new Date().toISOString().slice(0,-5)}Z`);let i=n.package||"shopify-api";switch(delete n.package,t){case lo.LogSeverity.Debug:i=`${i}/DEBUG`;break;case lo.LogSeverity.Info:i=`${i}/INFO`;break;case lo.LogSeverity.Warning:i=`${i}/WARNING`;break;case lo.LogSeverity.Error:i=`${i}/ERROR`;break}o.push(i);let s=[];Object.entries(n).forEach(([c,l])=>{s.push(`${c}: ${l}`)});let a="";s.length>0&&(a=` | {${s.join(", ")}}`),e.logger.log(t,`[${o.join("] [")}] ${r}${a}`)}}uo.log=jb});var Se=p(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.logger=void 0;var fo=($(),P(L)),Wb=(ao(),P(so)),Ur=Ce(),Bb=W(),Jb=Vt(),Vb=Ud();function Gb(e){let t=(0,Vb.log)(e);return{log:t,debug:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Ur.LogSeverity.Debug,r,n)}),info:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Ur.LogSeverity.Info,r,n)}),warning:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Ur.LogSeverity.Warning,r,n)}),error:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Ur.LogSeverity.Error,r,n)}),deprecated:zb(t)}}po.logger=Gb;function zb(e){return function(t,r){if((0,Wb.compare)(Jb.SHOPIFY_API_LIBRARY_VERSION,t,">="))throw new Bb.FeatureDeprecatedError(`Feature was deprecated in version ${t}`);return e(Ur.LogSeverity.Warning,`[Deprecated | ${t}] ${r}`)}}});var Fd=p(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.loadRestResources=void 0;var Xb=Se();function Yb({resources:e,config:t,RestClient:r}){let n=Object.keys(e)[0];return t.apiVersion!==e[n].apiVersion&&(0,Xb.logger)(t).warning(`Loading REST resources for API version ${e[n].apiVersion}, which doesn't match the default ${t.apiVersion}`),Object.fromEntries(Object.entries(e).map(([o,i])=>{class s extends i{}return s.setClassProperties({Client:r,config:t}),Object.entries(s.hasOne).map(([a,c])=>{c.setClassProperties({Client:r,config:t})}),Object.entries(s.hasMany).map(([a,c])=>{c.setClassProperties({Client:r,config:t})}),Reflect.defineProperty(s,"name",{value:o}),[o,s]}))}ho.loadRestResources=Yb});var Ra=p(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.AuthScopes=void 0;var Ie=class{constructor(t){let r=[];typeof t=="string"?r=t.split(new RegExp(`${Ie.SCOPE_DELIMITER}\\s*`)):Array.isArray(t)?r=t:t&&(r=Array.from(t.expandedScopes)),r=r.map(s=>s.trim()).filter(s=>s.length);let n=this.getImpliedScopes(r),o=new Set(r),i=new Set(n);this.compressedScopes=new Set([...o].filter(s=>!i.has(s))),this.expandedScopes=new Set([...o,...i])}has(t){let r;return t instanceof Ie?r=t:r=new Ie(t),r.toArray().filter(n=>!this.expandedScopes.has(n)).length===0}equals(t){let r;return t instanceof Ie?r=t:r=new Ie(t),this.compressedScopes.size===r.compressedScopes.size&&this.toArray().filter(n=>!r.has(n)).length===0}toString(){return this.toArray().join(Ie.SCOPE_DELIMITER)}toArray(){return[...this.compressedScopes]}getImpliedScopes(t){return t.reduce((r,n)=>{let o=n.match(/^(unauthenticated_)?write_(.*)$/);return o&&r.push(`${o[1]?o[1]:""}read_${o[2]}`),r},[])}};mo.AuthScopes=Ie;Ie.SCOPE_DELIMITER=","});var Ca=p(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.enableCodeAfterVersion=void 0;var Qb=(ao(),P(so)),Zb=Vt();function e0(e,t){(0,Qb.compare)(Zb.SHOPIFY_API_LIBRARY_VERSION,e,">=")&&t()}yo.enableCodeAfterVersion=e0});var jd=p(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.validateConfig=void 0;var t0=($(),P(L)),r0=W(),Gt=Ce(),Pa=Ra(),Kd=Se(),n0=Ca();function o0(e){var t;let r={apiKey:"",apiSecretKey:"",scopes:new Pa.AuthScopes([]),hostName:"",hostScheme:"https",apiVersion:Gt.LATEST_API_VERSION,isEmbeddedApp:!0,isCustomStoreApp:!1,logger:{log:s0,level:Gt.LogSeverity.Info,httpRequests:!1,timestamps:!1}},n=["apiSecretKey","hostName"];(!("isCustomStoreApp"in e)||!e.isCustomStoreApp)&&(n.push("apiKey"),n.push("scopes")),(0,n0.enableCodeAfterVersion)("8.0.0",()=>{var m;"isCustomStoreApp"in e&&e.isCustomStoreApp&&(!("adminApiAccessToken"in e)||((m=e.adminApiAccessToken)===null||m===void 0?void 0:m.length)===0)&&n.push("adminApiAccessToken")});let o=[];if(n.forEach(m=>{i0(e[m])||o.push(m)}),o.length)throw new r0.ShopifyError(`Cannot initialize Shopify API Library. Missing values for: ${o.join(", ")}`);let{hostScheme:i,isCustomStoreApp:s,adminApiAccessToken:a,userAgentPrefix:c,logger:l,privateAppStorefrontAccessToken:u,customShopDomains:d,billing:h}=e,f=t0.__rest(e,["hostScheme","isCustomStoreApp","adminApiAccessToken","userAgentPrefix","logger","privateAppStorefrontAccessToken","customShopDomains","billing"]);return Object.assign(r,f,{hostName:e.hostName.replace(/\/$/,""),scopes:e.scopes instanceof Pa.AuthScopes?e.scopes:new Pa.AuthScopes(e.scopes),hostScheme:i??r.hostScheme,isCustomStoreApp:s??r.isCustomStoreApp,adminApiAccessToken:a??r.adminApiAccessToken,userAgentPrefix:c??r.userAgentPrefix,logger:Object.assign(Object.assign({},r.logger),l||{}),privateAppStorefrontAccessToken:u??r.privateAppStorefrontAccessToken,customShopDomains:d??r.customShopDomains,billing:h??r.billing}),"isCustomStoreApp"in e&&e.isCustomStoreApp&&(!("adminApiAccessToken"in e)||((t=e.adminApiAccessToken)===null||t===void 0?void 0:t.length)===0?(0,Kd.logger)(r).deprecated("8.0.0","adminApiAccessToken should be set to the Admin API access token for custom store apps; apiSecretKey should be set to the custom store app's API secret key."):e.adminApiAccessToken===e.apiSecretKey&&(0,Kd.logger)(r).warning("adminApiAccessToken is set to the same value as apiSecretKey. adminApiAccessToken should be set to the Admin API access token for custom store apps; apiSecretKey should be set to the custom store app's API secret key.")),r}go.validateConfig=o0;function i0(e){return e==null?!1:typeof e=="string"||Array.isArray(e)?e.length>0:!0}function s0(e,t){switch(e){case Gt.LogSeverity.Debug:console.debug(t);break;case Gt.LogSeverity.Info:console.log(t);break;case Gt.LogSeverity.Warning:console.warn(t);break;case Gt.LogSeverity.Error:console.error(t);break}}});var Wd=p(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.Method=void 0;(function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Patch="PATCH",e.Delete="DELETE",e.Head="HEAD",e.Options="OPTIONS",e.Connect="CONNECT"})(C.Method||(C.Method={}));C.StatusCode=void 0;(function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported"})(C.StatusCode||(C.StatusCode={}));C.Header=void 0;(function(e){e.Accept="Accept",e.AcceptEncoding="Accept-Encoding",e.AcceptLanguage="Accept-Language",e.AccessControlAllowCredentials="Access-Control-Allow-Credentials",e.AccessControlAllowHeaders="Access-Control-Allow-Headers",e.AccessControlAllowMethods="Access-Control-Allow-Methods",e.AccessControlAllowOrigin="Access-Control-Allow-Origin",e.AccessControlExposeHeaders="Access-Control-Expose-Headers",e.AccessControlMaxAge="Access-Control-Max-Age",e.AccessControlRequestHeaders="Access-Control-Request-Headers",e.AccessControlRequestMethod="Access-Control-Request-Method",e.Authorization="Authorization",e.CacheControl="Cache-Control",e.CacheStatus="Cache-Status",e.Connection="Connection",e.ContentDisposition="Content-Disposition",e.ContentEncoding="Content-Encoding",e.ContentLength="Content-Length",e.ContentSecurityPolicy="Content-Security-Policy",e.ContentSecurityPolicyReportOnly="Content-Security-Policy-Report-Only",e.ContentType="Content-Type",e.ContentTypeOptions="X-Content-Type-Options",e.Cookie="Cookie",e.DownloadOptions="X-Download-Options",e.ETag="ETag",e.Forwarded="Forwarded",e.ForwardedFor="X-Forwarded-For",e.ForwardedHost="X-Forwarded-Host",e.ForwardedProtocol="X-Forwarded-Proto",e.FrameOptions="X-Frame-Options",e.Host="Host",e.IfNoneMatch="If-None-Match",e.Location="Location",e.Origin="Origin",e.ReferrerPolicy="Referrer-Policy",e.ServerTiming="Server-Timing",e.StrictTransportSecurity="Strict-Transport-Security",e.TimingAllowOrigin="Timing-Allow-Origin",e.Trailer="Trailer",e.TransferEncoding="Transfer-Encoding",e.UserAgent="User-Agent",e.WwwAuthenticate="WWW-Authenticate",e.XhrRedirectedTo="X-XHR-Redirected-To",e.XhrReferer="X-XHR-Referer",e.XssProtecton="X-XSS-Protection",e.XContentTypeOptions="X-Content-Type-Options",e.XDownloadOptions="X-Download-Options",e.XForwardedFor="X-Forwarded-For",e.XForwardedHost="X-Forwarded-Host",e.XForwardedProto="X-Forwarded-Proto",e.XFrameOptions="X-Frame-Options",e.XXhrRedirectedTo="X-XHR-Redirected-To",e.XXhrReferer="X-XHR-Referer",e.XXssProtecton="X-XSS-Protection",e.XXssProtection="X-XSS-Protection"})(C.Header||(C.Header={}));C.CspDirective=void 0;(function(e){e.ChildSrc="child-src",e.ConnectSrc="connect-src",e.DefaultSrc="default-src",e.FontSrc="font-src",e.FrameSrc="frame-src",e.ImgSrc="img-src",e.ManifestSrc="manifest-src",e.MediaSrc="media-src",e.ObjectSrc="object-src",e.PrefetchSrc="prefetch-src",e.ScriptSrc="script-src",e.StyleSrc="style-src",e.WebrtcSrc="webrtc-src",e.WorkerSrc="worker-src",e.BaseUri="base-uri",e.PluginTypes="plugin-types",e.Sandbox="sandbox",e.FormAction="form-action",e.FrameAncestors="frame-ancestors",e.ReportUri="report-uri",e.BlockAllMixedContent="block-all-mixed-content",e.RequireSriFor="require-sri-for",e.UpgradeInsecureRequests="upgrade-insecure-requests"})(C.CspDirective||(C.CspDirective={}));C.CspSandboxAllow=void 0;(function(e){e.Forms="allow-forms",e.SameOrigin="allow-same-origin",e.Scripts="allow-scripts",e.Popups="allow-popups",e.Modals="allow-modals",e.OrientationLock="allow-orientation-lock",e.PointerLock="allow-pointer-lock",e.Presentation="allow-presentation",e.PopupsToEscapeSandbox="allow-popups-to-escape-sandbox",e.TopNavigation="allow-top-navigation"})(C.CspSandboxAllow||(C.CspSandboxAllow={}));C.SpecialSource=void 0;(function(e){e.Any="*",e.Self="'self'",e.UnsafeInline="'unsafe-inline'",e.UnsafeEval="'unsafe-eval'",e.None="'none'",e.StrictDynamic="'strict-dynamic'",e.ReportSample="'report-sample'",e.Data="data:",e.Blob="blob:",e.FileSystem="filesystem:"})(C.SpecialSource||(C.SpecialSource={}));C.SriAsset=void 0;(function(e){e.Script="script",e.Style="style"})(C.SriAsset||(C.SriAsset={}));C.HashAlgorithm=void 0;(function(e){e.Sha256="sha256",e.Sha384="sha384",e.Sha512="sha512"})(C.HashAlgorithm||(C.HashAlgorithm={}));C.ResponseType=void 0;(function(e){e.Informational="1xx",e.Success="2xx",e.Redirection="3xx",e.ClientError="4xx",e.ServerError="5xx",e.Unknown="Unknown"})(C.ResponseType||(C.ResponseType={}));function a0(e){return e>=100&&e<200?C.ResponseType.Informational:e>=200&&e<300?C.ResponseType.Success:e>=300&&e<400?C.ResponseType.Redirection:e>=400&&e<500?C.ResponseType.ClientError:e>=500&&e<600?C.ResponseType.ServerError:C.ResponseType.Unknown}function c0(e){return`'nonce-${e}'`}function l0(e,t){return`'${e}-${t}'`}C.CacheControl=void 0;(function(e){e.NoCache="no-cache",e.NoStore="no-store",e.MustRevalidate="must-revalidate",e.MaxAge="max-age"})(C.CacheControl||(C.CacheControl={}));var u0=`${C.CacheControl.NoCache},${C.CacheControl.NoStore},${C.CacheControl.MustRevalidate},${C.CacheControl.MaxAge}=0`;C.getResponseType=a0;C.hashSource=l0;C.noCache=u0;C.nonceSource=c0});var Bd=p(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});var _e=Wd();Object.defineProperty(le,"CacheControl",{enumerable:!0,get:function(){return _e.CacheControl}});Object.defineProperty(le,"CspDirective",{enumerable:!0,get:function(){return _e.CspDirective}});Object.defineProperty(le,"CspSandboxAllow",{enumerable:!0,get:function(){return _e.CspSandboxAllow}});Object.defineProperty(le,"HashAlgorithm",{enumerable:!0,get:function(){return _e.HashAlgorithm}});Object.defineProperty(le,"Header",{enumerable:!0,get:function(){return _e.Header}});Object.defineProperty(le,"Method",{enumerable:!0,get:function(){return _e.Method}});Object.defineProperty(le,"ResponseType",{enumerable:!0,get:function(){return _e.ResponseType}});Object.defineProperty(le,"SpecialSource",{enumerable:!0,get:function(){return _e.SpecialSource}});Object.defineProperty(le,"SriAsset",{enumerable:!0,get:function(){return _e.SriAsset}});Object.defineProperty(le,"StatusCode",{enumerable:!0,get:function(){return _e.StatusCode}});le.getResponseType=_e.getResponseType;le.hashSource=_e.hashSource;le.noCache=_e.noCache;le.nonceSource=_e.nonceSource});var xa=p((vI,Jd)=>{Jd.exports=Bd()});var vo=p(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});var Fr=class{constructor(){this.processedQuery=new URLSearchParams}static stringify(t){return!t||Object.keys(t).length===0?"":new Fr().putAll(t).stringify()}putAll(t){return Object.entries(t).forEach(([r,n])=>this.put(r,n)),this}put(t,r){Array.isArray(r)?this.putArray(t,r):r?.constructor===Object?this.putObject(t,r):this.putSimple(t,r)}putArray(t,r){r.forEach(n=>this.processedQuery.append(`${t}[]`,`${n}`))}putObject(t,r){Object.entries(r).forEach(([n,o])=>{this.processedQuery.append(`${t}[${n}]`,`${o}`)})}putSimple(t,r){this.processedQuery.append(t,`${r}`)}stringify(t=!1){let r=this.processedQuery.toString();return t?r:`?${r}`}};Oa.default=Fr});var jr=p(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.DataType=void 0;var d0;(function(e){e.JSON="application/json",e.GraphQL="application/graphql",e.URLEncoded="application/x-www-form-urlencoded"})(d0=Kr.DataType||(Kr.DataType={}))});var Yt=p(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.httpClientClass=Xt.HttpClient=void 0;var Ye=($(),P(L)),at=xa(),ct=Ye.__importStar(W()),f0=Ce(),p0=Vt(),h0=Ye.__importDefault(vo()),m0=Ht(),y0=Ot(),zt=Xe(),g0=ro(),Vd=Se(),wo=jr(),lt=class{constructor(t){this.loggedDeprecations={},this.domain=t.domain}get(t){return Ye.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Get},t))})}post(t){return Ye.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Post},t))})}put(t){return Ye.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Put},t))})}delete(t){return Ye.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Delete},t))})}request(t){var r;return Ye.__awaiter(this,void 0,void 0,function*(){let n=t.tries?t.tries:1;if(n<=0)throw new ct.HttpRequestError(`Number of tries must be >= 0, got ${n}`);let o=`${f0.LIBRARY_NAME} v${p0.SHOPIFY_API_LIBRARY_VERSION} | ${(0,g0.abstractRuntimeString)()}`;this.httpClass().config.userAgentPrefix&&(o=`${this.httpClass().config.userAgentPrefix} | ${o}`),t.extraHeaders&&(t.extraHeaders["user-agent"]?(o=`${t.extraHeaders["user-agent"]} | ${o}`,delete t.extraHeaders["user-agent"]):t.extraHeaders["User-Agent"]&&(o=`${t.extraHeaders["User-Agent"]} | ${o}`));let i=Object.assign(Object.assign({},t.extraHeaders),{"User-Agent":o}),s;if(t.method===at.Method.Post||t.method===at.Method.Put){let d=(r=t.type)!==null&&r!==void 0?r:wo.DataType.JSON,h=t.data;if(h){switch(d){case wo.DataType.JSON:s=typeof h=="string"?h:JSON.stringify(h);break;case wo.DataType.URLEncoded:s=typeof h=="string"?h:new URLSearchParams(h).toString();break;case wo.DataType.GraphQL:s=h;break}i=Object.assign(Object.assign({},i),{"Content-Type":d,"Content-Length":new TextEncoder().encode(s).length})}}let a=`${this.httpClass().scheme}://${this.domain}${this.getRequestPath(t.path)}${h0.default.stringify(t.query)}`,c={method:t.method,url:a,headers:(0,zt.canonicalizeHeaders)(i),body:s};if(this.httpClass().config.logger.httpRequests){let d=["Making HTTP request",`${c.method} ${c.url}`,`Headers: ${JSON.stringify(i)}`];s&&d.push(`Body: ${JSON.stringify(s).replace(/\n/g,"\\n  ")}`),(0,Vd.logger)(this.httpClass().config).debug(d.join("  -  "))}function l(d){return Ye.__awaiter(this,void 0,void 0,function*(){return new Promise(h=>setTimeout(h,d))})}let u=0;for(;u<n;)try{return yield this.doRequest(c)}catch(d){if(u++,d instanceof ct.HttpRetriableError){if(u<n){let h=this.httpClass().RETRY_WAIT_TIME;d instanceof ct.HttpThrottlingError&&d.response.retryAfter&&(h=d.response.retryAfter*1e3),yield l(h);continue}if(n>1)throw new ct.HttpMaxRetriesError(`Exceeded maximum retry count of ${n}. Last message: ${d.message}`)}throw d}throw new ct.ShopifyError("Unexpected flow, reached maximum HTTP tries but did not throw an error")})}getRequestPath(t){return`/${t.replace(/^\//,"")}`}httpClass(){return this.constructor}throwFailedRequest(t,r){let n=[];t.errors&&n.push(JSON.stringify(t.errors,null,2));let o=(0,zt.getHeader)(r.headers,"x-request-id");o&&n.push(`If you report this error, please include this id: ${o}`);let i=n.length?`:
${n.join(`
`)}`:"",s=r.headers?r.headers:{},a=r.statusCode,c=r.statusText;switch(!0){case r.statusCode===at.StatusCode.TooManyRequests:{let l=(0,zt.getHeader)(r.headers,"Retry-After");throw new ct.HttpThrottlingError({message:`Shopify is throttling requests${i}`,code:a,statusText:c,body:t,headers:s,retryAfter:l?parseFloat(l):void 0})}case r.statusCode>=at.StatusCode.InternalServerError:throw new ct.HttpInternalError({message:`Shopify internal error${i}`,code:a,statusText:c,body:t,headers:s});default:throw new ct.HttpResponseError({message:`Received an error response (${r.statusCode} ${r.statusText}) from Shopify${i}`,code:a,statusText:c,body:t,headers:s})}}doRequest(t){var r;return Ye.__awaiter(this,void 0,void 0,function*(){let n=(0,Vd.logger)(this.httpClass().config),o=yield(0,zt.abstractFetch)(t);this.httpClass().config.logger.httpRequests&&n.debug(`Completed HTTP request, received ${o.statusCode} ${o.statusText}`);let i={};if(o.body)try{i=JSON.parse(o.body)}catch{i=o.body}(0,zt.isOK)(o)||this.throwFailedRequest(i,o);let s=(0,zt.getHeader)(o.headers,"X-Shopify-API-Deprecated-Reason");if(s){let a={message:s,path:t.url};t.body&&(a.body=`${t.body.substring(0,100)}...`);let c=yield(0,m0.createSHA256HMAC)(this.httpClass().config.apiSecretKey,JSON.stringify(a),y0.HashFormat.Hex);if(!Object.keys(this.loggedDeprecations).includes(c)||Date.now()-this.loggedDeprecations[c]>=lt.DEPRECATION_ALERT_DELAY){this.loggedDeprecations[c]=Date.now();let l=new Error().stack,u=`API Deprecation Notice ${new Date().toLocaleString()} : ${JSON.stringify(a)}  -  Stack Trace: ${l}`;yield n.warning(u)}}return{body:i,headers:(r=o.headers)!==null&&r!==void 0?r:{}}})}};Xt.HttpClient=lt;lt.RETRY_WAIT_TIME=1e3;lt.DEPRECATION_ALERT_DELAY=3e5;function v0(e,t="https"){class r extends lt{}return r.config=e,r.scheme=t,Reflect.defineProperty(r,"name",{value:"HttpClient"}),r}Xt.httpClientClass=v0});var zd=p(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.restClientClass=Qt.RestClient=void 0;var Gd=($(),P(L)),w0=Xe(),b0=Ce(),S0=Gd.__importStar(W()),_0=Yt(),E0=Se(),Qe=class extends _0.HttpClient{constructor(t){super({domain:t.session.shop});let r=this.restClass().config;if(!r.isCustomStoreApp&&!t.session.accessToken)throw new S0.MissingRequiredArgument("Missing access token when creating REST client");if(t.apiVersion){let n=t.apiVersion===r.apiVersion?`REST client has a redundant API version override to the default ${t.apiVersion}`:`REST client overriding default API version ${r.apiVersion} with ${t.apiVersion}`;(0,E0.logger)(r).debug(n)}this.session=t.session,this.apiVersion=t.apiVersion}request(t){let r=Object.create(null,{request:{get:()=>super.request}});var n,o,i;return Gd.__awaiter(this,void 0,void 0,function*(){let s=(n=this.restClass().config.adminApiAccessToken)!==null&&n!==void 0?n:this.restClass().config.apiSecretKey;t.extraHeaders=Object.assign({[b0.ShopifyHeader.AccessToken]:this.restClass().config.isCustomStoreApp?s:this.session.accessToken},t.extraHeaders);let a=yield r.request.call(this,t),c=(0,w0.getHeader)(a.headers,"link");if(c!==void 0){let l={limit:!((o=t.query)===null||o===void 0)&&o.limit?(i=t.query)===null||i===void 0?void 0:i.limit.toString():Qe.DEFAULT_LIMIT};if(c){let u=c.split(", ");for(let d of u){let h=d.match(Qe.LINK_HEADER_REGEXP);if(!h)continue;let f=h[2],m=new URL(h[1]),g=m.searchParams.get("fields"),v=m.searchParams.get("page_info");if(!l.fields&&g&&(l.fields=g.split(",")),v)switch(f){case"previous":l.previousPageUrl=h[1],l.prevPage=this.buildRequestParams(h[1]);break;case"next":l.nextPageUrl=h[1],l.nextPage=this.buildRequestParams(h[1]);break}}}a.pageInfo=l}return a})}getRequestPath(t){let r=super.getRequestPath(t);return r.startsWith("/admin")?`${r.replace(/\.json$/,"")}.json`:`/admin/api/${this.apiVersion||this.restClass().config.apiVersion}${r.replace(/\.json$/,"")}.json`}restClass(){return this.constructor}buildRequestParams(t){let r="^/admin/api/[^/]+/(.*).json$",n=new URL(t);return{path:n.pathname.replace(new RegExp(r),"$1"),query:Object.fromEntries(n.searchParams.entries())}}};Qt.RestClient=Qe;Qe.LINK_HEADER_REGEXP=/<([^<]+)>; rel="([^"]+)"/;Qe.DEFAULT_LIMIT="50";function A0(e){let{config:t}=e;class r extends Qe{}return r.config=t,r.scheme="https",Reflect.defineProperty(r,"name",{value:"RestClient"}),r}Qt.restClientClass=A0});var Ze=p(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.graphqlClientClass=Zt.GraphqlClient=void 0;var Yd=($(),P(L)),R0=Ce(),C0=Yt(),Xd=jr(),P0=Se(),bo=Yd.__importStar(W()),So=class{constructor(t){this.baseApiPath="/admin/api";let r=this.graphqlClass().config;if(!r.isCustomStoreApp&&!t.session.accessToken)throw new bo.MissingRequiredArgument("Missing access token when creating GraphQL client");if(t.apiVersion){let n=t.apiVersion===r.apiVersion?`GraphQL client has a redundant API version override to the default ${t.apiVersion}`:`GraphQL client overriding default API version ${r.apiVersion} with ${t.apiVersion}`;(0,P0.logger)(r).debug(n)}this.session=t.session,this.apiVersion=t.apiVersion,this.client=new(this.graphqlClass()).HttpClient({domain:this.session.shop})}query(t){var r,n;return Yd.__awaiter(this,void 0,void 0,function*(){if(typeof t.data=="string"&&t.data.length===0||Object.entries(t.data).length===0)throw new bo.MissingRequiredArgument("Query missing.");let o=this.getApiHeaders();t.extraHeaders=Object.assign(Object.assign({},o),t.extraHeaders);let i=`${this.baseApiPath}/${this.apiVersion||this.graphqlClass().config.apiVersion}/graphql.json`,s;typeof t.data=="object"?s=Xd.DataType.JSON:s=Xd.DataType.GraphQL;let a=yield this.client.post(Object.assign({path:i,type:s},t)),c=a.body.errors;if(c?.length>0)throw new bo.GraphqlQueryError({message:(n=(r=c[0])===null||r===void 0?void 0:r.message)!==null&&n!==void 0?n:"GraphQL query returned errors",response:a.body,headers:a.headers});return a})}getApiHeaders(){var t;let{config:r}=this.graphqlClass(),n;if(r.isCustomStoreApp)n=(t=r.adminApiAccessToken)!==null&&t!==void 0?t:r.apiSecretKey;else if(n=this.session.accessToken,!n)throw new bo.MissingRequiredArgument("Session missing access token.");return{[R0.ShopifyHeader.AccessToken]:n}}graphqlClass(){return this.constructor}};Zt.GraphqlClient=So;function x0(e){let{config:t}=e,{HttpClient:r}=e;r||(r=(0,C0.httpClientClass)(e.config));class n extends So{}return n.config=t,n.HttpClient=r,Reflect.defineProperty(n,"name",{value:"GraphqlClient"}),n}Zt.graphqlClientClass=x0});var Br=p(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.Session=void 0;var O0=W(),Qd=Ra(),T0=["id","shop","state","isOnline","scope","accessToken","expires","onlineAccessInfo"],Wr=class{constructor(t){Object.assign(this,t)}static fromPropertyArray(t){if(!Array.isArray(t))throw new O0.InvalidSession("The parameter is not an array: a Session cannot be created from this object.");let r=Object.fromEntries(t.filter(([n,o])=>o!=null).map(([n,o])=>{switch(n.toLowerCase()){case"isonline":return["isOnline",o];case"accesstoken":return["accessToken",o];case"onlineaccessinfo":return["onlineAccessInfo",o];default:return[n.toLowerCase(),o]}}).map(([n,o])=>{switch(n){case"isOnline":return typeof o=="string"?[n,o.toString().toLowerCase()==="true"]:typeof o=="number"?[n,Boolean(o)]:[n,o];case"scope":return[n,o.toString()];case"expires":return[n,o?new Date(Number(o)):void 0];case"onlineAccessInfo":return[n,{associated_user:{id:Number(o)}}];default:return[n,o]}}));return Object.setPrototypeOf(r,Wr.prototype),r}isActive(t){return!!((t instanceof Qd.AuthScopes?t:new Qd.AuthScopes(t)).equals(this.scope)&&this.accessToken&&(!this.expires||this.expires>=new Date))}toObject(){let t={id:this.id,shop:this.shop,state:this.state,isOnline:this.isOnline};return this.scope&&(t.scope=this.scope),this.expires&&(t.expires=this.expires),this.accessToken&&(t.accessToken=this.accessToken),this.onlineAccessInfo&&(t.onlineAccessInfo=this.onlineAccessInfo),t}equals(t){if(!t||!(this.id===t.id&&this.shop===t.shop&&this.state===t.state&&this.isOnline===t.isOnline))return!1;let n=this.toPropertyArray();n.sort(([i],[s])=>i<s?-1:1);let o=t.toPropertyArray();return o.sort(([i],[s])=>i<s?-1:1),JSON.stringify(n)===JSON.stringify(o)}toPropertyArray(){return Object.entries(this).filter(([t,r])=>T0.includes(t)&&r!==void 0&&r!==null).map(([t,r])=>{var n;switch(t){case"expires":return[t,r?r.getTime():void 0];case"onlineAccessInfo":return[t,(n=r?.associated_user)===null||n===void 0?void 0:n.id];default:return[t,r]}})}};_o.Session=Wr});var rf=p(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.storefrontClientClass=er.StorefrontClient=void 0;var I0=Vt(),Jr=Ce(),H0=Yt(),q0=Br(),Zd=Se(),ef=W(),M0=Ca(),k0=Ze(),Eo=class extends k0.GraphqlClient{constructor(t){let r;tf(t)?r=new q0.Session({shop:t.domain,id:"",state:"",isOnline:!0,accessToken:t.storefrontAccessToken}):r=t.session,super({session:r,apiVersion:t.apiVersion}),this.baseApiPath="/api",this.tokenHeader=Jr.ShopifyHeader.StorefrontPrivateToken;let n=this.storefrontClass().config;if(t.apiVersion){let o=t.apiVersion===n.apiVersion?`Storefront client has a redundant API version override to the default ${t.apiVersion}`:`Storefront client overriding default API version ${n.apiVersion} with ${t.apiVersion}`;(0,Zd.logger)(n).debug(o)}tf(t)&&(this.tokenHeader=Jr.ShopifyHeader.StorefrontAccessToken,this.storefrontAccessToken=t.storefrontAccessToken,(0,Zd.logger)(n).deprecated("8.0.0",["The domain and storefrontAccessToken params are deprecated, because they assume public access tokens for the Storefront API.","Apps should not use public Storefront API tokens for backend requests. Pass the session param instead.","See https://shopify.dev/docs/api/usage/authentication#access-tokens-for-the-storefront-api for more information."].join(`
`))),this.session=r}getApiHeaders(){let t=this.storefrontClass().config,r;if(t.isCustomStoreApp)r=t.privateAppStorefrontAccessToken,r||((0,M0.enableCodeAfterVersion)("8.0.0",()=>{throw new ef.MissingRequiredArgument("Custom store apps must set the privateAppStorefrontAccessToken property to call the Storefront API.")}),r=this.session.accessToken||this.storefrontAccessToken);else if(r=this.session.accessToken,!r)throw new ef.MissingRequiredArgument("Session missing access token.");let n=Jr.LIBRARY_NAME.toLowerCase().split(" ").join("-");return{[this.tokenHeader]:r,[Jr.ShopifyHeader.StorefrontSDKVariant]:n,[Jr.ShopifyHeader.StorefrontSDKVersion]:I0.SHOPIFY_API_LIBRARY_VERSION}}storefrontClass(){return this.constructor}};er.StorefrontClient=Eo;function D0(e){let{config:t}=e,{HttpClient:r}=e;r||(r=(0,H0.httpClientClass)(t));class n extends Eo{}return n.config=t,n.HttpClient=r,Reflect.defineProperty(n,"name",{value:"StorefrontClient"}),n}er.storefrontClientClass=D0;function tf(e){return"domain"in e}});var of=p(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.graphqlProxy=void 0;var nf=($(),P(L)),L0=nf.__importStar(W()),$0=Ze();function N0(e){return({session:t,rawBody:r})=>nf.__awaiter(this,void 0,void 0,function*(){if(!t.accessToken)throw new L0.InvalidSession("Cannot proxy query. Session not authenticated.");let n=(0,$0.graphqlClientClass)({config:e});return new n({session:t}).query({data:r})})}Ao.graphqlProxy=N0});var sf=p(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.clientClasses=void 0;var U0=Yt(),F0=zd(),K0=Ze(),j0=rf(),W0=of();function B0(e){let t=(0,U0.httpClientClass)(e);return{Rest:(0,F0.restClientClass)({config:e}),Graphql:(0,K0.graphqlClientClass)({config:e,HttpClient:t}),Storefront:(0,j0.storefrontClientClass)({config:e,HttpClient:t}),graphqlProxy:(0,W0.graphqlProxy)(e)}}Ro.clientClasses=B0});var Ia=p(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.default=V0;var Co,J0=new Uint8Array(16);function V0(){if(!Co&&(Co=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Co))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Co(J0)}});var af=p(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.default=void 0;var G0=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Po.default=G0});var Vr=p(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.default=void 0;var z0=X0(af());function X0(e){return e&&e.__esModule?e:{default:e}}function Y0(e){return typeof e=="string"&&z0.default.test(e)}var Q0=Y0;xo.default=Q0});var zr=p(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.default=void 0;Gr.unsafeStringify=cf;var Z0=eS(Vr());function eS(e){return e&&e.__esModule?e:{default:e}}var ne=[];for(let e=0;e<256;++e)ne.push((e+256).toString(16).slice(1));function cf(e,t=0){return ne[e[t+0]]+ne[e[t+1]]+ne[e[t+2]]+ne[e[t+3]]+"-"+ne[e[t+4]]+ne[e[t+5]]+"-"+ne[e[t+6]]+ne[e[t+7]]+"-"+ne[e[t+8]]+ne[e[t+9]]+"-"+ne[e[t+10]]+ne[e[t+11]]+ne[e[t+12]]+ne[e[t+13]]+ne[e[t+14]]+ne[e[t+15]]}function tS(e,t=0){let r=cf(e,t);if(!(0,Z0.default)(r))throw TypeError("Stringified UUID is invalid");return r}var rS=tS;Gr.default=rS});var uf=p(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.default=void 0;var nS=iS(Ia()),oS=zr();function iS(e){return e&&e.__esModule?e:{default:e}}var lf,Ha,qa=0,Ma=0;function sS(e,t,r){let n=t&&r||0,o=t||new Array(16);e=e||{};let i=e.node||lf,s=e.clockseq!==void 0?e.clockseq:Ha;if(i==null||s==null){let h=e.random||(e.rng||nS.default)();i==null&&(i=lf=[h[0]|1,h[1],h[2],h[3],h[4],h[5]]),s==null&&(s=Ha=(h[6]<<8|h[7])&16383)}let a=e.msecs!==void 0?e.msecs:Date.now(),c=e.nsecs!==void 0?e.nsecs:Ma+1,l=a-qa+(c-Ma)/1e4;if(l<0&&e.clockseq===void 0&&(s=s+1&16383),(l<0||a>qa)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");qa=a,Ma=c,Ha=s,a+=122192928e5;let u=((a&268435455)*1e4+c)%4294967296;o[n++]=u>>>24&255,o[n++]=u>>>16&255,o[n++]=u>>>8&255,o[n++]=u&255;let d=a/4294967296*1e4&268435455;o[n++]=d>>>8&255,o[n++]=d&255,o[n++]=d>>>24&15|16,o[n++]=d>>>16&255,o[n++]=s>>>8|128,o[n++]=s&255;for(let h=0;h<6;++h)o[n+h]=i[h];return t||(0,oS.unsafeStringify)(o)}var aS=sS;Oo.default=aS});var ka=p(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.default=void 0;var cS=lS(Vr());function lS(e){return e&&e.__esModule?e:{default:e}}function uS(e){if(!(0,cS.default)(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var dS=uS;To.default=dS});var Da=p(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.URL=Mt.DNS=void 0;Mt.default=yS;var fS=zr(),pS=hS(ka());function hS(e){return e&&e.__esModule?e:{default:e}}function mS(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var df="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Mt.DNS=df;var ff="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Mt.URL=ff;function yS(e,t,r){function n(o,i,s,a){var c;if(typeof o=="string"&&(o=mS(o)),typeof i=="string"&&(i=(0,pS.default)(i)),((c=i)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+o.length);if(l.set(i),l.set(o,i.length),l=r(l),l[6]=l[6]&15|t,l[8]=l[8]&63|128,s){a=a||0;for(let u=0;u<16;++u)s[a+u]=l[u];return s}return(0,fS.unsafeStringify)(l)}try{n.name=e}catch{}return n.DNS=df,n.URL=ff,n}});var hf=p(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.default=void 0;function gS(e){if(typeof e=="string"){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return vS(wS(bS(e),e.length*8))}function vS(e){let t=[],r=e.length*32,n="0123456789abcdef";for(let o=0;o<r;o+=8){let i=e[o>>5]>>>o%32&255,s=parseInt(n.charAt(i>>>4&15)+n.charAt(i&15),16);t.push(s)}return t}function pf(e){return(e+64>>>9<<4)+14+1}function wS(e,t){e[t>>5]|=128<<t%32,e[pf(t)-1]=t;let r=1732584193,n=-271733879,o=-1732584194,i=271733878;for(let s=0;s<e.length;s+=16){let a=r,c=n,l=o,u=i;r=ue(r,n,o,i,e[s],7,-680876936),i=ue(i,r,n,o,e[s+1],12,-389564586),o=ue(o,i,r,n,e[s+2],17,606105819),n=ue(n,o,i,r,e[s+3],22,-1044525330),r=ue(r,n,o,i,e[s+4],7,-176418897),i=ue(i,r,n,o,e[s+5],12,1200080426),o=ue(o,i,r,n,e[s+6],17,-1473231341),n=ue(n,o,i,r,e[s+7],22,-45705983),r=ue(r,n,o,i,e[s+8],7,1770035416),i=ue(i,r,n,o,e[s+9],12,-1958414417),o=ue(o,i,r,n,e[s+10],17,-42063),n=ue(n,o,i,r,e[s+11],22,-1990404162),r=ue(r,n,o,i,e[s+12],7,1804603682),i=ue(i,r,n,o,e[s+13],12,-40341101),o=ue(o,i,r,n,e[s+14],17,-1502002290),n=ue(n,o,i,r,e[s+15],22,1236535329),r=de(r,n,o,i,e[s+1],5,-165796510),i=de(i,r,n,o,e[s+6],9,-1069501632),o=de(o,i,r,n,e[s+11],14,643717713),n=de(n,o,i,r,e[s],20,-373897302),r=de(r,n,o,i,e[s+5],5,-701558691),i=de(i,r,n,o,e[s+10],9,38016083),o=de(o,i,r,n,e[s+15],14,-660478335),n=de(n,o,i,r,e[s+4],20,-405537848),r=de(r,n,o,i,e[s+9],5,568446438),i=de(i,r,n,o,e[s+14],9,-1019803690),o=de(o,i,r,n,e[s+3],14,-187363961),n=de(n,o,i,r,e[s+8],20,1163531501),r=de(r,n,o,i,e[s+13],5,-1444681467),i=de(i,r,n,o,e[s+2],9,-51403784),o=de(o,i,r,n,e[s+7],14,1735328473),n=de(n,o,i,r,e[s+12],20,-1926607734),r=fe(r,n,o,i,e[s+5],4,-378558),i=fe(i,r,n,o,e[s+8],11,-2022574463),o=fe(o,i,r,n,e[s+11],16,1839030562),n=fe(n,o,i,r,e[s+14],23,-35309556),r=fe(r,n,o,i,e[s+1],4,-1530992060),i=fe(i,r,n,o,e[s+4],11,1272893353),o=fe(o,i,r,n,e[s+7],16,-155497632),n=fe(n,o,i,r,e[s+10],23,-1094730640),r=fe(r,n,o,i,e[s+13],4,681279174),i=fe(i,r,n,o,e[s],11,-358537222),o=fe(o,i,r,n,e[s+3],16,-722521979),n=fe(n,o,i,r,e[s+6],23,76029189),r=fe(r,n,o,i,e[s+9],4,-640364487),i=fe(i,r,n,o,e[s+12],11,-421815835),o=fe(o,i,r,n,e[s+15],16,530742520),n=fe(n,o,i,r,e[s+2],23,-995338651),r=pe(r,n,o,i,e[s],6,-198630844),i=pe(i,r,n,o,e[s+7],10,1126891415),o=pe(o,i,r,n,e[s+14],15,-1416354905),n=pe(n,o,i,r,e[s+5],21,-57434055),r=pe(r,n,o,i,e[s+12],6,1700485571),i=pe(i,r,n,o,e[s+3],10,-1894986606),o=pe(o,i,r,n,e[s+10],15,-1051523),n=pe(n,o,i,r,e[s+1],21,-2054922799),r=pe(r,n,o,i,e[s+8],6,1873313359),i=pe(i,r,n,o,e[s+15],10,-30611744),o=pe(o,i,r,n,e[s+6],15,-1560198380),n=pe(n,o,i,r,e[s+13],21,1309151649),r=pe(r,n,o,i,e[s+4],6,-145523070),i=pe(i,r,n,o,e[s+11],10,-1120210379),o=pe(o,i,r,n,e[s+2],15,718787259),n=pe(n,o,i,r,e[s+9],21,-343485551),r=ut(r,a),n=ut(n,c),o=ut(o,l),i=ut(i,u)}return[r,n,o,i]}function bS(e){if(e.length===0)return[];let t=e.length*8,r=new Uint32Array(pf(t));for(let n=0;n<t;n+=8)r[n>>5]|=(e[n/8]&255)<<n%32;return r}function ut(e,t){let r=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(r>>16)<<16|r&65535}function SS(e,t){return e<<t|e>>>32-t}function Io(e,t,r,n,o,i){return ut(SS(ut(ut(t,e),ut(n,i)),o),r)}function ue(e,t,r,n,o,i,s){return Io(t&r|~t&n,e,t,o,i,s)}function de(e,t,r,n,o,i,s){return Io(t&n|r&~n,e,t,o,i,s)}function fe(e,t,r,n,o,i,s){return Io(t^r^n,e,t,o,i,s)}function pe(e,t,r,n,o,i,s){return Io(r^(t|~n),e,t,o,i,s)}var _S=gS;Ho.default=_S});var yf=p(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.default=void 0;var ES=mf(Da()),AS=mf(hf());function mf(e){return e&&e.__esModule?e:{default:e}}var RS=(0,ES.default)("v3",48,AS.default),CS=RS;qo.default=CS});var gf=p(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.default=void 0;var PS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xS={randomUUID:PS};Mo.default=xS});var bf=p(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.default=void 0;var vf=wf(gf()),OS=wf(Ia()),TS=zr();function wf(e){return e&&e.__esModule?e:{default:e}}function IS(e,t,r){if(vf.default.randomUUID&&!t&&!e)return vf.default.randomUUID();e=e||{};let n=e.random||(e.rng||OS.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let o=0;o<16;++o)t[r+o]=n[o];return t}return(0,TS.unsafeStringify)(n)}var HS=IS;ko.default=HS});var Sf=p(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.default=void 0;function qS(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function La(e,t){return e<<t|e>>>32-t}function MS(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let s=unescape(encodeURIComponent(e));e=[];for(let a=0;a<s.length;++a)e.push(s.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,o=Math.ceil(n/16),i=new Array(o);for(let s=0;s<o;++s){let a=new Uint32Array(16);for(let c=0;c<16;++c)a[c]=e[s*64+c*4]<<24|e[s*64+c*4+1]<<16|e[s*64+c*4+2]<<8|e[s*64+c*4+3];i[s]=a}i[o-1][14]=(e.length-1)*8/Math.pow(2,32),i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=(e.length-1)*8&4294967295;for(let s=0;s<o;++s){let a=new Uint32Array(80);for(let f=0;f<16;++f)a[f]=i[s][f];for(let f=16;f<80;++f)a[f]=La(a[f-3]^a[f-8]^a[f-14]^a[f-16],1);let c=r[0],l=r[1],u=r[2],d=r[3],h=r[4];for(let f=0;f<80;++f){let m=Math.floor(f/20),g=La(c,5)+qS(m,l,u,d)+h+t[m]+a[f]>>>0;h=d,d=u,u=La(l,30)>>>0,l=c,c=g}r[0]=r[0]+c>>>0,r[1]=r[1]+l>>>0,r[2]=r[2]+u>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var kS=MS;Do.default=kS});var Ef=p(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.default=void 0;var DS=_f(Da()),LS=_f(Sf());function _f(e){return e&&e.__esModule?e:{default:e}}var $S=(0,DS.default)("v5",80,LS.default),NS=$S;Lo.default=NS});var Af=p($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.default=void 0;var US="00000000-0000-0000-0000-000000000000";$o.default=US});var Rf=p(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.default=void 0;var FS=KS(Vr());function KS(e){return e&&e.__esModule?e:{default:e}}function jS(e){if(!(0,FS.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}var WS=jS;No.default=WS});var Cf=p(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});Object.defineProperty(He,"NIL",{enumerable:!0,get:function(){return zS.default}});Object.defineProperty(He,"parse",{enumerable:!0,get:function(){return ZS.default}});Object.defineProperty(He,"stringify",{enumerable:!0,get:function(){return QS.default}});Object.defineProperty(He,"v1",{enumerable:!0,get:function(){return BS.default}});Object.defineProperty(He,"v3",{enumerable:!0,get:function(){return JS.default}});Object.defineProperty(He,"v4",{enumerable:!0,get:function(){return VS.default}});Object.defineProperty(He,"v5",{enumerable:!0,get:function(){return GS.default}});Object.defineProperty(He,"validate",{enumerable:!0,get:function(){return YS.default}});Object.defineProperty(He,"version",{enumerable:!0,get:function(){return XS.default}});var BS=et(uf()),JS=et(yf()),VS=et(bf()),GS=et(Ef()),zS=et(Af()),XS=et(Rf()),YS=et(Vr()),QS=et(zr()),ZS=et(ka());function et(e){return e&&e.__esModule?e:{default:e}}});var Fo=p((WI,Uf)=>{function e_(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,s,a=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}function t_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qf(e){var t=t_(e,"string");return typeof t=="symbol"?t:String(t)}function r_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qf(n.key),n)}}function n_(e,t,r){return t&&Pf(e.prototype,t),r&&Pf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xf(e,t,r){return t=qf(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mf(e,t){return o_(e)||e_(e,t)||i_(e,t)||s_()}function o_(e){if(Array.isArray(e))return e}function i_(e,t){if(e){if(typeof e=="string")return Of(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Of(e,t)}}function Of(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ke(e,t){var r=Df(e,t,"get");return a_(e,r)}function kf(e,t,r){var n=Df(e,t,"set");return c_(e,n,r),r}function Df(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function a_(e,t){return t.get?t.get.call(e):t.value}function c_(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Xr(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Lf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tf(e,t,r){Lf(e,t),t.set(e,r)}function If(e,t){Lf(e,t),t.add(e)}var $f=[" daum[ /]"," deusu/"," yadirectfetcher","(?:^| )site","(?:^|[^g])news","@[a-z]","\\(at\\)[a-z]","\\(github\\.com/","\\[at\\][a-z]","^12345","^<","^[\\w \\.\\-\\(\\)]+(/v?\\d+(\\.\\d+)?(\\.\\d{1,10})?)?$","^[^ ]{50,}$","^active","^ad muncher","^amaya","^anglesharp/","^anonymous","^avsdevicesdk/","^axios/","^bidtellect/","^biglotron","^btwebclient/","^castro","^clamav[ /]","^client/","^cobweb/","^coccoc","^custom","^ddg[_-]android","^discourse","^dispatch/\\d","^downcast/","^duckduckgo","^facebook","^fdm[ /]\\d","^getright/","^gozilla/","^hatena","^hobbit","^hotzonu","^hwcdn/","^jeode/","^jetty/","^jigsaw","^linkdex","^lwp[-: ]","^metauri","^microsoft bits","^movabletype","^mozilla/\\d\\.\\d \\(compatible;?\\)$","^mozilla/\\d\\.\\d \\w*$","^navermailapp","^netsurf","^offline explorer","^php","^postman","^postrank","^python","^read","^reed","^restsharp/","^snapchat","^space bison","^svn","^swcd ","^taringa","^test certificate info","^thumbor/","^tumblr/","^user-agent:mozilla","^valid","^venus/fedoraplanet","^w3c","^webbandit/","^webcopier","^wget","^whatsapp","^xenu link sleuth","^yahoo","^yandex","^zdm/\\d","^zoom marketplace/","^{{.*}}$","adbeat\\.com","appinsights","archive","ask jeeves/teoma","bit\\.ly/","bluecoat drtr","bot","browsex","burpcollaborator","capture","catch","check","chrome-lighthouse","chromeframe","cloud","crawl","cryptoapi","dareboost","datanyze","dataprovider","dejaclick","dmbrowser","download","evc-batch/","feed","firephp","freesafeip","gomezagent","google","headlesschrome/","http","httrack","hubspot marketing grader","hydra","ibisbrowser","images","inspect","iplabel","ips-agent","java","library","mail\\.ru/","manager","monitor","morningscore/","neustar wpm","nutch","offbyone","optimize","pageburst","pagespeed","perl","phantom","pingdom","powermarks","preview","proxy","ptst[ /]\\d","reader","rexx;","rigor","rss","scan","scrape","search","serp ?reputation ?management","server","sogou","sparkler/","speedcurve","spider","splash","statuscake","stumbleupon\\.com","supercleaner","synapse","synthetic","torrent","tracemyfile","transcoder","trendsmapresolver","twingly recon","url","virtuoso","wappalyzer","webglance","webkit2png","websitemetadataretriever","whatcms/","wordpress","zgrab"];function l_(e){try{new RegExp("(?<! cu)bot").test("dangerbot")}catch{return e}return[["bot","(?<! cu)bot"],["google","(?<! (?:channel/|google/))google(?!(app|/google| pixel))"],["http","(?<!(?:lib))http"],["java","java(?!;)"],["search","(?<! ya(?:yandex)?)search"]].forEach(function(t){var r=Mf(t,2),n=r[0],o=r[1],i=e.lastIndexOf(n);~i&&e.splice(i,1,o)}),e}l_($f);var Nf="i",dt=new WeakMap,tr=new WeakMap,Uo=new WeakSet,$a=new WeakSet,u_=function(){function e(t){var r=this;r_(this,e),If(this,$a),If(this,Uo),Tf(this,dt,{writable:!0,value:void 0}),Tf(this,tr,{writable:!0,value:void 0}),kf(this,dt,t||$f.slice()),Xr(this,Uo,Na).call(this);var n=function(i){return r.test(i)};return Object.defineProperties(n,Object.entries(Object.getOwnPropertyDescriptors(e.prototype)).reduce(function(o,i){var s=Mf(i,2),a=s[0],c=s[1];return typeof c.value=="function"&&Object.assign(o,xf({},a,{value:r[a].bind(r)})),typeof c.get=="function"&&Object.assign(o,xf({},a,{get:function(){return r[a]}})),o},{}))}return n_(e,[{key:"pattern",get:function(){return new RegExp(Ke(this,tr))}},{key:"test",value:function(r){return Boolean(r)&&Ke(this,tr).test(r)}},{key:"isbot",value:function(r){return Boolean(r)&&Ke(this,tr).test(r)}},{key:"find",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r.match(Ke(this,tr));return n&&n[0]}},{key:"matches",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Ke(this,dt).filter(function(n){return new RegExp(n,Nf).test(r)})}},{key:"clear",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.exclude(this.matches(r))}},{key:"extend",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];[].push.apply(Ke(this,dt),n.filter(function(o){return Xr(r,$a,Hf).call(r,o)===-1}).map(function(o){return o.toLowerCase()})),Xr(this,Uo,Na).call(this)}},{key:"exclude",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=r.length;n--;){var o=Xr(this,$a,Hf).call(this,r[n]);o>-1&&Ke(this,dt).splice(o,1)}Xr(this,Uo,Na).call(this)}},{key:"spawn",value:function(r){return new e(r||Ke(this,dt))}}]),e}();function Na(){kf(this,tr,new RegExp(Ke(this,dt).join("|"),Nf))}function Hf(e){return Ke(this,dt).indexOf(e.toLowerCase())}var d_=new u_;Uf.exports=d_});var Yr=p(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.safeCompare=void 0;var f_=($(),P(L)),p_=f_.__importStar(W());function h_(e,t){if(typeof e==typeof t){let r=new TextEncoder,n=r.encode(JSON.stringify(e)),o=r.encode(JSON.stringify(t));if(n.length===o.length)return m_(n,o)}else throw new p_.SafeCompareError(`Mismatched data types provided: ${typeof e} and ${typeof t}`);return!1}Ko.safeCompare=h_;function m_(e,t){let r=new Uint8Array(e),n=new Uint8Array(t),o=0;for(let i=0;i<r.length;i++)o|=r[i]^n[i];return o===0}});var Fa=p(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.getCurrentTimeInSec=ft.validateHmac=ft.generateLocalHmac=void 0;var Qr=($(),P(L)),y_=Ht(),g_=Ot(),Ua=Qr.__importStar(W()),v_=Yr(),w_=Qr.__importDefault(vo()),b_=90;function S_(e){let t=new w_.default;return Object.keys(e).sort((r,n)=>r.localeCompare(n)).forEach(r=>t.put(r,e[r])),t.stringify(!0)}function __(e){return Object.entries(e).sort(([t],[r])=>t.localeCompare(r)).reduce((t,[r,n])=>`${t}${r}=${Array.isArray(n)?n.join(","):n}`,"")}function Ff(e){return(t,r="admin")=>Qr.__awaiter(this,void 0,void 0,function*(){let{hmac:n,signature:o}=t,i=Qr.__rest(t,["hmac","signature"]),s=r==="admin"?S_(i):__(i);return(0,y_.createSHA256HMAC)(e.apiSecretKey,s,g_.HashFormat.Hex)})}ft.generateLocalHmac=Ff;function E_(e){return(t,{signator:r}={signator:"admin"})=>Qr.__awaiter(this,void 0,void 0,function*(){if(r==="admin"&&!t.hmac)throw new Ua.InvalidHmacError("Query does not contain an HMAC value.");if(r==="appProxy"&&!t.signature)throw new Ua.InvalidHmacError("Query does not contain a signature value.");A_(t);let n=r==="appProxy"?t.signature:t.hmac,o=yield Ff(e)(t,r);return(0,v_.safeCompare)(n,o)})}ft.validateHmac=E_;function Kf(){return Math.trunc(Date.now()/1e3)}ft.getCurrentTimeInSec=Kf;function A_(e){if(Math.abs(Kf()-Number(e.timestamp))>b_)throw new Ua.InvalidHmacError("HMAC timestamp is outside of the tolerance range")}});var Ka=p(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.decodeHost=void 0;function R_(e){return typeof atob>"u"?Buffer.from(e,"base64").toString():atob(e)}jo.decodeHost=R_});var Zr=p(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.sanitizeHost=rr.sanitizeShop=void 0;var jf=W(),C_=Ka();function P_(e){return(t,r=!1)=>{let n=["myshopify\\.com","shopify\\.com","myshopify\\.io"];e.customShopDomains&&n.push(...e.customShopDomains.map(s=>typeof s=="string"?s:s.source));let i=new RegExp(`^[a-zA-Z0-9][a-zA-Z0-9-_]*\\.(${n.join("|")})[/]*$`).test(t)?t:null;if(!i&&r)throw new jf.InvalidShopError("Received invalid shop argument");return i}}rr.sanitizeShop=P_;function x_(){return(e,t=!1)=>{let n=/^[0-9a-zA-Z+/]+={0,2}$/.test(e)?e:null;if(n){let{hostname:o}=new URL(`https://${(0,C_.decodeHost)(n)}`),i=["myshopify\\.com","shopify\\.com","myshopify\\.io","spin\\.dev"];new RegExp(`\\.(${i.join("|")})$`).test(o)||(n=null)}if(!n&&t)throw new jf.InvalidHostError("Received invalid host argument");return n}}rr.sanitizeHost=x_});var Wo=p(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.STATE_COOKIE_NAME=nr.SESSION_COOKIE_NAME=void 0;nr.SESSION_COOKIE_NAME="shopify_app_session";nr.STATE_COOKIE_NAME="shopify_app_state"});var E,V,oe=y(()=>{E=crypto,V=e=>e instanceof CryptoKey});var O_,Bo,ja=y(()=>{oe();O_=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await E.subtle.digest(r,t))},Bo=O_});function ie(...e){let t=e.reduce((o,{length:i})=>o+i,0),r=new Uint8Array(t),n=0;return e.forEach(o=>{r.set(o,n),n+=o.length}),r}function Wf(e,t){return ie(N.encode(e),new Uint8Array([0]),t)}function Wa(e,t,r){if(t<0||t>=Jo)throw new RangeError(`value must be >= 0 and <= ${Jo-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,t&255],r)}function Vo(e){let t=Math.floor(e/Jo),r=e%Jo,n=new Uint8Array(8);return Wa(n,t,0),Wa(n,r,4),n}function Go(e){let t=new Uint8Array(4);return Wa(t,e),t}function zo(e){return ie(Go(e.length),e)}async function Bf(e,t,r){let n=Math.ceil((t>>3)/32),o=new Uint8Array(n*32);for(let i=0;i<n;i++){let s=new Uint8Array(4+e.length+r.length);s.set(Go(i+1)),s.set(e,4),s.set(r,4+e.length),o.set(await Bo("sha256",s),i*32)}return o.slice(0,t>>3)}var N,G,Jo,Q=y(()=>{ja();N=new TextEncoder,G=new TextDecoder,Jo=2**32});var Xo,U,Ba,j,se=y(()=>{Q();Xo=e=>{let t=e;typeof t=="string"&&(t=N.encode(t));let r=32768,n=[];for(let o=0;o<t.length;o+=r)n.push(String.fromCharCode.apply(null,t.subarray(o,o+r)));return btoa(n.join(""))},U=e=>Xo(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),Ba=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r},j=e=>{let t=e;t instanceof Uint8Array&&(t=G.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Ba(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}});var Va={};Ft(Va,{JOSEAlgNotAllowed:()=>pt,JOSEError:()=>z,JOSENotSupported:()=>A,JWEDecompressionFailed:()=>Ja,JWEDecryptionFailed:()=>tt,JWEInvalid:()=>w,JWKInvalid:()=>en,JWKSInvalid:()=>ht,JWKSMultipleMatchingKeys:()=>tn,JWKSNoMatchingKey:()=>kt,JWKSTimeout:()=>rn,JWSInvalid:()=>I,JWSSignatureVerificationFailed:()=>Dt,JWTClaimValidationFailed:()=>re,JWTExpired:()=>or,JWTInvalid:()=>X});var z,re,or,pt,A,tt,Ja,w,I,X,en,ht,kt,tn,rn,Dt,O=y(()=>{z=class extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(t){var r;super(t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}},re=class extends z{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(t,r="unspecified",n="unspecified"){super(t),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=n}},or=class extends z{static get code(){return"ERR_JWT_EXPIRED"}constructor(t,r="unspecified",n="unspecified"){super(t),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=n}},pt=class extends z{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},A=class extends z{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},tt=class extends z{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},Ja=class extends z{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}},w=class extends z{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},I=class extends z{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},X=class extends z{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},en=class extends z{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},ht=class extends z{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},kt=class extends z{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},tn=class extends z{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},rn=class extends z{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},Dt=class extends z{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}});var mt,nn=y(()=>{oe();mt=E.getRandomValues.bind(E)});function Ga(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new A(`Unsupported JWE Algorithm: ${e}`)}}var Yo,Qo=y(()=>{O();nn();Yo=e=>mt(new Uint8Array(Ga(e)>>3))});var T_,Zo,za=y(()=>{O();Qo();T_=(e,t)=>{if(t.length<<3!==Ga(e))throw new w("Invalid Initialization Vector length")},Zo=T_});var I_,ir,Xa=y(()=>{O();I_=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new w(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)},ir=I_});var H_,Vf,Gf=y(()=>{H_=(e,t)=>{if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(e.length!==t.length)throw new TypeError("Input buffers must have the same length");let r=e.length,n=0,o=-1;for(;++o<r;)n|=e[o]^t[o];return n===0},Vf=H_});function ae(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function yt(e,t){return e.name===t}function ei(e){return parseInt(e.name.slice(4),10)}function q_(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function zf(e,t){if(t.length&&!t.some(r=>e.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let n=t.pop();r+=`one of ${t.join(", ")}, or ${n}.`}else t.length===2?r+=`one of ${t[0]} or ${t[1]}.`:r+=`${t[0]}.`;throw new TypeError(r)}}function Xf(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!yt(e.algorithm,"HMAC"))throw ae("HMAC");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ae(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!yt(e.algorithm,"RSASSA-PKCS1-v1_5"))throw ae("RSASSA-PKCS1-v1_5");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ae(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!yt(e.algorithm,"RSA-PSS"))throw ae("RSA-PSS");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ae(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":{if(e.algorithm.name!=="Ed25519"&&e.algorithm.name!=="Ed448")throw ae("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!yt(e.algorithm,"ECDSA"))throw ae("ECDSA");let n=q_(t);if(e.algorithm.namedCurve!==n)throw ae(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}zf(e,r)}function Ee(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!yt(e.algorithm,"AES-GCM"))throw ae("AES-GCM");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw ae(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!yt(e.algorithm,"AES-KW"))throw ae("AES-KW");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw ae(n,"algorithm.length");break}case"ECDH":{switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw ae("ECDH, X25519, or X448")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!yt(e.algorithm,"PBKDF2"))throw ae("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!yt(e.algorithm,"RSA-OAEP"))throw ae("RSA-OAEP");let n=parseInt(t.slice(9),10)||1;if(ei(e.algorithm.hash)!==n)throw ae(`SHA-${n}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}zf(e,r)}var gt=y(()=>{});function Yf(e,t,...r){if(r.length>2){let n=r.pop();e+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}function Ya(e,t,...r){return Yf(`Key for the ${e} algorithm must be `,t,...r)}var B,qe=y(()=>{B=(e,...t)=>Yf("Key must be ",e,...t)});var Qa,k,Me=y(()=>{oe();Qa=e=>V(e),k=["CryptoKey"]});async function M_(e,t,r,n,o,i){if(!(t instanceof Uint8Array))throw new TypeError(B(t,"Uint8Array"));let s=parseInt(e.slice(1,4),10),a=await E.subtle.importKey("raw",t.subarray(s>>3),"AES-CBC",!1,["decrypt"]),c=await E.subtle.importKey("raw",t.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),l=ie(i,n,r,Vo(i.length<<3)),u=new Uint8Array((await E.subtle.sign("HMAC",c,l)).slice(0,s>>3)),d;try{d=Vf(o,u)}catch{}if(!d)throw new tt;let h;try{h=new Uint8Array(await E.subtle.decrypt({iv:n,name:"AES-CBC"},a,r))}catch{}if(!h)throw new tt;return h}async function k_(e,t,r,n,o,i){let s;t instanceof Uint8Array?s=await E.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(Ee(t,e,"decrypt"),s=t);try{return new Uint8Array(await E.subtle.decrypt({additionalData:i,iv:n,name:"AES-GCM",tagLength:128},s,ie(r,o)))}catch{throw new tt}}var D_,ti,Za=y(()=>{Q();za();Xa();Gf();O();oe();gt();qe();Me();D_=async(e,t,r,n,o,i)=>{if(!V(t)&&!(t instanceof Uint8Array))throw new TypeError(B(t,...k,"Uint8Array"));switch(Zo(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&ir(t,parseInt(e.slice(-3),10)),M_(e,t,r,n,o,i);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&ir(t,parseInt(e.slice(1,4),10)),k_(e,t,r,n,o,i);default:throw new A("Unsupported JWE Content Encryption Algorithm")}},ti=D_});var Qf,Zf,ec=y(()=>{O();Qf=async()=>{throw new A('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},Zf=async()=>{throw new A('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')}});var L_,je,sr=y(()=>{L_=(...e)=>{let t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let r;for(let n of t){let o=Object.keys(n);if(!r||r.size===0){r=new Set(o);continue}for(let i of o){if(r.has(i))return!1;r.add(i)}}return!0},je=L_});function $_(e){return typeof e=="object"&&e!==null}function D(e){if(!$_(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var Ae=y(()=>{});var N_,ar,tc=y(()=>{N_=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]],ar=N_});function ep(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${t}`)}function tp(e,t,r){if(V(e))return Ee(e,t,r),e;if(e instanceof Uint8Array)return E.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw new TypeError(B(e,...k,"Uint8Array"))}var on,sn,ri=y(()=>{tc();oe();gt();qe();Me();on=async(e,t,r)=>{let n=await tp(t,e,"wrapKey");ep(n,e);let o=await E.subtle.importKey("raw",r,...ar);return new Uint8Array(await E.subtle.wrapKey("raw",o,n,"AES-KW"))},sn=async(e,t,r)=>{let n=await tp(t,e,"unwrapKey");ep(n,e);let o=await E.subtle.unwrapKey("raw",r,n,"AES-KW",...ar);return new Uint8Array(await E.subtle.exportKey("raw",o))}});async function ni(e,t,r,n,o=new Uint8Array(0),i=new Uint8Array(0)){if(!V(e))throw new TypeError(B(e,...k));if(Ee(e,"ECDH"),!V(t))throw new TypeError(B(t,...k));Ee(t,"ECDH","deriveBits");let s=ie(zo(N.encode(r)),zo(o),zo(i),Go(n)),a;e.algorithm.name==="X25519"?a=256:e.algorithm.name==="X448"?a=448:a=Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3;let c=new Uint8Array(await E.subtle.deriveBits({name:e.algorithm.name,public:e},t,a));return Bf(c,n,s)}async function rp(e){if(!V(e))throw new TypeError(B(e,...k));return E.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function oi(e){if(!V(e))throw new TypeError(B(e,...k));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||e.algorithm.name==="X25519"||e.algorithm.name==="X448"}var rc=y(()=>{Q();oe();gt();qe();Me()});function nc(e){if(!(e instanceof Uint8Array)||e.length<8)throw new w("PBES2 Salt Input must be 8 or more octets")}var op=y(()=>{O()});function U_(e,t){if(e instanceof Uint8Array)return E.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(V(e))return Ee(e,t,"deriveBits","deriveKey"),e;throw new TypeError(B(e,...k,"Uint8Array"))}async function ip(e,t,r,n){nc(e);let o=Wf(t,e),i=parseInt(t.slice(13,16),10),s={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:o},a={length:i,name:"AES-KW"},c=await U_(n,t);if(c.usages.includes("deriveBits"))return new Uint8Array(await E.subtle.deriveBits(s,c,i));if(c.usages.includes("deriveKey"))return E.subtle.deriveKey(s,c,a,!1,["wrapKey","unwrapKey"]);throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}var sp,ap,oc=y(()=>{nn();Q();se();ri();op();oe();gt();qe();Me();sp=async(e,t,r,n=2048,o=mt(new Uint8Array(16)))=>{let i=await ip(o,e,n,t);return{encryptedKey:await on(e.slice(-6),i,r),p2c:n,p2s:U(o)}},ap=async(e,t,r,n,o)=>{let i=await ip(o,e,n,t);return sn(e.slice(-6),i,r)}});function cr(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new A(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var cp=y(()=>{O()});var Lt,ii=y(()=>{Lt=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}});var lp,up,ic=y(()=>{cp();tc();oe();gt();ii();qe();Me();lp=async(e,t,r)=>{if(!V(t))throw new TypeError(B(t,...k));if(Ee(t,e,"encrypt","wrapKey"),Lt(e,t),t.usages.includes("encrypt"))return new Uint8Array(await E.subtle.encrypt(cr(e),t,r));if(t.usages.includes("wrapKey")){let n=await E.subtle.importKey("raw",r,...ar);return new Uint8Array(await E.subtle.wrapKey("raw",n,t,cr(e)))}throw new TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},up=async(e,t,r)=>{if(!V(t))throw new TypeError(B(t,...k));if(Ee(t,e,"decrypt","unwrapKey"),Lt(e,t),t.usages.includes("decrypt"))return new Uint8Array(await E.subtle.decrypt(cr(e),t,r));if(t.usages.includes("unwrapKey")){let n=await E.subtle.unwrapKey("raw",r,t,cr(e),...ar);return new Uint8Array(await E.subtle.exportKey("raw",n))}throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')}});function an(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new A(`Unsupported JWE Algorithm: ${e}`)}}var We,cn=y(()=>{O();nn();We=e=>mt(new Uint8Array(an(e)>>3))});var sc,dp=y(()=>{sc=(e,t)=>{let r=(e.match(/.{1,64}/g)||[]).join(`
`);return`-----BEGIN ${t}-----
${r}
-----END ${t}-----`}});function pp(e){let t=[],r=0;for(;r<e.length;){let n=wp(e.subarray(r));t.push(n),r+=n.byteLength}return t}function wp(e){let t=0,r=e[0]&31;if(t++,r===31){for(r=0;e[t]>=128;)r=r*128+e[t]-128,t++;r=r*128+e[t]-128,t++}let n=0;if(e[t]<128)n=e[t],t++;else if(n===128){for(n=0;e[t+n]!==0||e[t+n+1]!==0;){if(n>e.byteLength)throw new TypeError("invalid indefinite form length");n++}let i=t+n+2;return{byteLength:i,contents:e.subarray(t,t+n),raw:e.subarray(0,i)}}else{let i=e[t]&127;t++,n=0;for(let s=0;s<i;s++)n=n*256+e[t],t++}let o=t+n;return{byteLength:o,contents:e.subarray(t,o),raw:e.subarray(0,o)}}function F_(e){let t=pp(pp(wp(e).contents)[0].contents);return Xo(t[t[0].raw[0]===160?6:5].raw)}function K_(e){let t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=Ba(t);return sc(F_(r),"PUBLIC KEY")}var hp,mp,yp,vt,fp,gp,vp,ac,bp,si=y(()=>{oe();qe();se();dp();O();Me();hp=async(e,t,r)=>{if(!V(r))throw new TypeError(B(r,...k));if(!r.extractable)throw new TypeError("CryptoKey is not extractable");if(r.type!==e)throw new TypeError(`key is not a ${e} key`);return sc(Xo(new Uint8Array(await E.subtle.exportKey(t,r))),`${e.toUpperCase()} KEY`)},mp=e=>hp("public","spki",e),yp=e=>hp("private","pkcs8",e),vt=(e,t,r=0)=>{r===0&&(t.unshift(t.length),t.unshift(6));let n=e.indexOf(t[0],r);if(n===-1)return!1;let o=e.subarray(n,n+t.length);return o.length!==t.length?!1:o.every((i,s)=>i===t[s])||vt(e,t,n+1)},fp=e=>{switch(!0){case vt(e,[42,134,72,206,61,3,1,7]):return"P-256";case vt(e,[43,129,4,0,34]):return"P-384";case vt(e,[43,129,4,0,35]):return"P-521";case vt(e,[43,101,110]):return"X25519";case vt(e,[43,101,111]):return"X448";case vt(e,[43,101,112]):return"Ed25519";case vt(e,[43,101,113]):return"Ed448";default:throw new A("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},gp=async(e,t,r,n,o)=>{var i;let s,a,c=new Uint8Array(atob(r.replace(e,"")).split("").map(u=>u.charCodeAt(0))),l=t==="spki";switch(n){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${n.slice(-3)}`},a=l?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${n.slice(-3)}`},a=l?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(n.slice(-3),10)||1}`},a=l?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},a=l?["verify"]:["sign"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},a=l?["verify"]:["sign"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},a=l?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let u=fp(c);s=u.startsWith("P-")?{name:"ECDH",namedCurve:u}:{name:u},a=l?[]:["deriveBits"];break}case"EdDSA":s={name:fp(c)},a=l?["verify"]:["sign"];break;default:throw new A('Invalid or unsupported "alg" (Algorithm) value')}return E.subtle.importKey(t,c,s,(i=o?.extractable)!==null&&i!==void 0?i:!1,a)},vp=(e,t,r)=>gp(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r),ac=(e,t,r)=>gp(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r);bp=(e,t,r)=>{let n;try{n=K_(e)}catch(o){throw new TypeError("Failed to parse the X.509 certificate",{cause:o})}return ac(n,t,r)}});function j_(e){let t,r;switch(e.kty){case"oct":{switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new A(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new A('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}var W_,cc,Sp=y(()=>{oe();O();se();W_=async e=>{var t,r;if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:n,keyUsages:o}=j_(e),i=[n,(t=e.ext)!==null&&t!==void 0?t:!1,(r=e.key_ops)!==null&&r!==void 0?r:o];if(n.name==="PBKDF2")return E.subtle.importKey("raw",j(e.k),...i);let s={...e};return delete s.alg,delete s.use,E.subtle.importKey("jwk",s,...i)},cc=W_});async function _p(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN PUBLIC KEY-----")!==0)throw new TypeError('"spki" must be SPKI formatted string');return ac(e,t,r)}async function Ep(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN CERTIFICATE-----")!==0)throw new TypeError('"x509" must be X.509 formatted string');return bp(e,t,r)}async function Ap(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return vp(e,t,r)}async function wt(e,t,r){var n;if(!D(e))throw new TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return r??(r=e.ext!==!0),r?cc({...e,alg:t,ext:(n=e.ext)!==null&&n!==void 0?n:!1}):j(e.k);case"RSA":if(e.oth!==void 0)throw new A('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return cc({...e,alg:t});default:throw new A('Unsupported "kty" (Key Type) Parameter value')}}var ln=y(()=>{se();si();Sp();O();Ae()});var B_,J_,V_,bt,un=y(()=>{qe();Me();B_=(e,t)=>{if(!(t instanceof Uint8Array)){if(!Qa(t))throw new TypeError(Ya(e,t,...k,"Uint8Array"));if(t.type!=="secret")throw new TypeError(`${k.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},J_=(e,t,r)=>{if(!Qa(t))throw new TypeError(Ya(e,t,...k));if(t.type==="secret")throw new TypeError(`${k.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&t.type==="public")throw new TypeError(`${k.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&t.type==="public")throw new TypeError(`${k.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&r==="verify"&&t.type==="private")throw new TypeError(`${k.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&r==="encrypt"&&t.type==="private")throw new TypeError(`${k.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},V_=(e,t,r)=>{e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?B_(e,t):J_(e,t,r)},bt=V_});async function G_(e,t,r,n,o){if(!(r instanceof Uint8Array))throw new TypeError(B(r,"Uint8Array"));let i=parseInt(e.slice(1,4),10),s=await E.subtle.importKey("raw",r.subarray(i>>3),"AES-CBC",!1,["encrypt"]),a=await E.subtle.importKey("raw",r.subarray(0,i>>3),{hash:`SHA-${i<<1}`,name:"HMAC"},!1,["sign"]),c=new Uint8Array(await E.subtle.encrypt({iv:n,name:"AES-CBC"},s,t)),l=ie(o,n,c,Vo(o.length<<3)),u=new Uint8Array((await E.subtle.sign("HMAC",a,l)).slice(0,i>>3));return{ciphertext:c,tag:u}}async function z_(e,t,r,n,o){let i;r instanceof Uint8Array?i=await E.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(Ee(r,e,"encrypt"),i=r);let s=new Uint8Array(await E.subtle.encrypt({additionalData:o,iv:n,name:"AES-GCM",tagLength:128},i,t)),a=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:a}}var X_,dn,lc=y(()=>{Q();za();Xa();oe();gt();qe();O();Me();X_=async(e,t,r,n,o)=>{if(!V(r)&&!(r instanceof Uint8Array))throw new TypeError(B(r,...k,"Uint8Array"));switch(Zo(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&ir(r,parseInt(e.slice(-3),10)),G_(e,t,r,n,o);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&ir(r,parseInt(e.slice(1,4),10)),z_(e,t,r,n,o);default:throw new A("Unsupported JWE Content Encryption Algorithm")}},dn=X_});async function Rp(e,t,r,n){let o=e.slice(0,7);n||(n=Yo(o));let{ciphertext:i,tag:s}=await dn(o,r,t,n,new Uint8Array(0));return{encryptedKey:i,iv:U(n),tag:U(s)}}async function Cp(e,t,r,n,o){let i=e.slice(0,7);return ti(i,t,r,n,o,new Uint8Array(0))}var uc=y(()=>{lc();Za();Qo();se()});async function Y_(e,t,r,n,o){switch(bt(e,t,"decrypt"),e){case"dir":{if(r!==void 0)throw new w("Encountered unexpected JWE Encrypted Key");return t}case"ECDH-ES":if(r!==void 0)throw new w("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!D(n.epk))throw new w('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!oi(t))throw new A("ECDH with the provided key is not allowed or not supported by your javascript runtime");let i=await wt(n.epk,e),s,a;if(n.apu!==void 0){if(typeof n.apu!="string")throw new w('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{s=j(n.apu)}catch{throw new w("Failed to base64url decode the apu")}}if(n.apv!==void 0){if(typeof n.apv!="string")throw new w('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{a=j(n.apv)}catch{throw new w("Failed to base64url decode the apv")}}let c=await ni(i,t,e==="ECDH-ES"?n.enc:e,e==="ECDH-ES"?an(n.enc):parseInt(e.slice(-5,-2),10),s,a);if(e==="ECDH-ES")return c;if(r===void 0)throw new w("JWE Encrypted Key missing");return sn(e.slice(-6),c,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(r===void 0)throw new w("JWE Encrypted Key missing");return up(e,t,r)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(r===void 0)throw new w("JWE Encrypted Key missing");if(typeof n.p2c!="number")throw new w('JOSE Header "p2c" (PBES2 Count) missing or invalid');let i=o?.maxPBES2Count||1e4;if(n.p2c>i)throw new w('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof n.p2s!="string")throw new w('JOSE Header "p2s" (PBES2 Salt) missing or invalid');let s;try{s=j(n.p2s)}catch{throw new w("Failed to base64url decode the p2s")}return ap(e,t,r,n.p2c,s)}case"A128KW":case"A192KW":case"A256KW":{if(r===void 0)throw new w("JWE Encrypted Key missing");return sn(e,t,r)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(r===void 0)throw new w("JWE Encrypted Key missing");if(typeof n.iv!="string")throw new w('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof n.tag!="string")throw new w('JOSE Header "tag" (Authentication Tag) missing or invalid');let i;try{i=j(n.iv)}catch{throw new w("Failed to base64url decode the iv")}let s;try{s=j(n.tag)}catch{throw new w("Failed to base64url decode the tag")}return Cp(e,t,r,i,s)}default:throw new A('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var Pp,xp=y(()=>{ri();rc();oc();ic();se();O();cn();ln();un();Ae();uc();Pp=Y_});function Q_(e,t,r,n,o){if(o.crit!==void 0&&n.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(s=>typeof s!="string"||s.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let i;r!==void 0?i=new Map([...Object.entries(r),...t.entries()]):i=t;for(let s of n.crit){if(!i.has(s))throw new A(`Extension Header Parameter "${s}" is not recognized`);if(o[s]===void 0)throw new e(`Extension Header Parameter "${s}" is missing`);if(i.get(s)&&n[s]===void 0)throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(n.crit)}var Be,lr=y(()=>{O();Be=Q_});var Z_,fn,dc=y(()=>{Z_=(e,t)=>{if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)},fn=Z_});async function ur(e,t,r){var n;if(!D(e))throw new w("Flattened JWE must be an object");if(e.protected===void 0&&e.header===void 0&&e.unprotected===void 0)throw new w("JOSE Header missing");if(typeof e.iv!="string")throw new w("JWE Initialization Vector missing or incorrect type");if(typeof e.ciphertext!="string")throw new w("JWE Ciphertext missing or incorrect type");if(typeof e.tag!="string")throw new w("JWE Authentication Tag missing or incorrect type");if(e.protected!==void 0&&typeof e.protected!="string")throw new w("JWE Protected Header incorrect type");if(e.encrypted_key!==void 0&&typeof e.encrypted_key!="string")throw new w("JWE Encrypted Key incorrect type");if(e.aad!==void 0&&typeof e.aad!="string")throw new w("JWE AAD incorrect type");if(e.header!==void 0&&!D(e.header))throw new w("JWE Shared Unprotected Header incorrect type");if(e.unprotected!==void 0&&!D(e.unprotected))throw new w("JWE Per-Recipient Unprotected Header incorrect type");let o;if(e.protected)try{let H=j(e.protected);o=JSON.parse(G.decode(H))}catch{throw new w("JWE Protected Header is invalid")}if(!je(o,e.header,e.unprotected))throw new w("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let i={...o,...e.header,...e.unprotected};if(Be(w,new Map,r?.crit,o,i),i.zip!==void 0){if(!o||!o.zip)throw new w('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(i.zip!=="DEF")throw new A('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:s,enc:a}=i;if(typeof s!="string"||!s)throw new w("missing JWE Algorithm (alg) in JWE Header");if(typeof a!="string"||!a)throw new w("missing JWE Encryption Algorithm (enc) in JWE Header");let c=r&&fn("keyManagementAlgorithms",r.keyManagementAlgorithms),l=r&&fn("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(c&&!c.has(s))throw new pt('"alg" (Algorithm) Header Parameter not allowed');if(l&&!l.has(a))throw new pt('"enc" (Encryption Algorithm) Header Parameter not allowed');let u;if(e.encrypted_key!==void 0)try{u=j(e.encrypted_key)}catch{throw new w("Failed to base64url decode the encrypted_key")}let d=!1;typeof t=="function"&&(t=await t(o,e),d=!0);let h;try{h=await Pp(s,t,u,i,r)}catch(H){if(H instanceof TypeError||H instanceof w||H instanceof A)throw H;h=We(a)}let f,m;try{f=j(e.iv)}catch{throw new w("Failed to base64url decode the iv")}try{m=j(e.tag)}catch{throw new w("Failed to base64url decode the tag")}let g=N.encode((n=e.protected)!==null&&n!==void 0?n:""),v;e.aad!==void 0?v=ie(g,N.encode("."),N.encode(e.aad)):v=g;let R;try{R=j(e.ciphertext)}catch{throw new w("Failed to base64url decode the ciphertext")}let M=await ti(a,h,R,f,m,v);i.zip==="DEF"&&(M=await(r?.inflateRaw||Qf)(M));let T={plaintext:M};if(e.protected!==void 0&&(T.protectedHeader=o),e.aad!==void 0)try{T.additionalAuthenticatedData=j(e.aad)}catch{throw new w("Failed to base64url decode the aad")}return e.unprotected!==void 0&&(T.sharedUnprotectedHeader=e.unprotected),e.header!==void 0&&(T.unprotectedHeader=e.header),d?{...T,key:t}:T}var ai=y(()=>{se();Za();ec();O();sr();Ae();xp();Q();cn();lr();dc()});async function ci(e,t,r){if(e instanceof Uint8Array&&(e=G.decode(e)),typeof e!="string")throw new w("Compact JWE must be a string or Uint8Array");let{0:n,1:o,2:i,3:s,4:a,length:c}=e.split(".");if(c!==5)throw new w("Invalid Compact JWE");let l=await ur({ciphertext:s,iv:i||void 0,protected:n||void 0,tag:a||void 0,encrypted_key:o||void 0},t,r),u={plaintext:l.plaintext,protectedHeader:l.protectedHeader};return typeof t=="function"?{...u,key:l.key}:u}var fc=y(()=>{ai();O();Q()});async function Op(e,t,r){if(!D(e))throw new w("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(D))throw new w("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new w("JWE Recipients has no members");for(let n of e.recipients)try{return await ur({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new tt}var Tp=y(()=>{ai();O();Ae()});var eE,Ip,Hp=y(()=>{oe();qe();se();Me();eE=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:U(e)};if(!V(e))throw new TypeError(B(e,...k,"Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:n,use:o,...i}=await E.subtle.exportKey("jwk",e);return i},Ip=eE});async function qp(e){return mp(e)}async function Mp(e){return yp(e)}async function li(e){return Ip(e)}var pc=y(()=>{si();si();Hp()});async function tE(e,t,r,n,o={}){let i,s,a;switch(bt(e,r,"encrypt"),e){case"dir":{a=r;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!oi(r))throw new A("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:c,apv:l}=o,{epk:u}=o;u||(u=(await rp(r)).privateKey);let{x:d,y:h,crv:f,kty:m}=await li(u),g=await ni(r,u,e==="ECDH-ES"?t:e,e==="ECDH-ES"?an(t):parseInt(e.slice(-5,-2),10),c,l);if(s={epk:{x:d,crv:f,kty:m}},m==="EC"&&(s.epk.y=h),c&&(s.apu=U(c)),l&&(s.apv=U(l)),e==="ECDH-ES"){a=g;break}a=n||We(t);let v=e.slice(-6);i=await on(v,g,a);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{a=n||We(t),i=await lp(e,r,a);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{a=n||We(t);let{p2c:c,p2s:l}=o;({encryptedKey:i,...s}=await sp(e,r,a,c,l));break}case"A128KW":case"A192KW":case"A256KW":{a=n||We(t),i=await on(e,r,a);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{a=n||We(t);let{iv:c}=o;({encryptedKey:i,...s}=await Rp(e,r,a,c));break}default:throw new A('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:a,encryptedKey:i,parameters:s}}var ui,hc=y(()=>{ri();rc();oc();ic();se();cn();O();pc();un();uc();ui=tE});var mc,rt,di=y(()=>{se();lc();ec();Qo();hc();O();sr();Q();lr();mc=Symbol(),rt=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this._plaintext=t}setKeyManagementParameters(t){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._sharedUnprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}setContentEncryptionKey(t){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=t,this}async encrypt(t,r){if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new w("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!je(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new w("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(Be(w,new Map,r?.crit,this._protectedHeader,n),n.zip!==void 0){if(!this._protectedHeader||!this._protectedHeader.zip)throw new w('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(n.zip!=="DEF")throw new A('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:o,enc:i}=n;if(typeof o!="string"||!o)throw new w('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof i!="string"||!i)throw new w('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let s;if(o==="dir"){if(this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if(o==="ECDH-ES"&&this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");let a;{let m;({cek:a,encryptedKey:s,parameters:m}=await ui(o,i,t,this._cek,this._keyManagementParameters)),m&&(r&&mc in r?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...m}:this.setUnprotectedHeader(m):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...m}:this.setProtectedHeader(m))}this._iv||(this._iv=Yo(i));let c,l,u;this._protectedHeader?l=N.encode(U(JSON.stringify(this._protectedHeader))):l=N.encode(""),this._aad?(u=U(this._aad),c=ie(l,N.encode("."),N.encode(u))):c=l;let d,h;if(n.zip==="DEF"){let m=await(r?.deflateRaw||Zf)(this._plaintext);({ciphertext:d,tag:h}=await dn(i,m,a,this._iv,c))}else({ciphertext:d,tag:h}=await dn(i,this._plaintext,a,this._iv,c));let f={ciphertext:U(d),iv:U(this._iv),tag:U(h)};return s&&(f.encrypted_key=U(s)),u&&(f.aad=u),this._protectedHeader&&(f.protected=G.decode(l)),this._sharedUnprotectedHeader&&(f.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(f.header=this._unprotectedHeader),f}}});var yc,fi,kp=y(()=>{di();O();cn();sr();hc();se();lr();yc=class{constructor(t,r,n){this.parent=t,this.key=r,this.options=n}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addRecipient(...t){return this.parent.addRecipient(...t)}encrypt(...t){return this.parent.encrypt(...t)}done(){return this.parent}},fi=class{constructor(t){this._recipients=[],this._plaintext=t}addRecipient(t,r){let n=new yc(this,t,{crit:r?.crit});return this._recipients.push(n),n}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}async encrypt(t){var r,n,o;if(!this._recipients.length)throw new w("at least one recipient must be added");if(t={deflateRaw:t?.deflateRaw},this._recipients.length===1){let[c]=this._recipients,l=await new rt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(c.unprotectedHeader).encrypt(c.key,{...c.options,...t}),u={ciphertext:l.ciphertext,iv:l.iv,recipients:[{}],tag:l.tag};return l.aad&&(u.aad=l.aad),l.protected&&(u.protected=l.protected),l.unprotected&&(u.unprotected=l.unprotected),l.encrypted_key&&(u.recipients[0].encrypted_key=l.encrypted_key),l.header&&(u.recipients[0].header=l.header),u}let i;for(let c=0;c<this._recipients.length;c++){let l=this._recipients[c];if(!je(this._protectedHeader,this._unprotectedHeader,l.unprotectedHeader))throw new w("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let u={...this._protectedHeader,...this._unprotectedHeader,...l.unprotectedHeader},{alg:d}=u;if(typeof d!="string"||!d)throw new w('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(d==="dir"||d==="ECDH-ES")throw new w('"dir" and "ECDH-ES" alg may only be used with a single recipient');if(typeof u.enc!="string"||!u.enc)throw new w('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(!i)i=u.enc;else if(i!==u.enc)throw new w('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients');if(Be(w,new Map,l.options.crit,this._protectedHeader,u),u.zip!==void 0&&(!this._protectedHeader||!this._protectedHeader.zip))throw new w('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let s=We(i),a={ciphertext:"",iv:"",recipients:[],tag:""};for(let c=0;c<this._recipients.length;c++){let l=this._recipients[c],u={};a.recipients.push(u);let h={...this._protectedHeader,...this._unprotectedHeader,...l.unprotectedHeader}.alg.startsWith("PBES2")?2048+c:void 0;if(c===0){let g=await new rt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(s).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(l.unprotectedHeader).setKeyManagementParameters({p2c:h}).encrypt(l.key,{...l.options,...t,[mc]:!0});a.ciphertext=g.ciphertext,a.iv=g.iv,a.tag=g.tag,g.aad&&(a.aad=g.aad),g.protected&&(a.protected=g.protected),g.unprotected&&(a.unprotected=g.unprotected),u.encrypted_key=g.encrypted_key,g.header&&(u.header=g.header);continue}let{encryptedKey:f,parameters:m}=await ui(((r=l.unprotectedHeader)===null||r===void 0?void 0:r.alg)||((n=this._protectedHeader)===null||n===void 0?void 0:n.alg)||((o=this._unprotectedHeader)===null||o===void 0?void 0:o.alg),i,l.key,s,{p2c:h});u.encrypted_key=U(f),(l.unprotectedHeader||m)&&(u.header={...l.unprotectedHeader,...m})}return a}}});function pn(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new A(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var gc=y(()=>{O()});function hn(e,t,r){if(V(t))return Xf(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(B(t,...k));return E.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(B(t,...k,"Uint8Array"))}var vc=y(()=>{oe();gt();qe();Me()});var rE,Dp,Lp=y(()=>{gc();oe();ii();vc();rE=async(e,t,r,n)=>{let o=await hn(e,t,"verify");Lt(e,o);let i=pn(e,o.algorithm);try{return await E.subtle.verify(i,o,r,n)}catch{return!1}},Dp=rE});async function dr(e,t,r){var n;if(!D(e))throw new I("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new I('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new I("JWS Protected Header incorrect type");if(e.payload===void 0)throw new I("JWS Payload missing");if(typeof e.signature!="string")throw new I("JWS Signature missing or incorrect type");if(e.header!==void 0&&!D(e.header))throw new I("JWS Unprotected Header incorrect type");let o={};if(e.protected)try{let v=j(e.protected);o=JSON.parse(G.decode(v))}catch{throw new I("JWS Protected Header is invalid")}if(!je(o,e.header))throw new I("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...o,...e.header},s=Be(I,new Map([["b64",!0]]),r?.crit,o,i),a=!0;if(s.has("b64")&&(a=o.b64,typeof a!="boolean"))throw new I('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:c}=i;if(typeof c!="string"||!c)throw new I('JWS "alg" (Algorithm) Header Parameter missing or invalid');let l=r&&fn("algorithms",r.algorithms);if(l&&!l.has(c))throw new pt('"alg" (Algorithm) Header Parameter not allowed');if(a){if(typeof e.payload!="string")throw new I("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new I("JWS Payload must be a string or an Uint8Array instance");let u=!1;typeof t=="function"&&(t=await t(o,e),u=!0),bt(c,t,"verify");let d=ie(N.encode((n=e.protected)!==null&&n!==void 0?n:""),N.encode("."),typeof e.payload=="string"?N.encode(e.payload):e.payload),h;try{h=j(e.signature)}catch{throw new I("Failed to base64url decode the signature")}if(!await Dp(c,t,h,d))throw new Dt;let m;if(a)try{m=j(e.payload)}catch{throw new I("Failed to base64url decode the payload")}else typeof e.payload=="string"?m=N.encode(e.payload):m=e.payload;let g={payload:m};return e.protected!==void 0&&(g.protectedHeader=o),e.header!==void 0&&(g.unprotectedHeader=e.header),u?{...g,key:t}:g}var pi=y(()=>{se();Lp();O();Q();sr();Ae();un();lr();dc()});async function hi(e,t,r){if(e instanceof Uint8Array&&(e=G.decode(e)),typeof e!="string")throw new I("Compact JWS must be a string or Uint8Array");let{0:n,1:o,2:i,length:s}=e.split(".");if(s!==3)throw new I("Invalid Compact JWS");let a=await dr({payload:o,protected:n,signature:i},t,r),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof t=="function"?{...c,key:a.key}:c}var wc=y(()=>{pi();O();Q()});async function $p(e,t,r){if(!D(e))throw new I("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(D))throw new I("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await dr({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch{}throw new Dt}var Np=y(()=>{pi();O();Ae()});var fr,bc=y(()=>{fr=e=>Math.floor(e.getTime()/1e3)});var nE,pr,Sc=y(()=>{nE=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,pr=e=>{let t=nE.exec(e);if(!t)throw new TypeError("Invalid time period format");let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(r*60);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(r*3600);case"day":case"days":case"d":return Math.round(r*86400);case"week":case"weeks":case"w":return Math.round(r*604800);default:return Math.round(r*31557600)}}});var Up,oE,hr,mi=y(()=>{O();Q();bc();Sc();Ae();Up=e=>e.toLowerCase().replace(/^application\//,""),oE=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1,hr=(e,t,r={})=>{let{typ:n}=r;if(n&&(typeof e.typ!="string"||Up(e.typ)!==Up(n)))throw new re('unexpected "typ" JWT header value',"typ","check_failed");let o;try{o=JSON.parse(G.decode(t))}catch{}if(!D(o))throw new X("JWT Claims Set must be a top-level JSON object");let{requiredClaims:i=[],issuer:s,subject:a,audience:c,maxTokenAge:l}=r;l!==void 0&&i.push("iat"),c!==void 0&&i.push("aud"),a!==void 0&&i.push("sub"),s!==void 0&&i.push("iss");for(let f of new Set(i.reverse()))if(!(f in o))throw new re(`missing required "${f}" claim`,f,"missing");if(s&&!(Array.isArray(s)?s:[s]).includes(o.iss))throw new re('unexpected "iss" claim value',"iss","check_failed");if(a&&o.sub!==a)throw new re('unexpected "sub" claim value',"sub","check_failed");if(c&&!oE(o.aud,typeof c=="string"?[c]:c))throw new re('unexpected "aud" claim value',"aud","check_failed");let u;switch(typeof r.clockTolerance){case"string":u=pr(r.clockTolerance);break;case"number":u=r.clockTolerance;break;case"undefined":u=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate:d}=r,h=fr(d||new Date);if((o.iat!==void 0||l)&&typeof o.iat!="number")throw new re('"iat" claim must be a number',"iat","invalid");if(o.nbf!==void 0){if(typeof o.nbf!="number")throw new re('"nbf" claim must be a number',"nbf","invalid");if(o.nbf>h+u)throw new re('"nbf" claim timestamp check failed',"nbf","check_failed")}if(o.exp!==void 0){if(typeof o.exp!="number")throw new re('"exp" claim must be a number',"exp","invalid");if(o.exp<=h-u)throw new or('"exp" claim timestamp check failed',"exp","check_failed")}if(l){let f=h-o.iat,m=typeof l=="number"?l:pr(l);if(f-u>m)throw new or('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(f<0-u)throw new re('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return o}});async function Fp(e,t,r){var n;let o=await hi(e,t,r);if(!((n=o.protectedHeader.crit)===null||n===void 0)&&n.includes("b64")&&o.protectedHeader.b64===!1)throw new X("JWTs MUST NOT use unencoded payload");let s={payload:hr(o.protectedHeader,o.payload,r),protectedHeader:o.protectedHeader};return typeof t=="function"?{...s,key:o.key}:s}var Kp=y(()=>{wc();mi();O()});async function jp(e,t,r){let n=await ci(e,t,r),o=hr(n.protectedHeader,n.plaintext,r),{protectedHeader:i}=n;if(i.iss!==void 0&&i.iss!==o.iss)throw new re('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(i.sub!==void 0&&i.sub!==o.sub)throw new re('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(i.aud!==void 0&&JSON.stringify(i.aud)!==JSON.stringify(o.aud))throw new re('replicated "aud" claim header parameter mismatch',"aud","mismatch");let s={payload:o,protectedHeader:i};return typeof t=="function"?{...s,key:n.key}:s}var Wp=y(()=>{fc();mi();O()});var mr,_c=y(()=>{di();mr=class{constructor(t){this._flattened=new rt(t)}setContentEncryptionKey(t){return this._flattened.setContentEncryptionKey(t),this}setInitializationVector(t){return this._flattened.setInitializationVector(t),this}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}setKeyManagementParameters(t){return this._flattened.setKeyManagementParameters(t),this}async encrypt(t,r){let n=await this._flattened.encrypt(t,r);return[n.protected,n.encrypted_key,n.iv,n.ciphertext,n.tag].join(".")}}});var iE,Bp,Jp=y(()=>{gc();oe();ii();vc();iE=async(e,t,r)=>{let n=await hn(e,t,"sign");Lt(e,n);let o=await E.subtle.sign(pn(e,n.algorithm),n,r);return new Uint8Array(o)},Bp=iE});var St,yi=y(()=>{se();Jp();sr();O();Q();un();lr();St=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new I("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!je(this._protectedHeader,this._unprotectedHeader))throw new I("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader},o=Be(I,new Map([["b64",!0]]),r?.crit,this._protectedHeader,n),i=!0;if(o.has("b64")&&(i=this._protectedHeader.b64,typeof i!="boolean"))throw new I('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:s}=n;if(typeof s!="string"||!s)throw new I('JWS "alg" (Algorithm) Header Parameter missing or invalid');bt(s,t,"sign");let a=this._payload;i&&(a=N.encode(U(a)));let c;this._protectedHeader?c=N.encode(U(JSON.stringify(this._protectedHeader))):c=N.encode("");let l=ie(c,N.encode("."),a),u=await Bp(s,t,l),d={signature:U(u),payload:""};return i&&(d.payload=G.decode(a)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=G.decode(c)),d}}});var yr,Ec=y(()=>{yi();yr=class{constructor(t){this._flattened=new St(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){let n=await this._flattened.sign(t,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}});var Ac,gi,Vp=y(()=>{yi();O();Ac=class{constructor(t,r,n){this.parent=t,this.key=r,this.options=n}setProtectedHeader(t){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=t,this}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addSignature(...t){return this.parent.addSignature(...t)}sign(...t){return this.parent.sign(...t)}done(){return this.parent}},gi=class{constructor(t){this._signatures=[],this._payload=t}addSignature(t,r){let n=new Ac(this,t,r);return this._signatures.push(n),n}async sign(){if(!this._signatures.length)throw new I("at least one signature must be added");let t={signatures:[],payload:""};for(let r=0;r<this._signatures.length;r++){let n=this._signatures[r],o=new St(this._payload);o.setProtectedHeader(n.protectedHeader),o.setUnprotectedHeader(n.unprotectedHeader);let{payload:i,...s}=await o.sign(n.key,n.options);if(r===0)t.payload=i;else if(t.payload!==i)throw new I("inconsistent use of JWS Unencoded Payload (RFC7797)");t.signatures.push(s)}return t}}});var _t,vi=y(()=>{bc();Ae();Sc();_t=class{constructor(t){if(!D(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return typeof t=="number"?this._payload={...this._payload,nbf:t}:this._payload={...this._payload,nbf:fr(new Date)+pr(t)},this}setExpirationTime(t){return typeof t=="number"?this._payload={...this._payload,exp:t}:this._payload={...this._payload,exp:fr(new Date)+pr(t)},this}setIssuedAt(t){return typeof t>"u"?this._payload={...this._payload,iat:fr(new Date)}:this._payload={...this._payload,iat:t},this}}});var wi,Gp=y(()=>{Ec();O();Q();vi();wi=class extends _t{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){var n;let o=new yr(N.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray((n=this._protectedHeader)===null||n===void 0?void 0:n.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new X("JWTs MUST NOT use unencoded payload");return o.sign(t,r)}}});var bi,zp=y(()=>{_c();Q();vi();bi=class extends _t{setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setKeyManagementParameters(t){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setContentEncryptionKey(t){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=t,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(t,r){let n=new mr(N.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),n.setProtectedHeader(this._protectedHeader),this._iv&&n.setInitializationVector(this._iv),this._cek&&n.setContentEncryptionKey(this._cek),this._keyManagementParameters&&n.setKeyManagementParameters(this._keyManagementParameters),n.encrypt(t,r)}}});async function Rc(e,t){if(!D(e))throw new TypeError("JWK must be an object");if(t??(t="sha256"),t!=="sha256"&&t!=="sha384"&&t!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let r;switch(e.kty){case"EC":Et(e.crv,'"crv" (Curve) Parameter'),Et(e.x,'"x" (X Coordinate) Parameter'),Et(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":Et(e.crv,'"crv" (Subtype of Key Pair) Parameter'),Et(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":Et(e.e,'"e" (Exponent) Parameter'),Et(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":Et(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new A('"kty" (Key Type) Parameter missing or unsupported')}let n=N.encode(JSON.stringify(r));return U(await Bo(t,n))}async function Xp(e,t){t??(t="sha256");let r=await Rc(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}var Et,Yp=y(()=>{ja();se();O();Q();Ae();Et=(e,t)=>{if(typeof e!="string"||!e)throw new en(`${t} missing or invalid`)}});async function Qp(e,t){let r={...e,...t?.header};if(!D(r.jwk))throw new I('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let n=await wt({...r.jwk,ext:!0},r.alg,!0);if(n instanceof Uint8Array||n.type!=="public")throw new I('"jwk" (JSON Web Key) Header Parameter must be a public key');return n}var Zp=y(()=>{ln();Ae();O()});function sE(e){switch(typeof e=="string"&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new A('Unsupported "alg" value for a JSON Web Key Set')}}function Cc(e){return e&&typeof e=="object"&&Array.isArray(e.keys)&&e.keys.every(aE)}function aE(e){return D(e)}function cE(e){return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}async function eh(e,t,r){let n=e.get(t)||e.set(t,{}).get(t);if(n[r]===void 0){let o=await wt({...t,ext:!0},r);if(o instanceof Uint8Array||o.type!=="public")throw new ht("JSON Web Key Set members must be public keys");n[r]=o}return n[r]}function th(e){let t=new mn(e);return async function(r,n){return t.getKey(r,n)}}var mn,Pc=y(()=>{ln();O();Ae();mn=class{constructor(t){if(this._cached=new WeakMap,!Cc(t))throw new ht("JSON Web Key Set malformed");this._jwks=cE(t)}async getKey(t,r){let{alg:n,kid:o}={...t,...r?.header},i=sE(n),s=this._jwks.keys.filter(l=>{let u=i===l.kty;if(u&&typeof o=="string"&&(u=o===l.kid),u&&typeof l.alg=="string"&&(u=n===l.alg),u&&typeof l.use=="string"&&(u=l.use==="sig"),u&&Array.isArray(l.key_ops)&&(u=l.key_ops.includes("verify")),u&&n==="EdDSA"&&(u=l.crv==="Ed25519"||l.crv==="Ed448"),u)switch(n){case"ES256":u=l.crv==="P-256";break;case"ES256K":u=l.crv==="secp256k1";break;case"ES384":u=l.crv==="P-384";break;case"ES512":u=l.crv==="P-521";break}return u}),{0:a,length:c}=s;if(c===0)throw new kt;if(c!==1){let l=new tn,{_cached:u}=this;throw l[Symbol.asyncIterator]=async function*(){for(let d of s)try{yield await eh(u,d,n)}catch{continue}},l}return eh(this._cached,a,n)}}});var lE,rh,nh=y(()=>{O();lE=async(e,t,r)=>{let n,o,i=!1;typeof AbortController=="function"&&(n=new AbortController,o=setTimeout(()=>{i=!0,n.abort()},t));let s=await fetch(e.href,{signal:n?n.signal:void 0,redirect:"manual",headers:r.headers}).catch(a=>{throw i?new rn:a});if(o!==void 0&&clearTimeout(o),s.status!==200)throw new z("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await s.json()}catch{throw new z("Failed to parse the JSON Web Key Set HTTP response as JSON")}},rh=lE});function uE(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}function oh(e,t){let r=new xc(e,t);return async function(n,o){return r.getKey(n,o)}}var xc,ih=y(()=>{nh();O();Pc();xc=class extends mn{constructor(t,r){if(super({keys:[]}),this._jwks=void 0,!(t instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:r?.agent,headers:r?.headers},this._timeoutDuration=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this._cooldownDuration=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this._cacheMaxAge=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(t,r){(!this._jwks||!this.fresh())&&await this.reload();try{return await super.getKey(t,r)}catch(n){if(n instanceof kt&&this.coolingDown()===!1)return await this.reload(),super.getKey(t,r);throw n}}async reload(){this._pendingFetch&&uE()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=rh(this._url,this._timeoutDuration,this._options).then(t=>{if(!Cc(t))throw new ht("JSON Web Key Set malformed");this._jwks={keys:t.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(t=>{throw this._pendingFetch=void 0,t})),await this._pendingFetch}}});var Si,sh=y(()=>{se();Q();O();mi();vi();Si=class extends _t{encode(){let t=U(JSON.stringify({alg:"none"})),r=U(JSON.stringify(this._payload));return`${t}.${r}.`}static decode(t,r){if(typeof t!="string")throw new X("Unsecured JWT must be a string");let{0:n,1:o,2:i,length:s}=t.split(".");if(s!==3||i!=="")throw new X("Invalid Unsecured JWT");let a;try{if(a=JSON.parse(G.decode(j(n))),a.alg!=="none")throw new Error}catch{throw new X("Invalid Unsecured JWT")}return{payload:hr(a,j(o),r),header:a}}}});var Oc={};Ft(Oc,{decode:()=>yn,encode:()=>dE});var dE,yn,_i=y(()=>{se();dE=U,yn=j});function ah(e){let t;if(typeof e=="string"){let r=e.split(".");(r.length===3||r.length===5)&&([t]=r)}else if(typeof e=="object"&&e)if("protected"in e)t=e.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof t!="string"||!t)throw new Error;let r=JSON.parse(G.decode(yn(t)));if(!D(r))throw new Error;return r}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}var ch=y(()=>{_i();Q();Ae()});function lh(e){if(typeof e!="string")throw new X("JWTs must use Compact JWS serialization, JWT must be a string");let{1:t,length:r}=e.split(".");if(r===5)throw new X("Only JWTs using Compact JWS serialization can be decoded");if(r!==3)throw new X("Invalid JWT");if(!t)throw new X("JWTs must contain a payload");let n;try{n=yn(t)}catch{throw new X("Failed to base64url decode the payload")}let o;try{o=JSON.parse(G.decode(n))}catch{throw new X("Failed to parse the decoded payload as JSON")}if(!D(o))throw new X("Invalid JWT Claims Set");return o}var uh=y(()=>{_i();Q();Ae();O()});async function dh(e,t){var r;let n,o,i;switch(e){case"HS256":case"HS384":case"HS512":n=parseInt(e.slice(-3),10),o={name:"HMAC",hash:`SHA-${n}`,length:n},i=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n=parseInt(e.slice(-3),10),mt(new Uint8Array(n>>3));case"A128KW":case"A192KW":case"A256KW":n=parseInt(e.slice(1,4),10),o={name:"AES-KW",length:n},i=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":n=parseInt(e.slice(1,4),10),o={name:"AES-GCM",length:n},i=["encrypt","decrypt"];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return E.subtle.generateKey(o,(r=t?.extractable)!==null&&r!==void 0?r:!1,i)}function Tc(e){var t;let r=(t=e?.modulusLength)!==null&&t!==void 0?t:2048;if(typeof r!="number"||r<2048)throw new A("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function fh(e,t){var r,n,o;let i,s;switch(e){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Tc(t)},s=["sign","verify"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Tc(t)},s=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Tc(t)},s=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},s=["sign","verify"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},s=["sign","verify"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},s=["sign","verify"];break;case"EdDSA":s=["sign","verify"];let a=(r=t?.crv)!==null&&r!==void 0?r:"Ed25519";switch(a){case"Ed25519":case"Ed448":i={name:a};break;default:throw new A("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{s=["deriveKey","deriveBits"];let c=(n=t?.crv)!==null&&n!==void 0?n:"P-256";switch(c){case"P-256":case"P-384":case"P-521":{i={name:"ECDH",namedCurve:c};break}case"X25519":case"X448":i={name:c};break;default:throw new A("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return E.subtle.generateKey(i,(o=t?.extractable)!==null&&o!==void 0?o:!1,s)}var Ic=y(()=>{oe();O();nn()});async function ph(e,t){return fh(e,t)}var hh=y(()=>{Ic()});async function mh(e,t){return dh(e,t)}var yh=y(()=>{Ic()});var gh,vh=y(()=>{gh="WebCryptoAPI"});var wh,bh=y(()=>{vh();wh=gh});var Sh={};Ft(Sh,{CompactEncrypt:()=>mr,CompactSign:()=>yr,EmbeddedJWK:()=>Qp,EncryptJWT:()=>bi,FlattenedEncrypt:()=>rt,FlattenedSign:()=>St,GeneralEncrypt:()=>fi,GeneralSign:()=>gi,SignJWT:()=>wi,UnsecuredJWT:()=>Si,base64url:()=>Oc,calculateJwkThumbprint:()=>Rc,calculateJwkThumbprintUri:()=>Xp,compactDecrypt:()=>ci,compactVerify:()=>hi,createLocalJWKSet:()=>th,createRemoteJWKSet:()=>oh,cryptoRuntime:()=>wh,decodeJwt:()=>lh,decodeProtectedHeader:()=>ah,errors:()=>Va,exportJWK:()=>li,exportPKCS8:()=>Mp,exportSPKI:()=>qp,flattenedDecrypt:()=>ur,flattenedVerify:()=>dr,generalDecrypt:()=>Op,generalVerify:()=>$p,generateKeyPair:()=>ph,generateSecret:()=>mh,importJWK:()=>wt,importPKCS8:()=>Ap,importSPKI:()=>_p,importX509:()=>Ep,jwtDecrypt:()=>jp,jwtVerify:()=>Fp});var _h=y(()=>{fc();ai();Tp();kp();wc();pi();Np();Kp();Wp();_c();di();Ec();yi();Vp();Gp();zp();Yp();Zp();Pc();ih();sh();pc();ln();ch();uh();O();hh();yh();_i();bh()});var Eh=p(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.getHMACKey=void 0;function fE(e){let t=new Uint8Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t}Ei.getHMACKey=fE});var qc=p(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.decodeSessionToken=void 0;var Hc=($(),P(L)),pE=Hc.__importStar((_h(),P(Sh))),Ah=Hc.__importStar(W()),hE=Eh(),mE=10;function yE(e){return(t,{checkAudience:r=!0}={})=>Hc.__awaiter(this,void 0,void 0,function*(){let n;try{n=(yield pE.jwtVerify(t,(0,hE.getHMACKey)(e.apiSecretKey),{algorithms:["HS256"],clockTolerance:mE})).payload}catch(o){throw new Ah.InvalidJwtError(`Failed to parse session token '${t}': ${o.message}`)}if(r&&n.aud!==e.apiKey)throw new Ah.InvalidJwtError("Session token had invalid API key");return n})}Ai.decodeSessionToken=yE});var Dc=p(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.customAppSession=Je.getCurrentSessionId=Je.getOfflineId=Je.getJwtSessionId=void 0;var Mc=($(),P(L)),gE=Wo(),Rh=Xe(),kc=Zr(),vE=Se(),wE=Mc.__importStar(W()),bE=qc(),SE=Br();function Ch(e){return(t,r)=>`${(0,kc.sanitizeShop)(e)(t,!0)}_${r}`}Je.getJwtSessionId=Ch;function Ph(e){return t=>`offline_${(0,kc.sanitizeShop)(e)(t,!0)}`}Je.getOfflineId=Ph;function _E(e){return function(r){var{isOnline:n}=r,o=Mc.__rest(r,["isOnline"]);return Mc.__awaiter(this,void 0,void 0,function*(){let i=yield(0,Rh.abstractConvertRequest)(o),s=(0,vE.logger)(e);if(e.isEmbeddedApp){s.debug("App is embedded, looking for session id in JWT payload",{isOnline:n});let a=i.headers.Authorization;if(a){let c=(typeof a=="string"?a:a[0]).match(/^Bearer (.+)$/);if(!c)throw s.error("Missing Bearer token in authorization header",{isOnline:n}),new wE.MissingJwtTokenError("Missing Bearer token in authorization header");let l=yield(0,bE.decodeSessionToken)(e)(c[1]),u=l.dest.replace(/^https:\/\//,"");return s.debug("Found valid JWT payload",{shop:u,isOnline:n}),n?Ch(e)(u,l.sub):Ph(e)(u)}else s.error("Missing Authorization header, was the request made with authenticatedFetch?",{isOnline:n})}else return s.debug("App is not embedded, looking for session id in cookies",{isOnline:n}),new Rh.Cookies(i,{},{keys:[e.apiSecretKey]}).getAndVerify(gE.SESSION_COOKIE_NAME)})}}Je.getCurrentSessionId=_E;function EE(e){return t=>new SE.Session({id:"",shop:`${(0,kc.sanitizeShop)(e)(t,!0)}`,state:"",isOnline:!1})}Je.customAppSession=EE});var $c=p(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.nonce=void 0;var Lc=Ht();function AE(){return(Lc.crypto.getRandomValues?Lc.crypto.getRandomValues(new Uint8Array(15)):Lc.crypto.randomBytes(15)).map(n=>n%10).join("")}Ri.nonce=AE});var Mh=p(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.callback=gr.begin=void 0;var nt=($(),P(L)),RE=Cf(),Th=nt.__importDefault(Fo()),CE=nt.__importDefault(vo()),Ci=nt.__importStar(W()),PE=Fa(),Ih=Zr(),xh=Br(),Oh=Dc(),xE=Yt(),OE=jr(),At=Xe(),Nc=Se(),Pi=Wo(),TE=$c(),IE=Yr(),Hh=({request:e,log:t,func:r})=>{t.debug(`Possible bot request to auth ${r}: `,{userAgent:e.headers["User-Agent"]})};function HE(e){return t=>nt.__awaiter(this,void 0,void 0,function*(){var{shop:r,callbackPath:n,isOnline:o}=t,i=nt.__rest(t,["shop","callbackPath","isOnline"]);qh(e.isCustomStoreApp,"Cannot perform OAuth for private apps");let s=(0,Nc.logger)(e);s.info("Beginning OAuth",{shop:r,isOnline:o,callbackPath:n});let a=yield(0,At.abstractConvertRequest)(i),c=yield(0,At.abstractConvertIncomingResponse)(i);if((0,Th.default)(a.headers["User-Agent"]))return Hh({request:a,log:s,func:"begin"}),c.statusCode=410,(0,At.abstractConvertResponse)(c,i);let l=new At.Cookies(a,c,{keys:[e.apiSecretKey],secure:!0}),u=(0,TE.nonce)();yield l.setAndSign(Pi.STATE_COOKIE_NAME,u,{expires:new Date(Date.now()+6e4),sameSite:"lax",secure:!0,path:n});let d={client_id:e.apiKey,scope:e.scopes.toString(),redirect_uri:`${e.hostScheme}://${e.hostName}${n}`,state:u,"grant_options[]":o?"per-user":""},h=new CE.default;h.putAll(d);let m=`https://${(0,Ih.sanitizeShop)(e)(r,!0)}/admin/oauth/authorize${h.stringify()}`;return c.statusCode=302,c.statusText="Found",c.headers=Object.assign(Object.assign(Object.assign({},c.headers),l.response.headers),{Location:m}),s.debug(`OAuth started, redirecting to ${m}`,{shop:r,isOnline:o}),(0,At.abstractConvertResponse)(c,i)})}gr.begin=HE;function qE(e){return function(r){var n=nt.__rest(r,[]);return nt.__awaiter(this,void 0,void 0,function*(){qh(e.isCustomStoreApp,"Cannot perform OAuth for private apps");let o=(0,Nc.logger)(e),i=yield(0,At.abstractConvertRequest)(n),s=new URL(i.url,`${e.hostScheme}://${e.hostName}`).searchParams,a=s.get("shop"),c={};if((0,Th.default)(i.headers["User-Agent"]))throw Hh({request:i,log:o,func:"callback"}),new Ci.BotActivityDetected("Invalid OAuth callback initiated by bot");o.info("Completing OAuth",{shop:a});let l=new At.Cookies(i,c,{keys:[e.apiSecretKey],secure:!0}),u=yield l.getAndVerify(Pi.STATE_COOKIE_NAME);if(l.deleteCookie(Pi.STATE_COOKIE_NAME),!u)throw o.error("Could not find OAuth cookie",{shop:a}),new Ci.CookieNotFound(`Cannot complete OAuth process. Could not find an OAuth cookie for shop url: ${a}`);let d=Object.fromEntries(s.entries());if(!(yield ME({config:e,query:d,stateFromCookie:u})))throw o.error("Invalid OAuth callback",{shop:a,stateFromCookie:u}),new Ci.InvalidOAuthError("Invalid OAuth callback.");o.debug("OAuth request is valid, requesting access token",{shop:a});let h={client_id:e.apiKey,client_secret:e.apiSecretKey,code:s.get("code")},f={path:"/admin/oauth/access_token",type:OE.DataType.JSON,data:h},m=(0,Ih.sanitizeShop)(e)(s.get("shop"),!0),g=(0,xE.httpClientClass)(e),R=yield new g({domain:m}).post(f),M=kE({postResponse:R,shop:m,stateFromCookie:u,config:e});return e.isEmbeddedApp||(yield l.setAndSign(Pi.SESSION_COOKIE_NAME,M.id,{expires:M.expires,sameSite:"lax",secure:!0,path:"/"})),{headers:yield(0,At.abstractConvertHeaders)(l.response.headers,n),session:M}})}}gr.callback=qE;function ME({config:e,query:t,stateFromCookie:r}){return nt.__awaiter(this,void 0,void 0,function*(){return(yield(0,PE.validateHmac)(e)(t))&&(0,IE.safeCompare)(t.state,r)})}function kE({config:e,postResponse:t,shop:r,stateFromCookie:n}){let o=t.body.associated_user,i=Boolean(o);if((0,Nc.logger)(e).info("Creating new session",{shop:r,isOnline:i}),i){let s,a=t.body,{access_token:c,scope:l}=a,u=nt.__rest(a,["access_token","scope"]),d=new Date(Date.now()+a.expires_in*1e3);return e.isEmbeddedApp?s=(0,Oh.getJwtSessionId)(e)(r,`${u.associated_user.id}`):s=(0,RE.v4)(),new xh.Session({id:s,shop:r,state:n,isOnline:i,accessToken:c,scope:l,expires:d,onlineAccessInfo:u})}else{let s=t.body;return new xh.Session({id:(0,Oh.getOfflineId)(e)(r),shop:r,state:n,isOnline:i,accessToken:s.access_token,scope:s.scope})}}function qh(e,t){if(e)throw new Ci.PrivateAppError(t)}});var Kc=p(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.buildEmbeddedAppUrl=vr.getEmbeddedAppUrl=void 0;var Fc=($(),P(L)),Uc=Fc.__importStar(W()),DE=Xe(),LE=Zr(),$E=Ka();function NE(e){return t=>Fc.__awaiter(this,void 0,void 0,function*(){var r=Fc.__rest(t,[]);let n=yield(0,DE.abstractConvertRequest)(r);if(!n)throw new Uc.MissingRequiredArgument("getEmbeddedAppUrl requires a request object argument");if(!n.url)throw new Uc.InvalidRequestError("Request does not contain a URL");let i=new URL(n.url,`https://${n.headers.host}`).searchParams.get("host");if(typeof i!="string")throw new Uc.InvalidRequestError("Request does not contain a host query parameter");return kh(e)(i)})}vr.getEmbeddedAppUrl=NE;function kh(e){return t=>((0,LE.sanitizeHost)()(t,!0),`https://${(0,$E.decodeHost)(t)}/apps/${e.apiKey}`)}vr.buildEmbeddedAppUrl=kh});var $h=p(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});xi.shopifyAuth=void 0;var Dh=Mh(),UE=$c(),FE=Yr(),Lh=Kc();function KE(e){return{begin:(0,Dh.begin)(e),callback:(0,Dh.callback)(e),nonce:UE.nonce,safeCompare:FE.safeCompare,getEmbeddedAppUrl:(0,Lh.getEmbeddedAppUrl)(e),buildEmbeddedAppUrl:(0,Lh.buildEmbeddedAppUrl)(e)}}xi.shopifyAuth=KE});var Nh=p(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.shopifySession=void 0;var jE=qc(),Oi=Dc();function WE(e){return{customAppSession:(0,Oi.customAppSession)(e),getCurrentId:(0,Oi.getCurrentSessionId)(e),getOfflineId:(0,Oi.getOfflineId)(e),getJwtSessionId:(0,Oi.getJwtSessionId)(e),decodeSessionToken:(0,jE.decodeSessionToken)(e)}}Ti.shopifySession=WE});var jc=p(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.versionPriorTo=wr.versionCompatible=void 0;var BE=Ce();function Uh(e){return(t,r=e.apiVersion)=>{if(r===BE.ApiVersion.Unstable)return!0;let n=s=>parseInt(s.replace("-",""),10),o=n(r),i=n(t);return o>=i}}wr.versionCompatible=Uh;function JE(e){return(t,r=e.apiVersion)=>!Uh(e)(t,r)}wr.versionPriorTo=JE});var jh=p(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.shopifyUtils=void 0;var Fh=Zr(),VE=Fa(),Kh=jc();function GE(e){return{sanitizeShop:(0,Fh.sanitizeShop)(e),sanitizeHost:(0,Fh.sanitizeHost)(),validateHmac:(0,VE.validateHmac)(e),versionCompatible:(0,Kh.versionCompatible)(e),versionPriorTo:(0,Kh.versionPriorTo)(e)}}Ii.shopifyUtils=GE});var br=p(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.WebhookValidationErrorReason=ke.WebhookOperation=ke.DeliveryMethod=void 0;var zE;(function(e){e.Http="http",e.EventBridge="eventbridge",e.PubSub="pubsub"})(zE=ke.DeliveryMethod||(ke.DeliveryMethod={}));var XE;(function(e){e.Create="create",e.Update="update",e.Delete="delete"})(XE=ke.WebhookOperation||(ke.WebhookOperation={}));var YE;(function(e){e.MissingHeaders="missing_headers",e.MissingBody="missing_body",e.InvalidHmac="invalid_hmac"})(YE=ke.WebhookValidationErrorReason||(ke.WebhookValidationErrorReason={}))});var Hi=p(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.addHostToCallbackUrl=he.handlerIdentifier=he.getHandlers=he.getTopicsAdded=he.addHandlers=he.topicForStorage=he.registry=void 0;var Bh=W(),QE=Se(),gn=br();function ZE(){return{}}he.registry=ZE;function Bc(e){return e.toUpperCase().replace(/\/|\./g,"_")}he.topicForStorage=Bc;function eA(e,t){return function(n){for(let[o,i]of Object.entries(n)){let s=Bc(o);if(Array.isArray(i))for(let a of i)Wh(e,t,s,a);else Wh(e,t,s,i)}}}he.addHandlers=eA;function tA(e){return function(){return Object.keys(e)}}he.getTopicsAdded=tA;function rA(e){return function(r){return e[Bc(r)]||[]}}he.getHandlers=rA;function Wc(e,t){let r=t.deliveryMethod;switch(t.deliveryMethod){case gn.DeliveryMethod.Http:return`${r}_${Jh(e,t.callbackUrl)}`;case gn.DeliveryMethod.EventBridge:return`${r}_${t.arn}`;case gn.DeliveryMethod.PubSub:return`${r}_${t.pubSubProject}:${t.pubSubTopic}`;default:throw new Bh.InvalidDeliveryMethodError(`Unrecognized delivery method '${t.deliveryMethod}'`)}}he.handlerIdentifier=Wc;function Jh(e,t){return t.startsWith("/")?`${e.hostScheme}://${e.hostName}${t}`:t}he.addHostToCallbackUrl=Jh;function Wh(e,t,r,n){var o,i,s;let a=(0,QE.logger)(e);if((o=n.includeFields)===null||o===void 0||o.sort(),(i=n.metafieldNamespaces)===null||i===void 0||i.sort(),n.deliveryMethod===gn.DeliveryMethod.Http&&(n.privateMetafieldNamespaces&&a.deprecated("8.0.0","The privateMetafieldNamespaces handler option is deprecated, and will be removed in v8.0.0. See https://shopify.dev/docs/apps/custom-data/metafields/migrate-private-metafields"),(s=n.privateMetafieldNamespaces)===null||s===void 0||s.sort()),!(r in t)){t[r]=[n];return}let c=Wc(e,n);for(let l in t[r]){if(!Object.prototype.hasOwnProperty.call(t[r],l))continue;let u=t[r][l],d=Wc(e,u);if(c===d)if(n.deliveryMethod===gn.DeliveryMethod.Http){a.info(`Detected multiple handlers for '${r}', webhooks.process will call them sequentially`);break}else throw new Bh.InvalidDeliveryMethodError(`Can only add multiple handlers when deliveryMethod is Http. Invalid handler: ${JSON.stringify(n)}`)}t[r].push(n)}});var Vh=p(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.queryTemplate=void 0;function nA(e,t){let r=e;return Object.entries(t).forEach(([n,o])=>{r=r.replace(`{{${n}}}`,o)}),r}qi.queryTemplate=nA});var Zh=p(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.TEMPLATE_MUTATION=Ve.TEMPLATE_GET_HANDLERS=Ve.register=void 0;var Sr=($(),P(L)),zh=jc(),Vc=Ze(),Di=W(),Xh=Se(),Gc=Ce(),ki=Hi(),Yh=Vh(),Y=br();function oA(e,t){return function({session:n}){return Sr.__awaiter(this,void 0,void 0,function*(){let o=(0,Xh.logger)(e);o.info("Registering webhooks",{shop:n.shop});let i=Object.keys(t).reduce((a,c)=>(a[c]=[],a),{}),s=yield iA(e,n);o.debug(`Existing topics: [${Object.keys(s).join(", ")}]`,{shop:n.shop});for(let a in t)Object.prototype.hasOwnProperty.call(t,a)&&(Gc.gdprTopics.includes(a)||(i[a]=yield lA({config:e,session:n,topic:a,existingHandlers:s[a]||[],handlers:(0,ki.getHandlers)(t)(a)}),delete s[a]));for(let a in s){if(!Object.prototype.hasOwnProperty.call(s,a))continue;let c=(0,Vc.graphqlClientClass)({config:e}),l=new c({session:n});i[a]=yield Mi({config:e,client:l,topic:a,handlers:s[a],operation:Y.WebhookOperation.Delete})}return i})}}Ve.register=oA;function iA(e,t){return Sr.__awaiter(this,void 0,void 0,function*(){let r=(0,Vc.graphqlClientClass)({config:e}),n=new r({session:t}),o={},i,s=null;do{let a=sA(e,s),c=yield n.query({data:a});c.body.data.webhookSubscriptions.edges.forEach(l=>{let u=cA(l);o[l.node.topic]||(o[l.node.topic]=[]),o[l.node.topic].push(u)}),s=c.body.data.webhookSubscriptions.pageInfo.endCursor,i=c.body.data.webhookSubscriptions.pageInfo.hasNextPage}while(i);return o})}function sA(e,t){return aA(e,(0,Yh.queryTemplate)(Ve.TEMPLATE_GET_HANDLERS,{END_CURSOR:JSON.stringify(t)}))}function aA(e,t){let r=t;return(0,zh.versionCompatible)(e)(Gc.ApiVersion.July22)&&(r=r.replace("privateMetafieldNamespaces","")),r}function cA(e){var t,r,n;let o=e.node.endpoint,i;switch(o.__typename){case"WebhookHttpEndpoint":i={deliveryMethod:Y.DeliveryMethod.Http,privateMetafieldNamespaces:e.node.privateMetafieldNamespaces,callbackUrl:o.callbackUrl,callback:()=>Sr.__awaiter(this,void 0,void 0,function*(){})},(t=i.privateMetafieldNamespaces)===null||t===void 0||t.sort();break;case"WebhookEventBridgeEndpoint":i={deliveryMethod:Y.DeliveryMethod.EventBridge,arn:o.arn};break;case"WebhookPubSubEndpoint":i={deliveryMethod:Y.DeliveryMethod.PubSub,pubSubProject:o.pubSubProject,pubSubTopic:o.pubSubTopic};break}return i.id=e.node.id,i.includeFields=e.node.includeFields,i.metafieldNamespaces=e.node.metafieldNamespaces,(r=i.includeFields)===null||r===void 0||r.sort(),(n=i.metafieldNamespaces)===null||n===void 0||n.sort(),i}function lA({config:e,session:t,topic:r,existingHandlers:n,handlers:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i=[],{toCreate:s,toUpdate:a,toDelete:c}=uA(e,n,o),l=(0,Vc.graphqlClientClass)({config:e}),u=new l({session:t}),d=Y.WebhookOperation.Create;return i=i.concat(yield Mi({config:e,client:u,topic:r,operation:d,handlers:s})),d=Y.WebhookOperation.Update,i=i.concat(yield Mi({config:e,client:u,topic:r,operation:d,handlers:a})),d=Y.WebhookOperation.Delete,i=i.concat(yield Mi({config:e,client:u,topic:r,operation:d,handlers:c})),i})}function uA(e,t,r){let n=r.reduce((c,l)=>(c[(0,ki.handlerIdentifier)(e,l)]=l,c),{}),o=t.reduce((c,l)=>(c[(0,ki.handlerIdentifier)(e,l)]=l,c),{}),i=Object.assign({},n),s={},a={};for(let c in o){if(!Object.prototype.hasOwnProperty.call(o,c))continue;let l=o[c],u=n[c];c in n?(delete i[c],dA(l,u)||(s[c]=u,s[c].id=l.id)):a[c]=l}return{toCreate:Object.values(i),toUpdate:Object.values(s),toDelete:Object.values(a)}}function dA(e,t){let r=Jc(e.includeFields||[],t.includeFields||[]),n=Jc(e.metafieldNamespaces||[],t.metafieldNamespaces||[]),o=e.deliveryMethod!==Y.DeliveryMethod.Http||t.deliveryMethod!==Y.DeliveryMethod.Http||Jc(e.privateMetafieldNamespaces||[],t.privateMetafieldNamespaces||[]);return r&&n&&o}function Jc(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Mi({config:e,client:t,topic:r,handlers:n,operation:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i=[];for(let s of n)i.push(yield fA({config:e,client:t,topic:r,handler:s,operation:o}));return i})}function fA({config:e,client:t,topic:r,handler:n,operation:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i;(0,Xh.logger)(e).debug("Running webhook mutation",{topic:r,operation:o});try{let s=pA(e,r,n,o),a=yield t.query({data:s});i={deliveryMethod:n.deliveryMethod,success:hA(a.body,n,o),result:a.body,operation:o}}catch(s){if(s instanceof Di.InvalidDeliveryMethodError)i={deliveryMethod:n.deliveryMethod,success:!1,result:{message:s.message},operation:o};else throw s}return i})}function pA(e,t,r,n){let o={},i;r.id?i=`id: "${r.id}"`:i=`topic: ${t}`;let s={MUTATION_NAME:Qh(r,n),IDENTIFIER:i,MUTATION_PARAMS:""};if(n!==Y.WebhookOperation.Delete){switch(r.deliveryMethod){case Y.DeliveryMethod.Http:o.callbackUrl=`"${(0,ki.addHostToCallbackUrl)(e,r.callbackUrl)}"`;break;case Y.DeliveryMethod.EventBridge:o.arn=`"${r.arn}"`;break;case Y.DeliveryMethod.PubSub:o.pubSubProject=`"${r.pubSubProject}"`,o.pubSubTopic=`"${r.pubSubTopic}"`;break;default:throw new Di.InvalidDeliveryMethodError(`Unrecognized delivery method '${r.deliveryMethod}'`)}r.includeFields&&(o.includeFields=JSON.stringify(r.includeFields)),r.metafieldNamespaces&&(o.metafieldNamespaces=JSON.stringify(r.metafieldNamespaces)),r.deliveryMethod===Y.DeliveryMethod.Http&&r.privateMetafieldNamespaces&&(0,zh.versionPriorTo)(e)(Gc.ApiVersion.July22)&&(o.privateMetafieldNamespaces=JSON.stringify(r.privateMetafieldNamespaces));let a=Object.entries(o).map(([c,l])=>`${c}: ${l}`).join(", ");s.MUTATION_PARAMS=`webhookSubscription: {${a}}`}return(0,Yh.queryTemplate)(Ve.TEMPLATE_MUTATION,s)}function Qh(e,t){switch(t){case Y.WebhookOperation.Create:return`${Gh(e)}Create`;case Y.WebhookOperation.Update:return`${Gh(e)}Update`;case Y.WebhookOperation.Delete:return"webhookSubscriptionDelete";default:throw new Di.ShopifyError(`Unrecognized operation '${t}'`)}}function Gh(e){switch(e.deliveryMethod){case Y.DeliveryMethod.Http:return"webhookSubscription";case Y.DeliveryMethod.EventBridge:return"eventBridgeWebhookSubscription";case Y.DeliveryMethod.PubSub:return"pubSubWebhookSubscription";default:throw new Di.ShopifyError(`Unrecognized delivery method '${e.deliveryMethod}'`)}}function hA(e,t,r){let n=Qh(t,r);return Boolean(e.data&&e.data[n]&&e.data[n].userErrors.length===0)}Ve.TEMPLATE_GET_HANDLERS=`query shopifyApiReadWebhookSubscriptions {
  webhookSubscriptions(
    first: 250,
    after: {{END_CURSOR}},
  ) {
    edges {
      node {
        id
        topic
        includeFields
        metafieldNamespaces
        privateMetafieldNamespaces
        endpoint {
          __typename
          ... on WebhookHttpEndpoint {
            callbackUrl
          }
          ... on WebhookEventBridgeEndpoint {
            arn
          }
          ... on WebhookPubSubEndpoint {
            pubSubProject
            pubSubTopic
          }
        }
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}`;Ve.TEMPLATE_MUTATION=`
  mutation shopifyApiCreateWebhookSubscription {
    {{MUTATION_NAME}}(
      {{IDENTIFIER}},
      {{MUTATION_PARAMS}}
    ) {
      userErrors {
        field
        message
      }
    }
  }
`});var Xc=p($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.validateFactory=void 0;var Li=($(),P(L)),em=Xe(),mA=Ht(),yA=Ot(),vn=Ce(),gA=Yr(),vA=Se(),zc=br(),wA=Hi(),bA={apiVersion:vn.ShopifyHeader.ApiVersion,domain:vn.ShopifyHeader.Domain,hmac:vn.ShopifyHeader.Hmac,topic:vn.ShopifyHeader.Topic,webhookId:vn.ShopifyHeader.WebhookId};function SA(e){return function(r){var{rawBody:n}=r,o=Li.__rest(r,["rawBody"]);return Li.__awaiter(this,void 0,void 0,function*(){let i=yield(0,em.abstractConvertRequest)(o),s=(0,vA.logger)(e),a=_A(n,i.headers);if(!a.valid)return yield s.debug("Received malformed webhook request",a),a;let{hmac:c,valid:l}=a,u=Li.__rest(a,["hmac","valid"]);return yield s.debug("Webhook request is well formed",u),(yield EA(e.apiSecretKey,n,c))?(yield s.debug("Webhook request is valid",u),a):(yield s.debug("Webhook validation failed",u),e.isCustomStoreApp&&s.deprecated("8.0.0","apiSecretKey should be set to the custom store app's API secret key, so that webhook validation succeeds. adminApiAccessToken should be set to the custom store app's Admin API access token"),{valid:!1,reason:zc.WebhookValidationErrorReason.InvalidHmac})})}}$i.validateFactory=SA;function _A(e,t){if(!e.length)return{valid:!1,reason:zc.WebhookValidationErrorReason.MissingBody};let r=[],n=Object.entries(bA).reduce((o,[i,s])=>{let a=(0,em.getHeader)(t,s);return a?o[i]=a:r.push(s),o},{});return r.length?{valid:!1,reason:zc.WebhookValidationErrorReason.MissingHeaders,missingHeaders:r}:Object.assign(Object.assign({valid:!0},n),{topic:(0,wA.topicForStorage)(n.topic)})}function EA(e,t,r){return Li.__awaiter(this,void 0,void 0,function*(){let n=yield(0,mA.createSHA256HMAC)(e,t,yA.HashFormat.Base64);return(0,gA.safeCompare)(n,r)})}});var nm=p(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.process=void 0;var _r=($(),P(L)),ge=xa(),Yc=Xe(),rm=_r.__importStar(W()),Qc=Se(),Ni=br(),AA=Xc(),tm={[ge.StatusCode.Ok]:"OK",[ge.StatusCode.BadRequest]:"Bad Request",[ge.StatusCode.Unauthorized]:"Unauthorized",[ge.StatusCode.NotFound]:"Not Found",[ge.StatusCode.InternalServerError]:"Internal Server Error"};function RA(e,t){return function(n){var{rawBody:o}=n,i=_r.__rest(n,["rawBody"]);return _r.__awaiter(this,void 0,void 0,function*(){let s={statusCode:ge.StatusCode.Ok,statusText:tm[ge.StatusCode.Ok],headers:{}};yield(0,Qc.logger)(e).info("Receiving webhook request");let a=yield(0,AA.validateFactory)(e)(Object.assign({rawBody:o},i)),c="Unknown error while handling webhook";if(a.valid){let u=yield CA(e,t,a,o);s.statusCode=u.statusCode,(0,Yc.isOK)(s)||(c=u.errorMessage||c)}else{let u=yield PA(e,a);s.statusCode=u.statusCode,s.statusText=tm[s.statusCode],c=u.errorMessage}let l=yield(0,Yc.abstractConvertResponse)(s,i);if(!(0,Yc.isOK)(s))throw new rm.InvalidWebhookError({message:c,response:l});return Promise.resolve(l)})}}Ui.process=RA;function CA(e,t,r,n){return _r.__awaiter(this,void 0,void 0,function*(){let o=(0,Qc.logger)(e),{hmac:i,valid:s}=r,a=_r.__rest(r,["hmac","valid"]);yield o.debug("Webhook request is valid, looking for HTTP handlers to call",a);let c=t[r.topic]||[],l={statusCode:ge.StatusCode.Ok},u=!1;for(let d of c)if(d.deliveryMethod===Ni.DeliveryMethod.Http){if(!d.callback)throw l.statusCode=ge.StatusCode.InternalServerError,l.errorMessage="Cannot call webhooks.process with a webhook handler that doesn't have a callback",new rm.MissingWebhookCallbackError({message:l.errorMessage,response:l});u=!0,yield o.debug("Found HTTP handler, triggering it",a);try{yield d.callback(r.topic,r.domain,n,r.webhookId,r.apiVersion)}catch(h){l.statusCode=ge.StatusCode.InternalServerError,l.errorMessage=h.message}}return u||(yield o.debug("No HTTP handlers found",a),l.statusCode=ge.StatusCode.NotFound,l.errorMessage=`No HTTP webhooks registered for topic ${r.topic}`),l})}function PA(e,t){return _r.__awaiter(this,void 0,void 0,function*(){let r={statusCode:ge.StatusCode.InternalServerError,errorMessage:"Unknown error while handling webhook"};switch(t.reason){case Ni.WebhookValidationErrorReason.MissingHeaders:r.statusCode=ge.StatusCode.BadRequest,r.errorMessage=`Missing one or more of the required HTTP headers to process webhooks: [${t.missingHeaders.join(", ")}]`;break;case Ni.WebhookValidationErrorReason.MissingBody:r.statusCode=ge.StatusCode.BadRequest,r.errorMessage="No body was received when processing webhook";break;case Ni.WebhookValidationErrorReason.InvalidHmac:r.statusCode=ge.StatusCode.Unauthorized,r.errorMessage="Could not validate request HMAC";break}return yield(0,Qc.logger)(e).debug(`Webhook request is invalid, returning ${r.statusCode}: ${r.errorMessage}`),r})}});var om=p(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.shopifyWebhooks=void 0;var Fi=Hi(),xA=Zh(),OA=nm(),TA=Xc();function IA(e){let t=(0,Fi.registry)();return{addHandlers:(0,Fi.addHandlers)(e,t),getTopicsAdded:(0,Fi.getTopicsAdded)(t),getHandlers:(0,Fi.getHandlers)(t),register:(0,xA.register)(e,t),process:(0,OA.process)(e,t),validate:(0,TA.validateFactory)(e)}}Ki.shopifyWebhooks=IA});var cm=p(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.check=void 0;var im=($(),P(L)),HA=Ze(),qA=W();function MA(e){return function({session:r,plans:n,isTest:o=!0,returnObject:i=!1}){return im.__awaiter(this,void 0,void 0,function*(){if(!e.billing)throw new qA.BillingError({message:"Attempted to look for purchases without billing configs",errorData:[]});let s=(0,HA.graphqlClientClass)({config:e}),a=new s({session:r}),c=Array.isArray(n)?n:[n];return kA({plans:c,client:a,isTest:o,returnObject:i})})}}ji.check=MA;function kA({plans:e,client:t,isTest:r,returnObject:n}){return im.__awaiter(this,void 0,void 0,function*(){let o=n?{hasActivePayment:!1,oneTimePurchases:[],appSubscriptions:[]}:!1,i,s=null;do{if(i=(yield t.query({data:{query:$A,variables:{endCursor:s}}})).body.data.currentAppInstallation,n)i.activeSubscriptions.map(c=>{sm({plans:e,isTest:r,subscription:c})&&(o.hasActivePayment=!0,o.appSubscriptions.push(c))}),i.oneTimePurchases.edges.map(c=>{am({plans:e,isTest:r,purchase:c.node})&&(o.hasActivePayment=!0,o.oneTimePurchases.push(c.node))});else{let c={plans:e,isTest:r,installation:i};if(DA(c)||LA(c))return!0}s=i.oneTimePurchases.pageInfo.endCursor}while(i?.oneTimePurchases.pageInfo.hasNextPage);return o})}function sm({plans:e,isTest:t,subscription:r}){return e.includes(r.name)&&(t||!r.test)}function am({plans:e,isTest:t,purchase:r}){return e.includes(r.name)&&(t||!r.test)&&r.status==="ACTIVE"}function DA({plans:e,isTest:t,installation:r}){return r.activeSubscriptions.some(n=>sm({plans:e,isTest:t,subscription:n}))}function LA({plans:e,isTest:t,installation:r}){return r.oneTimePurchases.edges.some(n=>am({plans:e,isTest:t,purchase:n.node}))}var $A=`
  query appSubscription($endCursor: String) {
    currentAppInstallation {
      activeSubscriptions {
        id
        name
        test
      }

      oneTimePurchases(first: 250, sortKey: CREATED_AT, after: $endCursor) {
        edges {
          node {
            id
            name
            test
            status
          }
        }
        pageInfo {
          hasNextPage
          endCursor
        }
      }
    }
  }
`});var dm=p(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.request=void 0;var wn=($(),P(L)),lm=Ce(),bn=W(),NA=Kc(),UA=Ze(),FA=Ht(),KA=Ot();function jA(e){return function(t){var r,{session:n,plan:o,isTest:i=!0,returnUrl:s,returnObject:a=!1}=t,c=wn.__rest(t,["session","plan","isTest","returnUrl","returnObject"]);return wn.__awaiter(this,void 0,void 0,function*(){if(!e.billing||!e.billing[o])throw new bn.BillingError({message:`Could not find plan ${o} in billing settings`,errorData:[]});let l=Object.assign({},e.billing[o]),u=Object.fromEntries(Object.entries(c).filter(([M,T])=>T!==void 0)),d=n.shop.replace(".myshopify.com",""),h=(0,NA.buildEmbeddedAppUrl)(e)((0,FA.hashString)(`admin.shopify.com/store/${d}`,KA.HashFormat.Base64)),f=`${e.hostScheme}://${e.hostName}?shop=${n.shop}`,m=s||(e.isEmbeddedApp?h:f),g=(0,UA.graphqlClientClass)({config:e}),v=new g({session:n}),R;switch(l.interval){case lm.BillingInterval.OneTime:{R=(yield JA({billingConfig:Object.assign(Object.assign({},l),u),plan:o,client:v,returnUrl:m,isTest:i})).data.appPurchaseOneTimeCreate;break}case lm.BillingInterval.Usage:{R=(yield BA({billingConfig:Object.assign(Object.assign({},l),u),plan:o,client:v,returnUrl:m,isTest:i})).data.appSubscriptionCreate;break}default:R=(yield WA({billingConfig:Object.assign(Object.assign({},l),u),plan:o,client:v,returnUrl:m,isTest:i})).data.appSubscriptionCreate}if(!((r=R.userErrors)===null||r===void 0)&&r.length)throw new bn.BillingError({message:"Error while billing the store",errorData:R.userErrors});return a?R:R.confirmationUrl})}}Wi.request=jA;function WA({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i,s,a,c,l,u;return wn.__awaiter(this,void 0,void 0,function*(){let d=yield r.query({data:{query:um,variables:{name:t,trialDays:e.trialDays,replacementBehavior:e.replacementBehavior,returnUrl:n,test:o,lineItems:[{plan:{appRecurringPricingDetails:{interval:e.interval,price:{amount:e.amount,currencyCode:e.currencyCode},discount:{durationLimitInIntervals:(i=e.discount)===null||i===void 0?void 0:i.durationLimitInIntervals,value:{amount:(a=(s=e.discount)===null||s===void 0?void 0:s.value)===null||a===void 0?void 0:a.amount,percentage:(l=(c=e.discount)===null||c===void 0?void 0:c.value)===null||l===void 0?void 0:l.percentage}}}}}]}}});if(!((u=d.body.errors)===null||u===void 0)&&u.length)throw new bn.BillingError({message:"Error while billing the store",errorData:d.body.errors});return d.body})}function BA({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i;return wn.__awaiter(this,void 0,void 0,function*(){let s=yield r.query({data:{query:um,variables:{name:t,returnUrl:n,test:o,trialDays:e.trialDays,replacementBehavior:e.replacementBehavior,lineItems:[{plan:{appUsagePricingDetails:{terms:e.usageTerms,cappedAmount:{amount:e.amount,currencyCode:e.currencyCode}}}}]}}});if(!((i=s.body.errors)===null||i===void 0)&&i.length)throw new bn.BillingError({message:`Error while billing the store:: ${s.body.errors}`,errorData:s.body.errors});return s.body})}function JA({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i;return wn.__awaiter(this,void 0,void 0,function*(){let s=yield r.query({data:{query:VA,variables:{name:t,returnUrl:n,test:o,price:{amount:e.amount,currencyCode:e.currencyCode}}}});if(!((i=s.body.errors)===null||i===void 0)&&i.length)throw new bn.BillingError({message:"Error while billing the store",errorData:s.body.errors});return s.body})}var um=`
  mutation test(
    $name: String!
    $lineItems: [AppSubscriptionLineItemInput!]!
    $returnUrl: URL!
    $test: Boolean
    $trialDays: Int
    $replacementBehavior: AppSubscriptionReplacementBehavior
  ) {
    appSubscriptionCreate(
      name: $name
      lineItems: $lineItems
      returnUrl: $returnUrl
      test: $test
      trialDays: $trialDays
      replacementBehavior: $replacementBehavior
    ) {
      appSubscription {
        id
        name
        test
      }
      confirmationUrl
      userErrors {
        field
        message
      }
    }
  }
`,VA=`
  mutation test(
    $name: String!
    $price: MoneyInput!
    $returnUrl: URL!
    $test: Boolean
  ) {
    appPurchaseOneTimeCreate(
      name: $name
      price: $price
      returnUrl: $returnUrl
      test: $test
    ) {
      appPurchaseOneTime {
        id
        name
        test
      }
      confirmationUrl
      userErrors {
        field
        message
      }
    }
  }
`});var fm=p(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.cancel=void 0;var GA=($(),P(L)),zA=Ze(),Zc=W(),XA=`
  mutation appSubscriptionCancel($id: ID!, $prorate: Boolean) {
    appSubscriptionCancel(id: $id, prorate: $prorate) {
      appSubscription {
        id
        name
        test
      }
      userErrors {
        field
        message
      }
    }
  }
`;function YA(e){return function(t){var r;return GA.__awaiter(this,void 0,void 0,function*(){let{session:n,subscriptionId:o,prorate:i=!0}=t,s=(0,zA.graphqlClientClass)({config:e}),a=new s({session:n});try{let c=yield a.query({data:{query:XA,variables:{id:o,prorate:i}}});if(c.body.data.appSubscriptionCancel.userErrors.length)throw new Zc.BillingError({message:"Error while canceling a subscription",errorData:c.body.data.appSubscriptionCancel.userErrors});return c.body.data.appSubscriptionCancel.appSubscription}catch(c){throw c instanceof Zc.GraphqlQueryError?new Zc.BillingError({message:c.message,errorData:(r=c.response)===null||r===void 0?void 0:r.errors}):c}})}}Bi.cancel=YA});var pm=p(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.subscriptions=void 0;var QA=($(),P(L)),ZA=W(),eR=Ze(),tR=`
  query appSubscription {
    currentAppInstallation {
      activeSubscriptions {
        id
        name
        test
      }
  }
}
`;function rR(e){return function({session:t}){return QA.__awaiter(this,void 0,void 0,function*(){if(!e.billing)throw new ZA.BillingError({message:"Attempted to look for purchases without billing configs",errorData:[]});let r=(0,eR.graphqlClientClass)({config:e});return(yield new r({session:t}).query({data:{query:tR}})).body.data.currentAppInstallation})}}Ji.subscriptions=rR});var hm=p(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.shopifyBilling=void 0;var nR=cm(),oR=dm(),iR=fm(),sR=pm();function aR(e){return{check:(0,nR.check)(e),request:(0,oR.request)(e),cancel:(0,iR.cancel)(e),subscriptions:(0,sR.subscriptions)(e)}}Vi.shopifyBilling=aR});var mm=p(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.Session=void 0;var cR=Br();Object.defineProperty(Gi,"Session",{enumerable:!0,get:function(){return cR.Session}})});var gm=p(ym=>{"use strict";Object.defineProperty(ym,"__esModule",{value:!0})});var wm=p(vm=>{"use strict";Object.defineProperty(vm,"__esModule",{value:!0})});var bm=p(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var lR=($(),P(L));lR.__exportStar(Wo(),el)});var _m=p(Sm=>{"use strict";Object.defineProperty(Sm,"__esModule",{value:!0})});var Am=p(Em=>{"use strict";Object.defineProperty(Em,"__esModule",{value:!0})});var Cm=p(Rm=>{"use strict";Object.defineProperty(Rm,"__esModule",{value:!0})});var Pm=p(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});var tl=($(),P(L));tl.__exportStar(jr(),Sn);tl.__exportStar(Am(),Sn);tl.__exportStar(Cm(),Sn)});var Om=p(xm=>{"use strict";Object.defineProperty(xm,"__esModule",{value:!0})});var Le=p(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.shopifyApi=me.Shopify=void 0;var De=($(),P(L)),uR=(ao(),P(so)),dR=Fd(),rl=ro(),fR=jd(),pR=sf(),hR=$h(),mR=Nh(),yR=jh(),gR=om(),vR=hm(),wR=Se(),bR=Vt();De.__exportStar(W(),me);De.__exportStar(mm(),me);De.__exportStar(gm(),me);De.__exportStar(Ce(),me);De.__exportStar(wm(),me);De.__exportStar(bm(),me);De.__exportStar(_m(),me);De.__exportStar(Pm(),me);De.__exportStar(Om(),me);De.__exportStar(br(),me);me.Shopify={};function SR(e){let{restResources:t}=e,r=De.__rest(e,["restResources"]),n=(0,fR.validateConfig)(r),o={config:n,clients:(0,pR.clientClasses)(n),auth:(0,hR.shopifyAuth)(n),session:(0,mR.shopifySession)(n),utils:(0,yR.shopifyUtils)(n),webhooks:(0,gR.shopifyWebhooks)(n),billing:(0,vR.shopifyBilling)(n),logger:(0,wR.logger)(n),rest:{}};t&&(o.rest=(0,dR.loadRestResources)({resources:t,config:n,RestClient:o.clients.Rest})),o.logger.info(`version ${bR.SHOPIFY_API_LIBRARY_VERSION}, environment ${(0,rl.abstractRuntimeString)()}`).catch(c=>console.log(c));let i=(0,rl.abstractRuntimeString)().match(/(Node) (v\d+\.\d+\.\d+)/),s=i&&i[1]==="Node",a=i?i[2]:"";return s&&(0,uR.compare)(a,"16.0.0","<")&&o.logger.deprecated("8.0.0",`Support for ${(0,rl.abstractRuntimeString)()} will be removed - please upgrade to Node v16.0.0 or higher.`),o}me.shopifyApi=SR});var Xi=p(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});var _R=function(e){return e.AppStore="app_store",e.SingleMerchant="single_merchant",e.ShopifyAdmin="shopify_admin",e}({}),ER=function(e){return e.MissingShop="MISSING_SHOP",e.InvalidShop="INVALID_SHOP",e}({});zi.AppDistribution=_R;zi.LoginErrorType=ER});var Tm=p(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});function AR(e){let{parentHeaders:t,loaderHeaders:r,actionHeaders:n,errorHeaders:o}=e;return o&&Array.from(o.entries()).length>0?o:new Headers([...t?Array.from(t.entries()):[],...r?Array.from(r.entries()):[],...n?Array.from(n.entries()):[]])}nl.headersBoundary=AR});var Im=p(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});var RR=Ts();function CR(e){if(e.constructor.name==="ErrorResponse")return RR.jsx("div",{dangerouslySetInnerHTML:{__html:e.data||"Handling response"}});throw e}ol.errorBoundary=CR});var Hm=p(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var PR=Tm(),xR=Im(),OR={error:xR.errorBoundary,headers:PR.headersBoundary};il.boundary=OR});var al=p(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var TR="1.3.0";sl.SHOPIFY_REMIX_LIBRARY_VERSION=TR});var qm=p(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});function IR({api:e,logger:t}){return async function({session:n}){return e.webhooks.register({session:n}).then(o=>(Object.entries(o).forEach(([i,s])=>{s.forEach(({success:a,...c})=>{a?t.debug("Registered webhook",{topic:i,shop:n.shop,operation:c.operation}):t.error("Failed to register webhook",{topic:i,shop:n.shop,result:JSON.stringify(c.result)})})}),o))}}cl.registerWebhooksFactory=IR});var Mm=p(ll=>{"use strict";ll.parse=MR;ll.serialize=kR;var HR=decodeURIComponent,qR=encodeURIComponent,Yi=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function MR(e,t){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var r={},n=t||{},o=e.split(";"),i=n.decode||HR,s=0;s<o.length;s++){var a=o[s],c=a.indexOf("=");if(!(c<0)){var l=a.substring(0,c).trim();if(r[l]==null){var u=a.substring(c+1,a.length).trim();u[0]==='"'&&(u=u.slice(1,-1)),r[l]=DR(u,i)}}}return r}function kR(e,t,r){var n=r||{},o=n.encode||qR;if(typeof o!="function")throw new TypeError("option encode is invalid");if(!Yi.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!Yi.test(i))throw new TypeError("argument val is invalid");var s=e+"="+i;if(n.maxAge!=null){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Yi.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!Yi.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite){var c=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(c){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return s}function DR(e,t){try{return t(e)}catch{return e}}});function Qi(e,t){!e&&!km[t]&&(km[t]=!0,console.warn(t))}var km,ul=y(()=>{km={}});async function LR(e,t,r){let n=NR(t);return r.length>0&&(n=await e(n,r[0])),n}async function $R(e,t,r){if(r.length>0){for(let n of r){let o=await e(t,n);if(o!==!1)return Dm(o)}return null}return Dm(t)}function NR(e){return btoa(FR(encodeURIComponent(JSON.stringify(e))))}function Dm(e){try{return JSON.parse(decodeURIComponent(UR(atob(e))))}catch{return{}}}function UR(e){let t=e.toString(),r="",n=0,o,i;for(;n<t.length;)o=t.charAt(n++),/[\w*+\-./@]/.exec(o)?r+=o:(i=o.charCodeAt(0),i<256?r+="%"+Lm(i,2):r+="%u"+Lm(i,4).toUpperCase());return r}function Lm(e,t){let r=e.toString(16);for(;r.length<t;)r="0"+r;return r}function FR(e){let t=e.toString(),r="",n=0,o,i;for(;n<t.length;){if(o=t.charAt(n++),o==="%"){if(t.charAt(n)==="u"){if(i=t.slice(n+1,n+5),/^[\da-f]{4}$/i.exec(i)){r+=String.fromCharCode(parseInt(i,16)),n+=5;continue}}else if(i=t.slice(n,n+2),/^[\da-f]{2}$/i.exec(i)){r+=String.fromCharCode(parseInt(i,16)),n+=2;continue}}r+=o}return r}function KR(e,t){Qi(!t,`The "${e}" cookie has an "expires" property set. This will cause the expires value to not be updated when the session is committed. Instead, you should set the expires value when serializing the cookie. You can use \`commitSession(session, { expires })\` if using a session storage object, or \`cookie.serialize("value", { expires })\` if you're using the cookie directly.`)}var Zi,$m,Er,es=y(()=>{Zi=Tu(Mm());ul();$m=({sign:e,unsign:t})=>(r,n={})=>{let{secrets:o=[],...i}={path:"/",sameSite:"lax",...n};return KR(r,i.expires),{get name(){return r},get isSigned(){return o.length>0},get expires(){return typeof i.maxAge<"u"?new Date(Date.now()+i.maxAge*1e3):i.expires},async parse(s,a){if(!s)return null;let c=(0,Zi.parse)(s,{...i,...a});return r in c?c[r]===""?"":await $R(t,c[r],o):null},async serialize(s,a){return(0,Zi.serialize)(r,s===""?"":await LR(e,s,o),{...i,...a})}}},Er=e=>e!=null&&typeof e.name=="string"&&typeof e.isSigned=="boolean"&&typeof e.parse=="function"&&typeof e.serialize=="function"});function Nm(...e){return async t=>{for(let r of e){let n=await r(t);if(typeof n<"u"&&n!==null)return n}}}async function Um(e,t){let r=e.headers.get("Content-Type")||"",[n,o]=r.split(/\s*;\s*boundary=/);if(!e.body||!o||n!=="multipart/form-data")throw new TypeError("Could not parse content as FormData.");let i=new FormData,s=Nu(e.body,o);for await(let a of s){if(a.done)break;typeof a.filename=="string"&&(a.filename=a.filename.split(/[/\\]/).pop());let c=await t(a);typeof c<"u"&&c!==null&&i.append(a.name,c)}return i}var Fm=y(()=>{Uu();});function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ce.apply(this,arguments)}function ve(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function os(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jR(){return Math.random().toString(36).substr(2,8)}function jm(e,t,r,n){return r===void 0&&(r=null),ce({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?En(t):t,{state:r,key:t&&t.key||n||jR()})}function fl(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function En(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function BR(e){return e.index===!0}function Ym(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((o,i)=>{let s=[...r,i],a=typeof o.id=="string"?o.id:s.join("-");if(ve(o.index!==!0||!o.children,"Cannot specify children on an index route"),ve(!n[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),BR(o)){let c=ce({},o,t(o),{id:a});return n[a]=c,c}else{let c=ce({},o,t(o),{id:a,children:void 0});return n[a]=c,o.children&&(c.children=Ym(o.children,t,s,n)),c}})}function ts(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?En(t):t,o=ml(n.pathname||"/",r);if(o==null)return null;let i=Qm(e);JR(i);let s=null;for(let a=0;s==null&&a<i.length;++a)s=tC(i[a],oC(o));return s}function Qm(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let o=(i,s,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(ve(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let l=_n([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(ve(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),Qm(i.children,t,u,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:ZR(l,i.index),routesMeta:u})};return e.forEach((i,s)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))o(i,s);else for(let c of Zm(i.path))o(i,s,c)}),t}function Zm(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,o=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return o?[i,""]:[i];let s=Zm(n.join("/")),a=[];return a.push(...s.map(c=>c===""?i:[i,c].join("/"))),o&&a.push(...s),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function JR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:eC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}function ZR(e,t){let r=e.split("/"),n=r.length;return r.some(Wm)&&(n+=QR),t&&(n+=zR),r.filter(o=>!Wm(o)).reduce((o,i)=>o+(VR.test(i)?GR:i===""?XR:YR),n)}function eC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,o)=>n===t[o])?e[e.length-1]-t[t.length-1]:0}function tC(e,t){let{routesMeta:r}=e,n={},o="/",i=[];for(let s=0;s<r.length;++s){let a=r[s],c=s===r.length-1,l=o==="/"?t:t.slice(o.length)||"/",u=rC({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(n,u.params);let d=a.route;i.push({params:n,pathname:_n([o,u.pathname]),pathnameBase:lC(_n([o,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(o=_n([o,u.pathnameBase]))}return i}function rC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=nC(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let i=o[0],s=i.replace(/(.)\/+$/,"$1"),a=o.slice(1);return{params:n.reduce((l,u,d)=>{if(u==="*"){let h=a[d]||"";s=i.slice(0,i.length-h.length).replace(/(.)\/+$/,"$1")}return l[u]=iC(a[d]||"",u),l},{}),pathname:i,pathnameBase:s,pattern:e}}function nC(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),os(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(s,a)=>(n.push(a),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}function oC(e){try{return decodeURI(e)}catch(t){return os(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function iC(e,t){try{return decodeURIComponent(e)}catch(r){return os(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function ml(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function sC(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:o=""}=typeof e=="string"?En(e):e;return{pathname:r?r.startsWith("/")?r:aC(r,t):t,search:uC(n),hash:dC(o)}}function aC(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function dl(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ey(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function cC(e,t,r,n){n===void 0&&(n=!1);let o;typeof e=="string"?o=En(e):(o=ce({},e),ve(!o.pathname||!o.pathname.includes("?"),dl("?","pathname","search",o)),ve(!o.pathname||!o.pathname.includes("#"),dl("#","pathname","hash",o)),ve(!o.search||!o.search.includes("#"),dl("#","search","hash",o)));let i=e===""||o.pathname==="",s=i?"/":o.pathname,a;if(n||s==null)a=r;else{let d=t.length-1;if(s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;o.pathname=h.join("/")}a=d>=0?t[d]:"/"}let c=sC(o,a),l=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}function fC(e){return e instanceof Promise&&e._tracked===!0}function pC(e){if(!fC(e))return e;if(e._error)throw e._error;return e._data}function ot(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function oy(e,t){ve(e.length>0,"You must provide a non-empty routes array to createStaticHandler");let r={},n=(t?t.basename:null)||"/",o;if(t!=null&&t.mapRouteProperties)o=t.mapRouteProperties;else if(t!=null&&t.detectErrorBoundary){let d=t.detectErrorBoundary;o=h=>({hasErrorBoundary:d(h)})}else o=wC;let i=Ym(e,o,void 0,r);async function s(d,h){let{requestContext:f}=h===void 0?{}:h,m=new URL(d.url),g=d.method,v=jm("",fl(m),null,"default"),R=ts(i,v,n);if(!zm(g)&&g!=="HEAD"){let T=$e(405,{method:g}),{matches:H,route:ze}=Vm(i);return{basename:n,location:v,matches:H,loaderData:{},actionData:null,errors:{[ze.id]:T},statusCode:T.status,loaderHeaders:{},actionHeaders:{},activeDeferreds:null}}else if(!R){let T=$e(404,{pathname:v.pathname}),{matches:H,route:ze}=Vm(i);return{basename:n,location:v,matches:H,loaderData:{},actionData:null,errors:{[ze.id]:T},statusCode:T.status,loaderHeaders:{},actionHeaders:{},activeDeferreds:null}}let M=await c(d,v,R,f);return Ar(M)?M:ce({location:v,basename:n},M)}async function a(d,h){let{routeId:f,requestContext:m}=h===void 0?{}:h,g=new URL(d.url),v=d.method,R=jm("",fl(g),null,"default"),M=ts(i,R,n);if(!zm(v)&&v!=="HEAD"&&v!=="OPTIONS")throw $e(405,{method:v});if(!M)throw $e(404,{pathname:R.pathname});let T=f?M.find(ee=>ee.route.id===f):Xm(M,R);if(f&&!T)throw $e(403,{pathname:R.pathname,routeId:f});if(!T)throw $e(404,{pathname:R.pathname});let H=await c(d,R,M,m,T);if(Ar(H))return H;let ze=H.errors?Object.values(H.errors)[0]:void 0;if(ze!==void 0)throw ze;if(H.actionData)return Object.values(H.actionData)[0];if(H.loaderData){var Nn;let ee=Object.values(H.loaderData)[0];return(Nn=H.activeDeferreds)!=null&&Nn[T.route.id]&&(ee[is]=H.activeDeferreds[T.route.id]),ee}}async function c(d,h,f,m,g){ve(d.signal,"query()/queryRoute() requests must contain an AbortController signal");try{if(RC(d.method.toLowerCase()))return await l(d,f,g||Xm(f,h),m,g!=null);let v=await u(d,f,m,g);return Ar(v)?v:ce({},v,{actionData:null,actionHeaders:{}})}catch(v){if(AC(v)){if(v.type===Z.error&&!Gm(v.response))throw v.response;return v.response}if(Gm(v))return v;throw v}}async function l(d,h,f,m,g){let v;if(!f.route.action&&!f.route.lazy){let T=$e(405,{method:d.method,pathname:new URL(d.url).pathname,routeId:f.route.id});if(g)throw T;v={type:Z.error,error:T}}else if(v=await Jm("action",d,f,h,r,o,n,{isStaticRequest:!0,isRouteRequest:g,requestContext:m}),d.signal.aborted){let T=g?"queryRoute":"query";throw new Error(T+"() call aborted")}if(cy(v))throw new Response(null,{status:v.status,headers:{Location:v.location}});if(ay(v)){let T=$e(400,{type:"defer-action"});if(g)throw T;v={type:Z.error,error:T}}if(g){if(hl(v))throw v.error;return{matches:[f],loaderData:{},actionData:{[f.route.id]:v.data},errors:null,statusCode:200,loaderHeaders:{},actionHeaders:{},activeDeferreds:null}}if(hl(v)){let T=sy(h,f.route.id),H=await u(d,h,m,void 0,{[T.route.id]:v.error});return ce({},H,{statusCode:ot(v.error)?v.error.status:500,actionData:null,actionHeaders:ce({},v.headers?{[f.route.id]:v.headers}:{})})}let R=new Request(d.url,{headers:d.headers,redirect:d.redirect,signal:d.signal}),M=await u(R,h,m);return ce({},M,v.statusCode?{statusCode:v.statusCode}:{},{actionData:{[f.route.id]:v.data},actionHeaders:ce({},v.headers?{[f.route.id]:v.headers}:{})})}async function u(d,h,f,m,g){let v=m!=null;if(v&&!(m!=null&&m.route.loader)&&!(m!=null&&m.route.lazy))throw $e(400,{method:d.method,pathname:new URL(d.url).pathname,routeId:m?.route.id});let M=(m?[m]:SC(h,Object.keys(g||{})[0])).filter(ee=>ee.route.loader||ee.route.lazy);if(M.length===0)return{matches:h,loaderData:h.reduce((ee,Aw)=>Object.assign(ee,{[Aw.route.id]:null}),{}),errors:g||null,statusCode:200,loaderHeaders:{},activeDeferreds:null};let T=await Promise.all([...M.map(ee=>Jm("loader",d,ee,h,r,o,n,{isStaticRequest:!0,isRouteRequest:v,requestContext:f}))]);if(d.signal.aborted){let ee=v?"queryRoute":"query";throw new Error(ee+"() call aborted")}let H=new Map,ze=_C(h,M,T,g,H),Nn=new Set(M.map(ee=>ee.route.id));return h.forEach(ee=>{Nn.has(ee.route.id)||(ze.loaderData[ee.route.id]=null)}),ce({},ze,{matches:h,activeDeferreds:H.size>0?Object.fromEntries(H.entries()):null})}return{dataRoutes:i,query:s,queryRoute:a}}function iy(e,t,r){return ce({},t,{statusCode:500,errors:{[t._deepestRenderedBoundaryId||e[0].id]:r}})}function bC(e,t,r,n,o,i,s){let a,c;if(i!=null&&s!=="path"){a=[];for(let u of t)if(a.push(u),u.route.id===i){c=u;break}}else a=t,c=t[t.length-1];let l=cC(o||".",ey(a).map(u=>u.pathnameBase),ml(e.pathname,r)||e.pathname,s==="path");return o==null&&(l.search=e.search,l.hash=e.hash),(o==null||o===""||o===".")&&c&&c.route.index&&!ly(l.search)&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n&&r!=="/"&&(l.pathname=l.pathname==="/"?r:_n([r,l.pathname])),fl(l)}function SC(e,t){let r=e;if(t){let n=e.findIndex(o=>o.route.id===t);n>=0&&(r=e.slice(0,n))}return r}async function Bm(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let o=r[e.id];ve(o,"No route found in manifest");let i={};for(let s in n){let c=o[s]!==void 0&&s!=="hasErrorBoundary";os(!c,'Route "'+o.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!c&&!WR.has(s)&&(i[s]=n[s])}Object.assign(o,i),Object.assign(o,ce({},t(o),{lazy:void 0}))}async function Jm(e,t,r,n,o,i,s,a){a===void 0&&(a={});let c,l,u,d=m=>{let g,v=new Promise((R,M)=>g=M);return u=()=>g(),t.signal.addEventListener("abort",u),Promise.race([m({request:t,params:r.params,context:a.requestContext}),v])};try{let m=r.route[e];if(r.route.lazy)if(m)l=(await Promise.all([d(m),Bm(r.route,i,o)]))[0];else if(await Bm(r.route,i,o),m=r.route[e],m)l=await d(m);else if(e==="action"){let g=new URL(t.url),v=g.pathname+g.search;throw $e(405,{method:t.method,pathname:v,routeId:r.route.id})}else return{type:Z.data,data:void 0};else if(m)l=await d(m);else{let g=new URL(t.url),v=g.pathname+g.search;throw $e(404,{pathname:v})}ve(l!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(m){c=Z.error,l=m}finally{u&&t.signal.removeEventListener("abort",u)}if(Ar(l)){let m=l.status;if(gC.has(m)){let R=l.headers.get("Location");if(ve(R,"Redirects returned/thrown from loaders/actions must have a Location header"),!vC.test(R))R=bC(new URL(t.url),n.slice(0,n.indexOf(r)+1),s,!0,R);else if(!a.isStaticRequest){let M=new URL(t.url),T=R.startsWith("//")?new URL(M.protocol+R):new URL(R),H=ml(T.pathname,s)!=null;T.origin===M.origin&&H&&(R=T.pathname+T.search+T.hash)}if(a.isStaticRequest)throw l.headers.set("Location",R),l;return{type:Z.redirect,status:m,location:R,revalidate:l.headers.get("X-Remix-Revalidate")!==null}}if(a.isRouteRequest)throw{type:c||Z.data,response:l};let g,v=l.headers.get("Content-Type");return v&&/\bapplication\/json\b/.test(v)?g=await l.json():g=await l.text(),c===Z.error?{type:c,error:new ns(m,l.statusText,g),headers:l.headers}:{type:Z.data,data:g,statusCode:l.status,headers:l.headers}}if(c===Z.error)return{type:c,error:l};if(EC(l)){var h,f;return{type:Z.deferred,deferredData:l,statusCode:(h=l.init)==null?void 0:h.status,headers:((f=l.init)==null?void 0:f.headers)&&new Headers(l.init.headers)}}return{type:Z.data,data:l}}function _C(e,t,r,n,o){let i={},s=null,a,c=!1,l={};return r.forEach((u,d)=>{let h=t[d].route.id;if(ve(!cy(u),"Cannot handle redirect results in processLoaderData"),hl(u)){let f=sy(e,h),m=u.error;n&&(m=Object.values(n)[0],n=void 0),s=s||{},s[f.route.id]==null&&(s[f.route.id]=m),i[h]=void 0,c||(c=!0,a=ot(u.error)?u.error.status:500),u.headers&&(l[h]=u.headers)}else ay(u)?(o.set(h,u.deferredData),i[h]=u.deferredData.data):i[h]=u.data,u.statusCode!=null&&u.statusCode!==200&&!c&&(a=u.statusCode),u.headers&&(l[h]=u.headers)}),n&&(s=n,i[Object.keys(n)[0]]=void 0),{loaderData:i,errors:s,statusCode:a||200,loaderHeaders:l}}function sy(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function Vm(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function $e(e,t){let{pathname:r,routeId:n,method:o,type:i}=t===void 0?{}:t,s="Unknown Server Error",a="Unknown @remix-run/router error";return e===400?(s="Bad Request",o&&r&&n?a="You made a "+o+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":i==="defer-action"?a="defer() is not supported in actions":i==="invalid-body"&&(a="Unable to encode submission body")):e===403?(s="Forbidden",a='Route "'+n+'" does not match URL "'+r+'"'):e===404?(s="Not Found",a='No route matches URL "'+r+'"'):e===405&&(s="Method Not Allowed",o&&r&&n?a="You made a "+o.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":o&&(a='Invalid request method "'+o.toUpperCase()+'"')),new ns(e||500,s,new Error(a),!0)}function ay(e){return e.type===Z.deferred}function hl(e){return e.type===Z.error}function cy(e){return(e&&e.type)===Z.redirect}function EC(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function Ar(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Gm(e){if(!Ar(e))return!1;let t=e.status,r=e.headers.get("Location");return t>=300&&t<=399&&r!=null}function AC(e){return e&&Ar(e.response)&&(e.type===Z.data||Z.error)}function zm(e){return yC.has(e.toLowerCase())}function RC(e){return hC.has(e.toLowerCase())}function ly(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Xm(e,t){let r=typeof t=="string"?En(t).search:t.search;if(e[e.length-1].route.index&&ly(r||""))return e[e.length-1];let n=ey(e);return n[n.length-1]}var Km,Z,WR,VR,GR,zR,XR,YR,QR,Wm,_n,lC,uC,dC,An,rs,pl,ty,ry,ns,ny,hC,mC,yC,gC,vC,wC,is,Rn=y(()=>{(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Km||(Km={}));(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Z||(Z={}));WR=new Set(["lazy","caseSensitive","path","id","index","children"]);VR=/^:\w+$/,GR=3,zR=2,XR=1,YR=10,QR=-2,Wm=e=>e==="*";_n=e=>e.join("/").replace(/\/\/+/g,"/"),lC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uC=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,An=function(t,r){r===void 0&&(r={});let n=typeof r=="number"?{status:r}:r,o=new Headers(n.headers);return o.has("Content-Type")||o.set("Content-Type","application/json; charset=utf-8"),new Response(JSON.stringify(t),ce({},n,{headers:o}))},rs=class extends Error{},pl=class{constructor(t,r){this.pendingKeysSet=new Set,this.subscribers=new Set,this.deferredKeys=[],ve(t&&typeof t=="object"&&!Array.isArray(t),"defer() only accepts plain objects");let n;this.abortPromise=new Promise((i,s)=>n=s),this.controller=new AbortController;let o=()=>n(new rs("Deferred data aborted"));this.unlistenAbortSignal=()=>this.controller.signal.removeEventListener("abort",o),this.controller.signal.addEventListener("abort",o),this.data=Object.entries(t).reduce((i,s)=>{let[a,c]=s;return Object.assign(i,{[a]:this.trackPromise(a,c)})},{}),this.done&&this.unlistenAbortSignal(),this.init=r}trackPromise(t,r){if(!(r instanceof Promise))return r;this.deferredKeys.push(t),this.pendingKeysSet.add(t);let n=Promise.race([r,this.abortPromise]).then(o=>this.onSettle(n,t,void 0,o),o=>this.onSettle(n,t,o));return n.catch(()=>{}),Object.defineProperty(n,"_tracked",{get:()=>!0}),n}onSettle(t,r,n,o){if(this.controller.signal.aborted&&n instanceof rs)return this.unlistenAbortSignal(),Object.defineProperty(t,"_error",{get:()=>n}),Promise.reject(n);if(this.pendingKeysSet.delete(r),this.done&&this.unlistenAbortSignal(),n===void 0&&o===void 0){let i=new Error('Deferred data for key "'+r+'" resolved/rejected with `undefined`, you must resolve/reject with a value or `null`.');return Object.defineProperty(t,"_error",{get:()=>i}),this.emit(!1,r),Promise.reject(i)}return o===void 0?(Object.defineProperty(t,"_error",{get:()=>n}),this.emit(!1,r),Promise.reject(n)):(Object.defineProperty(t,"_data",{get:()=>o}),this.emit(!1,r),o)}emit(t,r){this.subscribers.forEach(n=>n(t,r))}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}cancel(){this.controller.abort(),this.pendingKeysSet.forEach((t,r)=>this.pendingKeysSet.delete(r)),this.emit(!0)}async resolveData(t){let r=!1;if(!this.done){let n=()=>this.cancel();t.addEventListener("abort",n),r=await new Promise(o=>{this.subscribe(i=>{t.removeEventListener("abort",n),(i||this.done)&&o(i)})})}return r}get done(){return this.pendingKeysSet.size===0}get unwrappedData(){return ve(this.data!==null&&this.done,"Can only unwrap data on initialized and settled deferreds"),Object.entries(this.data).reduce((t,r)=>{let[n,o]=r;return Object.assign(t,{[n]:pC(o)})},{})}get pendingKeys(){return Array.from(this.pendingKeysSet)}};ty=function(t,r){r===void 0&&(r={});let n=typeof r=="number"?{status:r}:r;return new pl(t,n)},ry=function(t,r){r===void 0&&(r=302);let n=r;typeof n=="number"?n={status:n}:typeof n.status>"u"&&(n.status=302);let o=new Headers(n.headers);return o.set("Location",t),new Response(null,ce({},n,{headers:o}))},ns=class{constructor(t,r,n,o){o===void 0&&(o=!1),this.status=t,this.statusText=r||"",this.internal=o,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};ny=["post","put","patch","delete"],hC=new Set(ny),mC=["get",...ny],yC=new Set(mC),gC=new Set([301,302,303,307,308]),vC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wC=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),is=Symbol("deferred")});function uy(e){return e===it.Development||e===it.Production||e===it.Test}var it,yl=y(()=>{it=function(e){return e.Development="development",e.Production="production",e.Test="test",e}({})});function gl(e,t){if(e instanceof Error&&t!==it.Development){let r=new Error("Unexpected Server Error");return r.stack=void 0,r}return e}function vl(e,t){return Object.entries(e).reduce((r,[n,o])=>Object.assign(r,{[n]:gl(o,t)}),{})}function Rr(e,t){let r=gl(e,t);return{message:r.message,stack:r.stack}}function wl(e,t){if(!e)return null;let r=Object.entries(e),n={};for(let[o,i]of r)if(ot(i))n[o]={...i,__type:"RouteErrorResponse"};else if(i instanceof Error){let s=gl(i,t);n[o]={message:s.message,stack:s.stack,__type:"Error",...s.name!=="Error"?{__subType:s.name}:{}}}else n[o]=i;return n}var bl=y(()=>{Rn();yl();});function py(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function Rt(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Sl(e){return CC.has(e)}function hy(e){return Sl(e.status)}function PC(e){return e!=null&&typeof e.then=="function"&&e._tracked===!0}function my(e,t,r){let n=new TextEncoder;return new ReadableStream({async start(i){let s={},a=[];for(let[l,u]of Object.entries(e.data))PC(u)?(s[l]=`${xC}${l}`,(typeof u._data<"u"||typeof u._error<"u")&&a.push(l)):s[l]=u;i.enqueue(n.encode(JSON.stringify(s)+`

`));for(let l of a)dy(i,n,l,e.data[l],r);let c=e.subscribe((l,u)=>{u&&dy(i,n,u,e.data[u],r)});await e.resolveData(t),c(),i.close()}})}function dy(e,t,r,n,o){"_error"in n?e.enqueue(t.encode("error:"+JSON.stringify({[r]:n._error instanceof Error?Rr(n._error,o):n._error})+`

`)):e.enqueue(t.encode("data:"+JSON.stringify({[r]:n._data??null})+`

`))}var Cn,fy,ss,CC,xC,as=y(()=>{Rn();bl();Cn=(e,t={})=>An(e,t),fy=(e,t={})=>ty(e,t),ss=(e,t=302)=>ry(e,t);CC=new Set([301,302,303,307,308]);xC="__deferred_promise:"});function yy(e){return Object.keys(e).reduce((t,r)=>(t[r]=e[r].module,t),{})}var gy=y(()=>{});function wy(e,t){let r=t.errors?t.matches.findIndex(i=>t.errors[i.route.id]):-1,n=r>=0?t.matches.slice(0,r+1):t.matches,o;if(r>=0){let{actionHeaders:i,actionData:s,loaderHeaders:a,loaderData:c}=t;t.matches.slice(r).some(l=>{let u=l.route.id;return i[u]&&(!s||s[u]===void 0)?o=i[u]:a[u]&&c[u]===void 0&&(o=a[u]),o!=null})}return n.reduce((i,s,a)=>{let{id:c}=s.route,l=e.routes[c].module,u=t.loaderHeaders[c]||new Headers,d=t.actionHeaders[c]||new Headers,h=o!=null&&a===n.length-1,f=h&&o!==u&&o!==d;if(l.headers==null&&e.future.v2_headers){let g=new Headers(i);return f&&$t(o,g),$t(d,g),$t(u,g),g}let m=new Headers(l.headers?typeof l.headers=="function"?l.headers({loaderHeaders:u,parentHeaders:i,actionHeaders:d,errorHeaders:h?o:void 0}):l.headers:void 0);return f&&$t(o,m),$t(d,m),$t(u,m),$t(i,m),m},new Headers)}function $t(e,t){let r=e.get("Set-Cookie");r&&(0,vy.splitCookiesString)(r).forEach(o=>{t.append("Set-Cookie",o)})}var vy,by=y(()=>{vy=Tu(Ku());});function Sy(e,t){if(e===!1||e===null||typeof e>"u")throw console.error("The following error is a bug in Remix; please open an issue! https://github.com/remix-run/remix/issues/new"),new Error(t)}var _y=y(()=>{});function Ey(e,t){let r=ts(e,t);return r?r.map(n=>({params:n.params,pathname:n.pathname,route:n.route})):null}var Ay=y(()=>{Rn();});async function Ry({loadContext:e,action:t,params:r,request:n,routeId:o}){let i=await t({request:xy(Py(n)),context:e,params:r});if(i===void 0)throw new Error(`You defined an action for route "${o}" but didn't return anything from your \`action\` function. Please return a value or \`null\`.`);return Rt(i)?i:Cn(i)}async function Cy({loadContext:e,loader:t,params:r,request:n,routeId:o}){let i=await t({request:xy(Py(n)),context:e,params:r});if(i===void 0)throw new Error(`You defined a loader for route "${o}" but didn't return anything from your \`loader\` function. Please return a value or \`null\`.`);return py(i)?i.init&&Sl(i.init.status||200)?ss(new Headers(i.init.headers).get("Location"),i.init):i:Rt(i)?i:Cn(i)}function Py(e){let t=new URL(e.url),r=t.searchParams.getAll("index");t.searchParams.delete("index");let n=[];for(let o of r)o&&n.push(o);for(let o of n)t.searchParams.append("index",o);return new Request(t.href,e)}function xy(e){let t=new URL(e.url);return t.searchParams.delete("_data"),new Request(t.href,e)}var Oy=y(()=>{as();});function Ty(e){let t={};return Object.values(e).forEach(r=>{let n=r.parentId||"";t[n]||(t[n]=[]),t[n].push(r)}),t}function _l(e,t="",r=Ty(e)){return(r[t]||[]).map(n=>({...n,children:_l(e,n.id,r)}))}function El(e,t,r="",n=Ty(e)){return(n[r]||[]).map(o=>{let s={hasErrorBoundary:t.v2_errorBoundary===!0?o.id==="root"||o.module.ErrorBoundary!=null:o.id==="root"||o.module.CatchBoundary!=null||o.module.ErrorBoundary!=null,id:o.id,path:o.path,loader:o.module.loader?a=>Cy({request:a.request,params:a.params,loadContext:a.context,loader:o.module.loader,routeId:o.id}):void 0,action:o.module.action?a=>Ry({request:a.request,params:a.params,loadContext:a.context,action:o.module.action,routeId:o.id}):void 0,handle:o.module.handle};return o.index?{index:!0,...s}:{caseSensitive:o.caseSensitive,children:El(e,t,o.id,n),...s}})}var Iy=y(()=>{Oy();});function Hy(e){return e.replace(TC,t=>OC[t])}var OC,TC,qy=y(()=>{OC={"&":"\\u0026",">":"\\u003e","<":"\\u003c","\u2028":"\\u2028","\u2029":"\\u2029"},TC=/[&><\u2028\u2029]/g});function Al(e){return Hy(JSON.stringify(e))}var My=y(()=>{qy();});async function IC(e,t,r,n,o,i){try{let s=await t.queryRoute(n,{routeId:r,requestContext:o});if(hy(s)){let a=new Headers(s.headers);return a.set("X-Remix-Redirect",a.get("Location")),a.set("X-Remix-Status",s.status),a.delete("Location"),s.headers.get("Set-Cookie")!==null&&a.set("X-Remix-Revalidate","yes"),new Response(null,{status:204,headers:a})}if(is in s){let a=s[is],c=my(a,n.signal,e),l=a.init||{},u=new Headers(l.headers);return u.set("Content-Type","text/remix-deferred"),u.set("X-Remix-Response","yes"),l.headers=u,new Response(c,l)}return s.headers.set("X-Remix-Response","yes"),s}catch(s){if(Rt(s))return s.headers.set("X-Remix-Catch","yes"),s;if(ot(s))return s.error&&i(s.error),$y(s,e);let a=s instanceof Error?s:new Error("Unexpected Server Error");return i(a),An(Rr(a,e),{status:500,headers:{"X-Remix-Error":"yes"}})}}function Ly(e,t,r){let n=e[t]||e.root,o=ot(r)&&(!r.error||r.status===404);return o&&n.module.CatchBoundary||!o&&n.module.ErrorBoundary||!n.parentId?n.id:Ly(e,n.parentId,r)}function ky(e,t){if(!t.errors)return;let r={};for(let n of Object.keys(t.errors)){let o=t.errors[n],i=Ly(e.routes,n,o);r[i]=o}t.errors=r}async function HC(e,t,r,n,o,i){let s;try{s=await r.query(n,{requestContext:o})}catch(u){return i(u),new Response(null,{status:500})}if(Rt(s))return s;s.errors&&(Object.values(s.errors).forEach(u=>{(!ot(u)||u.error)&&i(u)}),s.errors=vl(s.errors,e)),t.future.v2_errorBoundary!==!0&&ky(t,s);let a=wy(t,s),c={manifest:t.assets,routeModules:yy(t.routes),staticHandlerContext:s,serverHandoffString:Al({url:s.location.pathname,state:{loaderData:s.loaderData,actionData:s.actionData,errors:wl(s.errors,e)},future:t.future}),future:t.future,serializeError:u=>Rr(u,e)},l=t.entry.module.default;try{return await l(n,s.statusCode,a,c,o)}catch(u){i(u),s=iy(r.dataRoutes,s,u),s.errors&&(s.errors=vl(s.errors,e)),t.future.v2_errorBoundary!==!0&&ky(t,s),c={...c,staticHandlerContext:s,serverHandoffString:Al({url:s.location.pathname,state:{loaderData:s.loaderData,actionData:s.actionData,errors:wl(s.errors,e)},future:t.future})};try{return await l(n,s.statusCode,a,c,o)}catch(d){return i(d),Ny(d,e)}}}async function qC(e,t,r,n,o,i){try{let s=await t.queryRoute(n,{routeId:r,requestContext:o});return Sy(Rt(s),"Expected a Response to be returned from queryRoute"),s}catch(s){return Rt(s)?(s.headers.set("X-Remix-Catch","yes"),s):ot(s)?(s.error&&i(s.error),$y(s,e)):(i(s),Ny(s,e))}}function $y(e,t){return An(Rr(e.error||new Error("Unexpected Server Error"),t),{status:e.status,statusText:e.statusText,headers:{"X-Remix-Error":"yes"}})}function Ny(e,t){let r="Unexpected Server Error";return t!==it.Production&&(r+=`

${String(e)}`),new Response(r,{status:500,headers:{"Content-Type":"text/plain"}})}var Dy,Uy=y(()=>{Rn();gy();bl();by();_y();yl();Ay();Iy();as();My();Dy=(e,t)=>{let r=_l(e.routes),n=El(e.routes,e.future),o=uy(t)?t:it.Production,i=oy(n),s=e.entry.module.handleError||((a,{request:c})=>{o!==it.Test&&!c.signal.aborted&&console.error(a)});return async function(c,l={}){let u=new URL(c.url),d=Ey(r,u.pathname),h=g=>s(g,{context:l,params:d&&d.length>0?d[0].params:{},request:c}),f;if(u.searchParams.has("_data")){let g=u.searchParams.get("_data");if(f=await IC(o,i,g,c,l,h),e.entry.module.handleDataRequest){var m;f=await e.entry.module.handleDataRequest(f,{context:l,params:(d==null||(m=d.find(v=>v.route.id==g))===null||m===void 0?void 0:m.params)||{},request:c})}}else d&&d[d.length-1].route.module.default==null?f=await qC(o,i,d.slice(-1)[0].route.id,c,l,h):f=await HC(o,e,i,c,l,h);return c.method==="HEAD"?new Response(null,{headers:f.headers,status:f.status,statusText:f.statusText}):f}}});function Rl(e){return`__flash_${e}__`}function Cl(e){Qi(e.isSigned,`The "${e.name}" cookie is not signed, but session cookies should be signed to prevent tampering on the client before they are sent back to the server. See https://remix.run/utils/cookies#signing-cookies for more information.`)}var Pn,Fy,Ky,Pl=y(()=>{es();ul();Pn=(e={},t="")=>{let r=new Map(Object.entries(e));return{get id(){return t},get data(){return Object.fromEntries(r)},has(n){return r.has(n)||r.has(Rl(n))},get(n){if(r.has(n))return r.get(n);let o=Rl(n);if(r.has(o)){let i=r.get(o);return r.delete(o),i}},set(n,o){r.set(n,o)},flash(n,o){r.set(Rl(n),o)},unset(n){r.delete(n)}}},Fy=e=>e!=null&&typeof e.id=="string"&&typeof e.data<"u"&&typeof e.has=="function"&&typeof e.get=="function"&&typeof e.set=="function"&&typeof e.flash=="function"&&typeof e.unset=="function",Ky=e=>({cookie:t,createData:r,readData:n,updateData:o,deleteData:i})=>{let s=Er(t)?t:e(t?.name||"__session",t);return Cl(s),{async getSession(a,c){let l=a&&await s.parse(a,c),u=l&&await n(l);return Pn(u||{},l||"")},async commitSession(a,c){let{id:l,data:u}=a;return l?await o(l,u,s.expires):l=await r(u,s.expires),s.serialize(l,c)},async destroySession(a,c){return await i(a.id),s.serialize("",{...c,expires:new Date(0)})}}}});var jy,Wy=y(()=>{es();Pl();jy=e=>({cookie:t}={})=>{let r=Er(t)?t:e(t?.name||"__session",t);return Cl(r),{async getSession(n,o){return Pn(n&&await r.parse(n,o)||{})},async commitSession(n,o){let i=await r.serialize(n.data,o);if(i.length>4096)throw new Error("Cookie length will exceed browser maximum. Length: "+i.length);return i},async destroySession(n,o){return r.serialize("",{...o,expires:new Date(0)})}}}});var By,Jy=y(()=>{By=e=>({cookie:t}={})=>{let r=0,n=new Map;return e({cookie:t,async createData(o,i){let s=(++r).toString();return n.set(s,{data:o,expires:i}),s},async readData(o){if(n.has(o)){let{data:i,expires:s}=n.get(o);if(!s||s>new Date)return i;s&&n.delete(o)}return null},async updateData(o,i,s){n.set(o,{data:i,expires:s})},async deleteData(o){n.delete(o)}})}});var Cr,xl=y(()=>{Cr=class extends Error{constructor(t,r){super(`Field "${t}" exceeded upload size of ${r} bytes.`),this.field=t,this.maxBytes=r}}});function Vy({filter:e,maxPartSize:t=3e6}={}){return async({filename:r,contentType:n,name:o,data:i})=>{if(e&&!await e({filename:r,contentType:n,name:o}))return;let s=0,a=[];for await(let c of i){if(s+=c.byteLength,s>t)throw new Cr(o,t);a.push(c)}return typeof r=="string"?new File(a,r,{type:n}):await new Blob(a,{type:n}).text()}}var Gy=y(()=>{xl();});async function zy(e,t){if(t??(t=process.env.REMIX_DEV_HTTP_ORIGIN),!t)throw Error("Dev server origin not set");let r=new URL(t);r.pathname="ping";let n=await fetch(r.href,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({buildHash:e.assets.version})}).catch(o=>{throw console.error(`Could not reach Remix dev server at ${r}`),o});if(!n.ok)throw console.error(`Could not reach Remix dev server at ${r} (${n.status})`),Error(await n.text())}function Xy(e){console.log(`[REMIX DEV] ${e.assets.version} ready`)}var Yy=y(()=>{});var Ct={};Ft(Ct,{MaxPartSizeExceededError:()=>Cr,broadcastDevReady:()=>zy,createCookieFactory:()=>$m,createCookieSessionStorageFactory:()=>jy,createMemorySessionStorageFactory:()=>By,createRequestHandler:()=>Dy,createSession:()=>Pn,createSessionStorageFactory:()=>Ky,defer:()=>fy,isCookie:()=>Er,isSession:()=>Fy,json:()=>Cn,logDevReady:()=>Xy,redirect:()=>ss,unstable_composeUploadHandlers:()=>Nm,unstable_createMemoryUploadHandler:()=>Vy,unstable_parseMultipartFormData:()=>Um});var Pt=y(()=>{es();Fm();as();Uy();Pl();Wy();Jy();Gy();xl();Yy();});var Qy=p(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var MC=Bt();function kC({params:e,handleClientError:t,session:r}){return async function(n,o){var i;let s=new e.api.clients.Graphql({session:r,apiVersion:(i=o)===null||i===void 0?void 0:i.apiVersion});try{var a,c,l;let u=await s.query({data:{query:n,variables:(a=o)===null||a===void 0?void 0:a.variables},tries:(c=o)===null||c===void 0?void 0:c.tries,extraHeaders:(l=o)===null||l===void 0?void 0:l.headers});return new Response(JSON.stringify(u.body),{headers:MC.flatHeaders(u.headers)})}catch(u){throw t?await t({error:u,params:e,session:r}):u}}}Ol.graphqlClientFactory=kC});var Zy=p(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});function DC({params:e,handleClientError:t,session:r}){let{api:n}=e,o=new Tl({params:e,handleClientError:t,session:r});if(n.rest){o.resources={};let i=LC({params:e,handleClientError:t,session:r});Object.entries(n.rest).forEach(([s,a])=>{class c extends a{}c.Client=i,Reflect.defineProperty(c,"name",{value:s}),Reflect.set(o.resources,s,c)})}return o}var Tl=class{constructor({params:t,session:r,handleClientError:n}){this.session=void 0,this.params=void 0,this.handleClientError=void 0,this.params=t,this.handleClientError=n,this.session=r}async get(t){return this.makeRequest({method:"GET",...t})}async post(t){return this.makeRequest({method:"POST",...t})}async put(t){return this.makeRequest({method:"PUT",...t})}async delete(t){return this.makeRequest({method:"DELETE",...t})}async makeRequest(t){let r=new this.params.api.clients.Rest({session:this.session}),n=Reflect.get(r,"request");try{let o=await n.call(r,t);return new Response(JSON.stringify(o.body),{headers:o.headers})}catch(o){throw this.handleClientError?await this.handleClientError({error:o,session:this.session,params:this.params}):new Error(o)}}};function LC({params:e,handleClientError:t,session:r}){let{api:n}=e,o=n.clients.Rest;return class extends o{async request(s){let a=new n.clients.Rest({session:r}),c=Reflect.get(a,"request");try{return await c.call(a,s)}catch(l){throw t?await t({error:l,params:e,session:r}):new Error(l)}}}}Il.restClientFactory=DC});var cs=p(Hl=>{"use strict";Object.defineProperty(Hl,"__esModule",{value:!0});var $C=Qy(),NC=Zy();function UC({params:e,handleClientError:t,session:r}){return{rest:NC.restClientFactory({params:e,session:r,handleClientError:t}),graphql:$C.graphqlClientFactory({params:e,session:r,handleClientError:t})}}Hl.adminClientFactory=UC});var us=p(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});var FC="https://cdn.shopify.com/shopifycloud/app-bridge.js",KC="X-Shopify-API-Request-Failure-Reauthorize-Url";ls.APP_BRIDGE_URL=FC;ls.REAUTH_URL_HEADER=KC});var ds=p(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var jC=us();function WC(e,t,r=[]){let{logger:n,config:o}=e;return function(s){let a=t.headers.get("Origin");if(a&&a!==o.appUrl){n.debug("Request comes from a different origin, adding CORS headers");let c=new Set(["Authorization","Content-Type",...r]);s.headers.set("Access-Control-Allow-Origin","*"),s.headers.set("Access-Control-Allow-Headers",[...c].join(", ")),s.headers.set("Access-Control-Expose-Headers",jC.REAUTH_URL_HEADER)}return s}}ql.ensureCORSHeadersFactory=WC});var kl=p(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});async function BC({api:e,logger:t},r,{checkAudience:n=!0}={}){t.debug("Validating session token");try{let o=await e.session.decodeSessionToken(r,{checkAudience:n});return t.debug("Session token is valid",{payload:JSON.stringify(o)}),o}catch(o){throw t.debug(`Failed to validate session token: ${o.message}`),new Response(void 0,{status:401,statusText:"Unauthorized"})}}Ml.validateSessionToken=BC});var fs=p(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});function JC(e){var t;return(t=e.headers.get("authorization"))===null||t===void 0?void 0:t.replace("Bearer ","")}Dl.getSessionTokenHeader=JC});var $l=p(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});var VC=Fo();function GC(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var zC=GC(VC);function XC({logger:e},t){if(zC.default(t.headers.get("User-Agent")))throw e.debug("Request is from a bot, skipping auth"),new Response(void 0,{status:410,statusText:"Gone"})}Ll.rejectBotRequest=XC});var Ul=p(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var YC=ds();function QC(e,t,r){if(t.method==="OPTIONS")throw YC.ensureCORSHeadersFactory(e,t,r)(new Response(null,{status:204,headers:{"Access-Control-Max-Age":"7200"}}))}Nl.respondToOptionsRequest=QC});var Kl=p(Fl=>{"use strict";Object.defineProperty(Fl,"__esModule",{value:!0});async function ZC(e,t,r,n){let{api:o,config:i}=e;throw await o.auth.begin({shop:n,callbackPath:i.auth.callbackPath,isOnline:r,rawRequest:t})}Fl.beginAuth=ZC});var Wl=p(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var eP=(Pt(),P(Ct));function tP(e,t,r){let{api:n,config:o}=e,s=new URL(t.url).searchParams,a=n.utils.sanitizeHost(s.get("host"));throw s.set("shop",r),s.set("exitIframe",`${o.auth.path}?shop=${r}`),a&&s.set("host",a),eP.redirect(`${o.auth.exitIframePath}?${s.toString()}`)}jl.redirectWithExitIframe=tP});var hs=p(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});var rP=us();function nP(e){throw new Response(void 0,{status:401,statusText:"Unauthorized",headers:eg(e)})}function eg(e){return new Headers({[rP.REAUTH_URL_HEADER]:e})}ps.getAppBridgeHeaders=eg;ps.redirectWithAppBridgeHeaders=nP});var Pr=p(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});var oP=Kl(),iP=Wl(),sP=hs();async function aP(e,t,r,n=!1){let{config:o}=e,s=new URL(t.url).searchParams.get("embedded")==="1";if(t.headers.get("authorization")){let c=new URL(o.auth.path,o.appUrl);c.searchParams.set("shop",r),sP.redirectWithAppBridgeHeaders(c.toString())}else if(s)iP.redirectWithExitIframe(e,t,r);else throw await oP.beginAuth(e,t,n,r)}Bl.redirectToAuthPage=aP});var tg=p(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});var cP=Le(),lP=Pr();Pt();function uP(e,t,r){return async function(o){let{api:i,logger:s}=e;s.debug("Cancelling billing",{shop:r.shop,...o});try{return await i.billing.cancel({session:r,subscriptionId:o.subscriptionId,isTest:o.isTest,prorate:o.prorate})}catch(a){throw a instanceof cP.HttpResponseError&&a.response.code===401?(s.debug("API token was invalid, redirecting to OAuth",{shop:r.shop}),await lP.redirectToAuthPage(e,t,r.shop)):a}}}Jl.cancelBillingFactory=uP});var rg=p(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});var dP=Le(),fP=Pr();Pt();function pP(e,t,r){let{api:n,logger:o}=e;return async function(s){let a={shop:r.shop,plans:s.plans,isTest:s.isTest};o.debug("Checking billing for the shop",a);let c;try{c=await n.billing.check({session:r,plans:s.plans,isTest:s.isTest,returnObject:!0})}catch(l){throw l instanceof dP.HttpResponseError&&l.response.code===401?(o.debug("API token was invalid, redirecting to OAuth",a),await fP.redirectToAuthPage(e,t,r.shop)):l}if(!c.hasActivePayment)throw o.debug("Billing check failed",a),await s.onFailure(new Error("Billing check failed"));return o.debug("Billing check succeeded",a),c}}Vl.requireBillingFactory=pP});var og=p(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var hP=Le(),ng=(Pt(),P(Ct)),mP=Pr(),yP=hs();function gP(e,t,r){return async function({plan:o,isTest:i,returnUrl:s,...a}){let{api:c,logger:l}=e;l.info("Requesting billing",{shop:r.shop,plan:o,isTest:i,returnUrl:s});let u;try{u=await c.billing.request({plan:o,session:r,isTest:i,returnUrl:s,returnObject:!0,...a})}catch(d){throw d instanceof hP.HttpResponseError&&d.response.code===401?(l.debug("API token was invalid, redirecting to OAuth",{shop:r.shop}),await mP.redirectToAuthPage(e,t,r.shop)):d}throw vP(e,t,u.confirmationUrl,r.shop)}}function vP(e,t,r,n){let{config:o,logger:i}=e;i.debug("Redirecting out of app",{url:r});let s=new URL(t.url),a=s.searchParams.get("embedded")==="1";if(t.headers.get("authorization"))throw new Response(void 0,{status:401,statusText:"Unauthorized",headers:yP.getAppBridgeHeaders(r)});if(a){let l=new URLSearchParams({shop:n,host:s.searchParams.get("host"),exitIframe:r});throw ng.redirect(`${o.auth.exitIframePath}?${l.toString()}`)}else throw ng.redirect(r)}Gl.requestBillingFactory=gP});var ig=p(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var wP=Le(),bP=Pr();function SP({request:e}){return async function({error:r,params:n,session:o}){throw r instanceof wP.HttpResponseError?(n.logger.debug(`Got an HTTP response error from the API: ${r.message}`,{code:r.response.code,statusText:r.response.statusText,body:JSON.stringify(r.response.body)}),r.response.code===401?await bP.redirectToAuthPage(n,e,o.shop):new Response(JSON.stringify(r.response.body),{status:r.response.code,headers:{"Content-Type":r.response.headers["Content-Type"]}})):(n.logger.debug(`Got a response error from the API: ${r.message}`),r)}}zl.handleClientErrorFactory=SP});var ag=p(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});var _P=us(),sg;function EP(e){sg=e}function AP(){return sg||_P.APP_BRIDGE_URL}ms.appBridgeUrl=AP;ms.setAppBridgeUrlOverride=EP});var Xl=p(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});function RP(e){let{api:t,config:r}=e;return function(n,o){let{searchParams:i}=new URL(n.url),s=t.utils.sanitizeShop(i.get("shop"));cg(o,r.isEmbeddedApp,s)}}function cg(e,t,r){r&&e.set("Link",'<https://cdn.shopify.com/shopifycloud/app-bridge.js>; rel="preload"; as="script";'),t?r&&e.set("Content-Security-Policy",`frame-ancestors https://${r} https://admin.shopify.com https://*.spin.dev;`):e.set("Content-Security-Policy","frame-ancestors 'none';")}ys.addDocumentResponseHeaders=cg;ys.addDocumentResponseHeadersFactory=RP});var Ql=p(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});var CP=ag(),PP=Xl();function xP({config:e},t,r){let n="";if(r){var o;let s=new URL(r.url,e.appUrl),a=(o=r.target)!==null&&o!==void 0?o:"_top";n=`<script>window.open(${JSON.stringify(s.toString())}, ${JSON.stringify(a)})<\/script>`}let i=new Headers({"content-type":"text/html;charset=utf-8"});throw PP.addDocumentResponseHeaders(i,e.isEmbeddedApp,new URL(t.url).searchParams.get("shop")),new Response(`
      <script data-api-key="${e.apiKey}" src="${CP.appBridgeUrl()}"><\/script>
      ${n}
    `,{headers:i})}Yl.renderAppBridge=xP});var hg=p(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var lg=(Pt(),P(Ct)),dg=fs(),ug=Ql(),OP=hs();function TP(e,t){let{config:r}=e;return function(o,i){let{searchParams:s}=new URL(t.url),a=new URL(o,r.appUrl);(a.origin===r.appUrl||o.startsWith("/"))&&s.forEach((u,d)=>{a.searchParams.has(d)||a.searchParams.set(d,u)});let l=typeof i!="number"&&i?.target||"_self";if(l==="_self"){if(fg(t))throw ug.renderAppBridge(e,t,{url:a.toString(),target:l});return lg.redirect(a.toString(),i)}else{if(IP(t))throw OP.redirectWithAppBridgeHeaders(a.toString());if(pg(t))throw ug.renderAppBridge(e,t,{url:a.toString(),target:l})}return lg.redirect(o,i)}}function fg(e){return Boolean(dg.getSessionTokenHeader(e))&&e.headers.has("X-Shopify-Bounce")}function IP(e){let{searchParams:t}=new URL(e.url),r=e.method==="GET",n=Boolean(dg.getSessionTokenHeader(e)),o=t.has("id_token");return n&&!o&&!fg(e)&&(!pg(e)||!r)}function pg(e){let{searchParams:t}=new URL(e.url);return t.get("embedded")==="1"}Zl.redirectFactory=TP});var bg=p(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});var gs=(Pt(),P(Ct)),xn=Le(),HP=cs(),qP=ds(),mg=kl(),MP=fs(),kP=$l(),DP=Ul(),LP=tg(),$P=rg(),NP=og(),On=Kl(),UP=ig(),yg=Pr(),gg=Wl(),FP=hg(),vg=Ql(),wg="id_token",eu=class{constructor({api:t,config:r,logger:n}){this.api=void 0,this.config=void 0,this.logger=void 0,this.api=t,this.config=r,this.logger=n}async authenticateAdmin(t){let{api:r,logger:n,config:o}=this;kP.rejectBotRequest({api:r,logger:n,config:o},t),DP.respondToOptionsRequest({api:r,logger:n,config:o},t);let i=qP.ensureCORSHeadersFactory({api:r,logger:n,config:o},t),s;try{s=await this.authenticateAndGetSessionContext(t)}catch(c){throw c instanceof Response&&i(c),c}let a={admin:this.createAdminApiContext(t,s.session),billing:this.createBillingContext(t,s.session),session:s.session,cors:i};return o.isEmbeddedApp?{...a,sessionToken:s.token,redirect:FP.redirectFactory({api:r,config:o,logger:n},t)}:a}async authenticateAndGetSessionContext(t){let{api:r,logger:n,config:o}=this,i={api:r,logger:n,config:o},s=new URL(t.url),a=s.pathname===o.auth.patchSessionTokenPath,c=s.pathname===o.auth.exitIframePath,l=s.pathname===o.auth.path,u=s.pathname===o.auth.callbackPath,d=MP.getSessionTokenHeader(t);if(n.info("Authenticating admin request"),a)throw n.debug("Rendering bounce page"),vg.renderAppBridge(i,t);if(c){let h=s.searchParams.get("exitIframe");throw n.debug("Rendering exit iframe page",{destination:h}),vg.renderAppBridge(i,t,{url:h})}else{if(u)throw await this.handleAuthCallbackRequest(t);if(l)throw await this.handleAuthBeginRequest(t);if(d){let h=await mg.validateSessionToken({api:r,logger:n,config:o},d);return this.validateAuthenticatedSession(t,h)}else return await this.validateUrlParams(t),await this.ensureInstalledOnShop(t),await this.ensureAppIsEmbeddedIfRequired(t),await this.ensureSessionTokenSearchParamIfRequired(t),this.ensureSessionExists(t)}}async handleAuthBeginRequest(t){let{api:r,config:n,logger:o}=this;o.info("Handling OAuth begin request");let i=this.ensureValidShopParam(t);throw o.debug("OAuth request contained valid shop",{shop:i}),n.isEmbeddedApp&&t.headers.get("Sec-Fetch-Dest")==="iframe"?(o.debug("Auth request in iframe detected, exiting iframe",{shop:i}),gg.redirectWithExitIframe({api:r,config:n,logger:o},t,i)):await On.beginAuth({api:r,config:n,logger:o},t,!1,i)}async handleAuthCallbackRequest(t){let{api:r,config:n,logger:o}=this;o.info("Handling OAuth callback request");let i=this.ensureValidShopParam(t);try{let{session:s,headers:a}=await r.auth.callback({rawRequest:t});throw await n.sessionStorage.storeSession(s),n.useOnlineTokens&&!s.isOnline&&(o.info("Requesting online access token for offline session"),await On.beginAuth({api:r,config:n,logger:o},t,!0,i)),n.hooks.afterAuth&&(o.info("Running afterAuth hook"),await n.hooks.afterAuth({session:s,admin:this.createAdminApiContext(t,s)})),await this.redirectToShopifyOrAppRoot(t,a)}catch(s){throw s instanceof Response?s:(o.error("Error during OAuth callback",{error:s.message}),s instanceof xn.CookieNotFound?await this.handleAuthBeginRequest(t):s instanceof xn.InvalidHmacError||s instanceof xn.InvalidOAuthError?new Response(void 0,{status:400,statusText:"Invalid OAuth Request"}):new Response(void 0,{status:500,statusText:"Internal Server Error"}))}}async validateUrlParams(t){let{api:r,config:n,logger:o}=this;if(n.isEmbeddedApp){let i=new URL(t.url),s=r.utils.sanitizeShop(i.searchParams.get("shop"));if(!s)throw o.debug("Missing or invalid shop, redirecting to login path",{shop:s}),gs.redirect(n.auth.loginPath);if(!r.utils.sanitizeHost(i.searchParams.get("host")))throw o.debug("Invalid host, redirecting to login path",{host:i.searchParams.get("host")}),gs.redirect(n.auth.loginPath)}}async ensureInstalledOnShop(t){let{api:r,config:n,logger:o}=this,i=new URL(t.url),s=i.searchParams.get("shop"),a=i.searchParams.get("embedded")==="1";o.debug("Ensuring app is installed on shop",{shop:s});let c=s?r.session.getOfflineId(s):await r.session.getCurrentId({isOnline:!1,rawRequest:t});if(!c)throw o.info("Could not find a shop, can't authenticate request"),new Response(void 0,{status:400,statusText:"Bad Request"});let l=await n.sessionStorage.loadSession(c);if(!l)if(o.info("Shop hasn't installed app yet, redirecting to OAuth",{shop:s}),a)gg.redirectWithExitIframe({api:r,config:n,logger:o},t,s);else throw await On.beginAuth({api:r,config:n,logger:o},t,!1,s);if(s=s||l.shop,n.isEmbeddedApp&&!a)try{o.debug("Ensuring offline session is valid before embedding",{shop:s}),await this.testSession(l),o.debug("Offline session is still valid, embedding app",{shop:s})}catch(u){if(u instanceof xn.HttpResponseError){if(u.response.code===401)throw o.info("Shop session is no longer valid, redirecting to OAuth",{shop:s}),await On.beginAuth({api:r,config:n,logger:o},t,!1,s);{let d=JSON.stringify(u.response.body,null,2);throw o.error(`Unexpected error during session validation: ${d}`,{shop:s}),new Response(void 0,{status:u.response.code,statusText:u.response.statusText})}}else if(u instanceof xn.GraphqlQueryError){let d={shop:s};throw u.response&&(d.response=JSON.stringify(u.response)),o.error(`Unexpected error during session validation: ${u.message}`,d),new Response(void 0,{status:500,statusText:"Internal Server Error"})}}}async testSession(t){let{api:r}=this;await new r.clients.Graphql({session:t}).query({data:`#graphql
        query shopifyAppShopName {
          shop {
            name
          }
        }
      `})}ensureValidShopParam(t){let r=new URL(t.url),{api:n}=this,o=n.utils.sanitizeShop(r.searchParams.get("shop"));if(!o)throw new Response("Shop param is invalid",{status:400});return o}async ensureAppIsEmbeddedIfRequired(t){let{api:r,logger:n}=this,o=new URL(t.url),i=o.searchParams.get("shop");r.config.isEmbeddedApp&&o.searchParams.get("embedded")!=="1"&&(n.debug("App is not embedded, redirecting to Shopify",{shop:i}),await this.redirectToShopifyOrAppRoot(t))}async ensureSessionTokenSearchParamIfRequired(t){let{api:r,logger:n}=this,o=new URL(t.url),i=o.searchParams.get("shop"),s=o.searchParams.get(wg);r.config.isEmbeddedApp&&!s&&(n.debug("Missing session token in search params, going to bounce page",{shop:i}),this.redirectToBouncePage(o))}async ensureSessionExists(t){let{api:r,config:n,logger:o}=this,i=new URL(t.url),s=i.searchParams.get("shop"),a=i.searchParams.get(wg);if(r.config.isEmbeddedApp){o.debug("Session token is present in query params, validating session",{shop:s});let c=await mg.validateSessionToken({api:r,config:n,logger:o},a);return this.validateAuthenticatedSession(t,c)}else{let c=await r.session.getCurrentId({isOnline:n.useOnlineTokens,rawRequest:t});if(!c)throw o.debug("Session id not found in cookies, redirecting to OAuth",{shop:s}),await On.beginAuth({api:r,config:n,logger:o},t,!1,s);return{session:await this.loadSession(t,s,c)}}}async validateAuthenticatedSession(t,r){let{config:n,logger:o,api:i}=this,a=new URL(r.dest).hostname,c=n.useOnlineTokens?i.session.getJwtSessionId(a,r.sub):i.session.getOfflineId(a),l=await this.loadSession(t,a,c);return o.debug("Found session, request is valid",{shop:a}),{session:l,token:r}}async loadSession(t,r,n){let{api:o,config:i,logger:s}=this;s.debug("Loading session from storage",{sessionId:n});let a=await i.sessionStorage.loadSession(n);return a?a.isActive(i.scopes)||(s.debug("Found a session, but it has expired, redirecting to OAuth",{shop:r}),await yg.redirectToAuthPage({api:o,config:i,logger:s},t,r)):(s.debug("No session found, redirecting to OAuth",{shop:r}),await yg.redirectToAuthPage({api:o,config:i,logger:s},t,r)),a}async redirectToShopifyOrAppRoot(t,r){let{api:n}=this,o=new URL(t.url),i=n.utils.sanitizeHost(o.searchParams.get("host")),s=n.utils.sanitizeShop(o.searchParams.get("shop")),a=n.config.isEmbeddedApp?await n.auth.getEmbeddedAppUrl({rawRequest:t}):`/?shop=${s}&host=${encodeURIComponent(i)}`;throw gs.redirect(a,{headers:r})}redirectToBouncePage(t){let{config:r}=this;throw t.searchParams.set("shopify-reload",`${r.appUrl}${t.pathname}${t.search}`),gs.redirect(`${r.auth.patchSessionTokenPath}${t.search}`)}createBillingContext(t,r){let{api:n,logger:o,config:i}=this;return{require:$P.requireBillingFactory({api:n,logger:o,config:i},t,r),request:NP.requestBillingFactory({api:n,logger:o,config:i},t,r),cancel:LP.cancelBillingFactory({api:n,logger:o,config:i},t,r)}}createAdminApiContext(t,r){return HP.adminClientFactory({session:r,params:{api:this.api,config:this.config,logger:this.logger},handleClientError:UP.handleClientErrorFactory({request:t})})}};tu.AuthStrategy=eu});var Sg=p(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});function KP({api:e,config:t,logger:r}){return async function(o){if(o.method!=="POST")throw r.debug("Received a non-POST request for a webhook. Only POST requests are allowed.",{url:o.url,method:o.method}),new Response(void 0,{status:405,statusText:"Method not allowed"});let i=await o.text(),s=await e.webhooks.validate({rawBody:i,rawRequest:o});if(!s.valid)throw r.debug("Webhook validation failed",s),new Response(void 0,{status:400,statusText:"Bad Request"});let a=e.session.getOfflineId(s.domain),c=await t.sessionStorage.loadSession(a),l={apiVersion:s.apiVersion,shop:s.domain,topic:s.topic,webhookId:s.webhookId,payload:JSON.parse(i),session:void 0,admin:void 0};if(!c)return l;let u=new e.clients.Rest({session:c,apiVersion:s.apiVersion}),d=new e.clients.Graphql({session:c,apiVersion:s.apiVersion});return Object.entries(e.rest).forEach(([h,f])=>{Reflect.set(u,h,f)}),{...l,session:c,admin:{rest:u,graphql:d}}}}ru.authenticateWebhookFactory=KP});var Tn=p((mN,_g)=>{var jP="2.0.0",WP=Number.MAX_SAFE_INTEGER||9007199254740991,BP=16,JP=256-6,VP=["major","premajor","minor","preminor","patch","prepatch","prerelease"];_g.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:BP,MAX_SAFE_BUILD_LENGTH:JP,MAX_SAFE_INTEGER:WP,RELEASE_TYPES:VP,SEMVER_SPEC_VERSION:jP,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var In=p((yN,Eg)=>{var GP=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};Eg.exports=GP});var xr=p((Ge,Ag)=>{var{MAX_SAFE_COMPONENT_LENGTH:nu,MAX_SAFE_BUILD_LENGTH:zP,MAX_LENGTH:XP}=Tn(),YP=In();Ge=Ag.exports={};var QP=Ge.re=[],ZP=Ge.safeRe=[],b=Ge.src=[],ex=Ge.safeSrc=[],S=Ge.t={},tx=0,ou="[a-zA-Z0-9-]",rx=[["\\s",1],["\\d",XP],[ou,zP]],nx=e=>{for(let[t,r]of rx)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},x=(e,t,r)=>{let n=nx(t),o=tx++;YP(e,o,t),S[e]=o,b[o]=t,ex[o]=n,QP[o]=new RegExp(t,r?"g":void 0),ZP[o]=new RegExp(n,r?"g":void 0)};x("NUMERICIDENTIFIER","0|[1-9]\\d*");x("NUMERICIDENTIFIERLOOSE","\\d+");x("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${ou}*`);x("MAINVERSION",`(${b[S.NUMERICIDENTIFIER]})\\.(${b[S.NUMERICIDENTIFIER]})\\.(${b[S.NUMERICIDENTIFIER]})`);x("MAINVERSIONLOOSE",`(${b[S.NUMERICIDENTIFIERLOOSE]})\\.(${b[S.NUMERICIDENTIFIERLOOSE]})\\.(${b[S.NUMERICIDENTIFIERLOOSE]})`);x("PRERELEASEIDENTIFIER",`(?:${b[S.NUMERICIDENTIFIER]}|${b[S.NONNUMERICIDENTIFIER]})`);x("PRERELEASEIDENTIFIERLOOSE",`(?:${b[S.NUMERICIDENTIFIERLOOSE]}|${b[S.NONNUMERICIDENTIFIER]})`);x("PRERELEASE",`(?:-(${b[S.PRERELEASEIDENTIFIER]}(?:\\.${b[S.PRERELEASEIDENTIFIER]})*))`);x("PRERELEASELOOSE",`(?:-?(${b[S.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${b[S.PRERELEASEIDENTIFIERLOOSE]})*))`);x("BUILDIDENTIFIER",`${ou}+`);x("BUILD",`(?:\\+(${b[S.BUILDIDENTIFIER]}(?:\\.${b[S.BUILDIDENTIFIER]})*))`);x("FULLPLAIN",`v?${b[S.MAINVERSION]}${b[S.PRERELEASE]}?${b[S.BUILD]}?`);x("FULL",`^${b[S.FULLPLAIN]}$`);x("LOOSEPLAIN",`[v=\\s]*${b[S.MAINVERSIONLOOSE]}${b[S.PRERELEASELOOSE]}?${b[S.BUILD]}?`);x("LOOSE",`^${b[S.LOOSEPLAIN]}$`);x("GTLT","((?:<|>)?=?)");x("XRANGEIDENTIFIERLOOSE",`${b[S.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);x("XRANGEIDENTIFIER",`${b[S.NUMERICIDENTIFIER]}|x|X|\\*`);x("XRANGEPLAIN",`[v=\\s]*(${b[S.XRANGEIDENTIFIER]})(?:\\.(${b[S.XRANGEIDENTIFIER]})(?:\\.(${b[S.XRANGEIDENTIFIER]})(?:${b[S.PRERELEASE]})?${b[S.BUILD]}?)?)?`);x("XRANGEPLAINLOOSE",`[v=\\s]*(${b[S.XRANGEIDENTIFIERLOOSE]})(?:\\.(${b[S.XRANGEIDENTIFIERLOOSE]})(?:\\.(${b[S.XRANGEIDENTIFIERLOOSE]})(?:${b[S.PRERELEASELOOSE]})?${b[S.BUILD]}?)?)?`);x("XRANGE",`^${b[S.GTLT]}\\s*${b[S.XRANGEPLAIN]}$`);x("XRANGELOOSE",`^${b[S.GTLT]}\\s*${b[S.XRANGEPLAINLOOSE]}$`);x("COERCEPLAIN",`(^|[^\\d])(\\d{1,${nu}})(?:\\.(\\d{1,${nu}}))?(?:\\.(\\d{1,${nu}}))?`);x("COERCE",`${b[S.COERCEPLAIN]}(?:$|[^\\d])`);x("COERCEFULL",b[S.COERCEPLAIN]+`(?:${b[S.PRERELEASE]})?(?:${b[S.BUILD]})?(?:$|[^\\d])`);x("COERCERTL",b[S.COERCE],!0);x("COERCERTLFULL",b[S.COERCEFULL],!0);x("LONETILDE","(?:~>?)");x("TILDETRIM",`(\\s*)${b[S.LONETILDE]}\\s+`,!0);Ge.tildeTrimReplace="$1~";x("TILDE",`^${b[S.LONETILDE]}${b[S.XRANGEPLAIN]}$`);x("TILDELOOSE",`^${b[S.LONETILDE]}${b[S.XRANGEPLAINLOOSE]}$`);x("LONECARET","(?:\\^)");x("CARETTRIM",`(\\s*)${b[S.LONECARET]}\\s+`,!0);Ge.caretTrimReplace="$1^";x("CARET",`^${b[S.LONECARET]}${b[S.XRANGEPLAIN]}$`);x("CARETLOOSE",`^${b[S.LONECARET]}${b[S.XRANGEPLAINLOOSE]}$`);x("COMPARATORLOOSE",`^${b[S.GTLT]}\\s*(${b[S.LOOSEPLAIN]})$|^$`);x("COMPARATOR",`^${b[S.GTLT]}\\s*(${b[S.FULLPLAIN]})$|^$`);x("COMPARATORTRIM",`(\\s*)${b[S.GTLT]}\\s*(${b[S.LOOSEPLAIN]}|${b[S.XRANGEPLAIN]})`,!0);Ge.comparatorTrimReplace="$1$2$3";x("HYPHENRANGE",`^\\s*(${b[S.XRANGEPLAIN]})\\s+-\\s+(${b[S.XRANGEPLAIN]})\\s*$`);x("HYPHENRANGELOOSE",`^\\s*(${b[S.XRANGEPLAINLOOSE]})\\s+-\\s+(${b[S.XRANGEPLAINLOOSE]})\\s*$`);x("STAR","(<|>)?=?\\s*\\*");x("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");x("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var vs=p((gN,Rg)=>{var ox=Object.freeze({loose:!0}),ix=Object.freeze({}),sx=e=>e?typeof e!="object"?ox:e:ix;Rg.exports=sx});var iu=p((vN,xg)=>{var Cg=/^[0-9]+$/,Pg=(e,t)=>{let r=Cg.test(e),n=Cg.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},ax=(e,t)=>Pg(t,e);xg.exports={compareIdentifiers:Pg,rcompareIdentifiers:ax}});var ye=p((wN,Hg)=>{var ws=In(),{MAX_LENGTH:Og,MAX_SAFE_INTEGER:bs}=Tn(),{safeRe:Tg,safeSrc:Ig,t:Ss}=xr(),cx=vs(),{compareIdentifiers:Or}=iu(),Pe=class{constructor(t,r){if(r=cx(r),t instanceof Pe){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Og)throw new TypeError(`version is longer than ${Og} characters`);ws("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=t.trim().match(r.loose?Tg[Ss.LOOSE]:Tg[Ss.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>bs||this.major<0)throw new TypeError("Invalid major version");if(this.minor>bs||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>bs||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<bs)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ws("SemVer.compare",this.version,this.options,t),!(t instanceof Pe)){if(typeof t=="string"&&t===this.version)return 0;t=new Pe(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Pe||(t=new Pe(t,this.options)),Or(this.major,t.major)||Or(this.minor,t.minor)||Or(this.patch,t.patch)}comparePre(t){if(t instanceof Pe||(t=new Pe(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=t.prerelease[r];if(ws("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Or(n,o)}while(++r)}compareBuild(t){t instanceof Pe||(t=new Pe(t,this.options));let r=0;do{let n=this.build[r],o=t.build[r];if(ws("build compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Or(n,o)}while(++r)}inc(t,r,n){if(t.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let o=new RegExp(`^${this.options.loose?Ig[Ss.PRERELEASELOOSE]:Ig[Ss.PRERELEASE]}$`),i=`-${r}`.match(o);if(!i||i[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let i=[r,o];n===!1&&(i=[r]),Or(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Hg.exports=Pe});var Nt=p((bN,Mg)=>{var qg=ye(),lx=(e,t,r=!1)=>{if(e instanceof qg)return e;try{return new qg(e,t)}catch(n){if(!r)return null;throw n}};Mg.exports=lx});var Dg=p((SN,kg)=>{var ux=Nt(),dx=(e,t)=>{let r=ux(e,t);return r?r.version:null};kg.exports=dx});var $g=p((_N,Lg)=>{var fx=Nt(),px=(e,t)=>{let r=fx(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};Lg.exports=px});var Fg=p((EN,Ug)=>{var Ng=ye(),hx=(e,t,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new Ng(e instanceof Ng?e.version:e,r).inc(t,n,o).version}catch{return null}};Ug.exports=hx});var Wg=p((AN,jg)=>{var Kg=Nt(),mx=(e,t)=>{let r=Kg(e,null,!0),n=Kg(t,null,!0),o=r.compare(n);if(o===0)return null;let i=o>0,s=i?r:n,a=i?n:r,c=!!s.prerelease.length;if(!!a.prerelease.length&&!c){if(!a.patch&&!a.minor)return"major";if(a.compareMain(s)===0)return a.minor&&!a.patch?"minor":"patch"}let u=c?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"};jg.exports=mx});var Jg=p((RN,Bg)=>{var yx=ye(),gx=(e,t)=>new yx(e,t).major;Bg.exports=gx});var Gg=p((CN,Vg)=>{var vx=ye(),wx=(e,t)=>new vx(e,t).minor;Vg.exports=wx});var Xg=p((PN,zg)=>{var bx=ye(),Sx=(e,t)=>new bx(e,t).patch;zg.exports=Sx});var Qg=p((xN,Yg)=>{var _x=Nt(),Ex=(e,t)=>{let r=_x(e,t);return r&&r.prerelease.length?r.prerelease:null};Yg.exports=Ex});var Oe=p((ON,ev)=>{var Zg=ye(),Ax=(e,t,r)=>new Zg(e,r).compare(new Zg(t,r));ev.exports=Ax});var rv=p((TN,tv)=>{var Rx=Oe(),Cx=(e,t,r)=>Rx(t,e,r);tv.exports=Cx});var ov=p((IN,nv)=>{var Px=Oe(),xx=(e,t)=>Px(e,t,!0);nv.exports=xx});var _s=p((HN,sv)=>{var iv=ye(),Ox=(e,t,r)=>{let n=new iv(e,r),o=new iv(t,r);return n.compare(o)||n.compareBuild(o)};sv.exports=Ox});var cv=p((qN,av)=>{var Tx=_s(),Ix=(e,t)=>e.sort((r,n)=>Tx(r,n,t));av.exports=Ix});var uv=p((MN,lv)=>{var Hx=_s(),qx=(e,t)=>e.sort((r,n)=>Hx(n,r,t));lv.exports=qx});var Hn=p((kN,dv)=>{var Mx=Oe(),kx=(e,t,r)=>Mx(e,t,r)>0;dv.exports=kx});var Es=p((DN,fv)=>{var Dx=Oe(),Lx=(e,t,r)=>Dx(e,t,r)<0;fv.exports=Lx});var su=p((LN,pv)=>{var $x=Oe(),Nx=(e,t,r)=>$x(e,t,r)===0;pv.exports=Nx});var au=p(($N,hv)=>{var Ux=Oe(),Fx=(e,t,r)=>Ux(e,t,r)!==0;hv.exports=Fx});var As=p((NN,mv)=>{var Kx=Oe(),jx=(e,t,r)=>Kx(e,t,r)>=0;mv.exports=jx});var Rs=p((UN,yv)=>{var Wx=Oe(),Bx=(e,t,r)=>Wx(e,t,r)<=0;yv.exports=Bx});var cu=p((FN,gv)=>{var Jx=su(),Vx=au(),Gx=Hn(),zx=As(),Xx=Es(),Yx=Rs(),Qx=(e,t,r,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Jx(e,r,n);case"!=":return Vx(e,r,n);case">":return Gx(e,r,n);case">=":return zx(e,r,n);case"<":return Xx(e,r,n);case"<=":return Yx(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};gv.exports=Qx});var wv=p((KN,vv)=>{var Zx=ye(),eO=Nt(),{safeRe:Cs,t:Ps}=xr(),tO=(e,t)=>{if(e instanceof Zx)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(t.includePrerelease?Cs[Ps.COERCEFULL]:Cs[Ps.COERCE]);else{let c=t.includePrerelease?Cs[Ps.COERCERTLFULL]:Cs[Ps.COERCERTL],l;for(;(l=c.exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),c.lastIndex=l.index+l[1].length+l[2].length;c.lastIndex=-1}if(r===null)return null;let n=r[2],o=r[3]||"0",i=r[4]||"0",s=t.includePrerelease&&r[5]?`-${r[5]}`:"",a=t.includePrerelease&&r[6]?`+${r[6]}`:"";return eO(`${n}.${o}.${i}${s}${a}`,t)};vv.exports=tO});var Sv=p((jN,bv)=>{var lu=class{constructor(){this.max=1e3,this.map=new Map}get(t){let r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(t,r)}return this}};bv.exports=lu});var Te=p((WN,Rv)=>{var rO=/\s+/g,Ut=class{constructor(t,r){if(r=oO(r),t instanceof Ut)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new Ut(t.raw,r);if(t instanceof uu)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().replace(rO," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!Ev(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&dO(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let r=this.set[t];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let n=((this.options.includePrerelease&&lO)|(this.options.loose&&uO))+":"+t,o=_v.get(n);if(o)return o;let i=this.options.loose,s=i?Re[we.HYPHENRANGELOOSE]:Re[we.HYPHENRANGE];t=t.replace(s,SO(this.options.includePrerelease)),J("hyphen replace",t),t=t.replace(Re[we.COMPARATORTRIM],sO),J("comparator trim",t),t=t.replace(Re[we.TILDETRIM],aO),J("tilde trim",t),t=t.replace(Re[we.CARETTRIM],cO),J("caret trim",t);let a=t.split(" ").map(d=>fO(d,this.options)).join(" ").split(/\s+/).map(d=>bO(d,this.options));i&&(a=a.filter(d=>(J("loose invalid filter",d,this.options),!!d.match(Re[we.COMPARATORLOOSE])))),J("range list",a);let c=new Map,l=a.map(d=>new uu(d,this.options));for(let d of l){if(Ev(d))return[d];c.set(d.value,d)}c.size>1&&c.has("")&&c.delete("");let u=[...c.values()];return _v.set(n,u),u}intersects(t,r){if(!(t instanceof Ut))throw new TypeError("a Range is required");return this.set.some(n=>Av(n,r)&&t.set.some(o=>Av(o,r)&&n.every(i=>o.every(s=>i.intersects(s,r)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new iO(t,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(_O(this.set[r],t,this.options))return!0;return!1}};Rv.exports=Ut;var nO=Sv(),_v=new nO,oO=vs(),uu=qn(),J=In(),iO=ye(),{safeRe:Re,t:we,comparatorTrimReplace:sO,tildeTrimReplace:aO,caretTrimReplace:cO}=xr(),{FLAG_INCLUDE_PRERELEASE:lO,FLAG_LOOSE:uO}=Tn(),Ev=e=>e.value==="<0.0.0-0",dO=e=>e.value==="",Av=(e,t)=>{let r=!0,n=e.slice(),o=n.pop();for(;r&&n.length;)r=n.every(i=>o.intersects(i,t)),o=n.pop();return r},fO=(e,t)=>(J("comp",e,t),e=mO(e,t),J("caret",e),e=pO(e,t),J("tildes",e),e=gO(e,t),J("xrange",e),e=wO(e,t),J("stars",e),e),be=e=>!e||e.toLowerCase()==="x"||e==="*",pO=(e,t)=>e.trim().split(/\s+/).map(r=>hO(r,t)).join(" "),hO=(e,t)=>{let r=t.loose?Re[we.TILDELOOSE]:Re[we.TILDE];return e.replace(r,(n,o,i,s,a)=>{J("tilde",e,n,o,i,s,a);let c;return be(o)?c="":be(i)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:be(s)?c=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:a?(J("replaceTilde pr",a),c=`>=${o}.${i}.${s}-${a} <${o}.${+i+1}.0-0`):c=`>=${o}.${i}.${s} <${o}.${+i+1}.0-0`,J("tilde return",c),c})},mO=(e,t)=>e.trim().split(/\s+/).map(r=>yO(r,t)).join(" "),yO=(e,t)=>{J("caret",e,t);let r=t.loose?Re[we.CARETLOOSE]:Re[we.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(o,i,s,a,c)=>{J("caret",e,o,i,s,a,c);let l;return be(i)?l="":be(s)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:be(a)?i==="0"?l=`>=${i}.${s}.0${n} <${i}.${+s+1}.0-0`:l=`>=${i}.${s}.0${n} <${+i+1}.0.0-0`:c?(J("replaceCaret pr",c),i==="0"?s==="0"?l=`>=${i}.${s}.${a}-${c} <${i}.${s}.${+a+1}-0`:l=`>=${i}.${s}.${a}-${c} <${i}.${+s+1}.0-0`:l=`>=${i}.${s}.${a}-${c} <${+i+1}.0.0-0`):(J("no pr"),i==="0"?s==="0"?l=`>=${i}.${s}.${a}${n} <${i}.${s}.${+a+1}-0`:l=`>=${i}.${s}.${a}${n} <${i}.${+s+1}.0-0`:l=`>=${i}.${s}.${a} <${+i+1}.0.0-0`),J("caret return",l),l})},gO=(e,t)=>(J("replaceXRanges",e,t),e.split(/\s+/).map(r=>vO(r,t)).join(" ")),vO=(e,t)=>{e=e.trim();let r=t.loose?Re[we.XRANGELOOSE]:Re[we.XRANGE];return e.replace(r,(n,o,i,s,a,c)=>{J("xRange",e,n,o,i,s,a,c);let l=be(i),u=l||be(s),d=u||be(a),h=d;return o==="="&&h&&(o=""),c=t.includePrerelease?"-0":"",l?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&h?(u&&(s=0),a=0,o===">"?(o=">=",u?(i=+i+1,s=0,a=0):(s=+s+1,a=0)):o==="<="&&(o="<",u?i=+i+1:s=+s+1),o==="<"&&(c="-0"),n=`${o+i}.${s}.${a}${c}`):u?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${s}.0${c} <${i}.${+s+1}.0-0`),J("xRange return",n),n})},wO=(e,t)=>(J("replaceStars",e,t),e.trim().replace(Re[we.STAR],"")),bO=(e,t)=>(J("replaceGTE0",e,t),e.trim().replace(Re[t.includePrerelease?we.GTE0PRE:we.GTE0],"")),SO=e=>(t,r,n,o,i,s,a,c,l,u,d,h)=>(be(n)?r="":be(o)?r=`>=${n}.0.0${e?"-0":""}`:be(i)?r=`>=${n}.${o}.0${e?"-0":""}`:s?r=`>=${r}`:r=`>=${r}${e?"-0":""}`,be(l)?c="":be(u)?c=`<${+l+1}.0.0-0`:be(d)?c=`<${l}.${+u+1}.0-0`:h?c=`<=${l}.${u}.${d}-${h}`:e?c=`<${l}.${u}.${+d+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),_O=(e,t,r)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let n=0;n<e.length;n++)if(J(e[n].semver),e[n].semver!==uu.ANY&&e[n].semver.prerelease.length>0){let o=e[n].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}});var qn=p((BN,Iv)=>{var Mn=Symbol("SemVer ANY"),Tr=class{static get ANY(){return Mn}constructor(t,r){if(r=Cv(r),t instanceof Tr){if(t.loose===!!r.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),fu("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===Mn?this.value="":this.value=this.operator+this.semver.version,fu("comp",this)}parse(t){let r=this.options.loose?Pv[xv.COMPARATORLOOSE]:Pv[xv.COMPARATOR],n=t.match(r);if(!n)throw new TypeError(`Invalid comparator: ${t}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Ov(n[2],this.options.loose):this.semver=Mn}toString(){return this.value}test(t){if(fu("Comparator.test",t,this.options.loose),this.semver===Mn||t===Mn)return!0;if(typeof t=="string")try{t=new Ov(t,this.options)}catch{return!1}return du(t,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof Tr))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Tv(t.value,r).test(this.value):t.operator===""?t.value===""?!0:new Tv(this.value,r).test(t.semver):(r=Cv(r),r.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||du(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||du(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};Iv.exports=Tr;var Cv=vs(),{safeRe:Pv,t:xv}=xr(),du=cu(),fu=In(),Ov=ye(),Tv=Te()});var kn=p((JN,Hv)=>{var EO=Te(),AO=(e,t,r)=>{try{t=new EO(t,r)}catch{return!1}return t.test(e)};Hv.exports=AO});var Mv=p((VN,qv)=>{var RO=Te(),CO=(e,t)=>new RO(e,t).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));qv.exports=CO});var Dv=p((GN,kv)=>{var PO=ye(),xO=Te(),OO=(e,t,r)=>{let n=null,o=null,i=null;try{i=new xO(t,r)}catch{return null}return e.forEach(s=>{i.test(s)&&(!n||o.compare(s)===-1)&&(n=s,o=new PO(n,r))}),n};kv.exports=OO});var $v=p((zN,Lv)=>{var TO=ye(),IO=Te(),HO=(e,t,r)=>{let n=null,o=null,i=null;try{i=new IO(t,r)}catch{return null}return e.forEach(s=>{i.test(s)&&(!n||o.compare(s)===1)&&(n=s,o=new TO(n,r))}),n};Lv.exports=HO});var Fv=p((XN,Uv)=>{var pu=ye(),qO=Te(),Nv=Hn(),MO=(e,t)=>{e=new qO(e,t);let r=new pu("0.0.0");if(e.test(r)||(r=new pu("0.0.0-0"),e.test(r)))return r;r=null;for(let n=0;n<e.set.length;++n){let o=e.set[n],i=null;o.forEach(s=>{let a=new pu(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Nv(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),i&&(!r||Nv(r,i))&&(r=i)}return r&&e.test(r)?r:null};Uv.exports=MO});var jv=p((YN,Kv)=>{var kO=Te(),DO=(e,t)=>{try{return new kO(e,t).range||"*"}catch{return null}};Kv.exports=DO});var xs=p((QN,Vv)=>{var LO=ye(),Jv=qn(),{ANY:$O}=Jv,NO=Te(),UO=kn(),Wv=Hn(),Bv=Es(),FO=Rs(),KO=As(),jO=(e,t,r,n)=>{e=new LO(e,n),t=new NO(t,n);let o,i,s,a,c;switch(r){case">":o=Wv,i=FO,s=Bv,a=">",c=">=";break;case"<":o=Bv,i=KO,s=Wv,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(UO(e,t,n))return!1;for(let l=0;l<t.set.length;++l){let u=t.set[l],d=null,h=null;if(u.forEach(f=>{f.semver===$O&&(f=new Jv(">=0.0.0")),d=d||f,h=h||f,o(f.semver,d.semver,n)?d=f:s(f.semver,h.semver,n)&&(h=f)}),d.operator===a||d.operator===c||(!h.operator||h.operator===a)&&i(e,h.semver))return!1;if(h.operator===c&&s(e,h.semver))return!1}return!0};Vv.exports=jO});var zv=p((ZN,Gv)=>{var WO=xs(),BO=(e,t,r)=>WO(e,t,">",r);Gv.exports=BO});var Yv=p((eU,Xv)=>{var JO=xs(),VO=(e,t,r)=>JO(e,t,"<",r);Xv.exports=VO});var ew=p((tU,Zv)=>{var Qv=Te(),GO=(e,t,r)=>(e=new Qv(e,r),t=new Qv(t,r),e.intersects(t,r));Zv.exports=GO});var rw=p((rU,tw)=>{var zO=kn(),XO=Oe();tw.exports=(e,t,r)=>{let n=[],o=null,i=null,s=e.sort((u,d)=>XO(u,d,r));for(let u of s)zO(u,t,r)?(i=u,o||(o=u)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let a=[];for(let[u,d]of n)u===d?a.push(u):!d&&u===s[0]?a.push("*"):d?u===s[0]?a.push(`<=${d}`):a.push(`${u} - ${d}`):a.push(`>=${u}`);let c=a.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return c.length<l.length?c:t}});var cw=p((nU,aw)=>{var nw=Te(),mu=qn(),{ANY:hu}=mu,Dn=kn(),yu=Oe(),YO=(e,t,r={})=>{if(e===t)return!0;e=new nw(e,r),t=new nw(t,r);let n=!1;e:for(let o of e.set){for(let i of t.set){let s=ZO(o,i,r);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},QO=[new mu(">=0.0.0-0")],ow=[new mu(">=0.0.0")],ZO=(e,t,r)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===hu){if(t.length===1&&t[0].semver===hu)return!0;r.includePrerelease?e=QO:e=ow}if(t.length===1&&t[0].semver===hu){if(r.includePrerelease)return!0;t=ow}let n=new Set,o,i;for(let f of e)f.operator===">"||f.operator===">="?o=iw(o,f,r):f.operator==="<"||f.operator==="<="?i=sw(i,f,r):n.add(f.semver);if(n.size>1)return null;let s;if(o&&i){if(s=yu(o.semver,i.semver,r),s>0)return null;if(s===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let f of n){if(o&&!Dn(f,String(o),r)||i&&!Dn(f,String(i),r))return null;for(let m of t)if(!Dn(f,String(m),r))return!1;return!0}let a,c,l,u,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,h=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let f of t){if(u=u||f.operator===">"||f.operator===">=",l=l||f.operator==="<"||f.operator==="<=",o){if(h&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===h.major&&f.semver.minor===h.minor&&f.semver.patch===h.patch&&(h=!1),f.operator===">"||f.operator===">="){if(a=iw(o,f,r),a===f&&a!==o)return!1}else if(o.operator===">="&&!Dn(o.semver,String(f),r))return!1}if(i){if(d&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===d.major&&f.semver.minor===d.minor&&f.semver.patch===d.patch&&(d=!1),f.operator==="<"||f.operator==="<="){if(c=sw(i,f,r),c===f&&c!==i)return!1}else if(i.operator==="<="&&!Dn(i.semver,String(f),r))return!1}if(!f.operator&&(i||o)&&s!==0)return!1}return!(o&&l&&!i&&s!==0||i&&u&&!o&&s!==0||h||d)},iw=(e,t,r)=>{if(!e)return t;let n=yu(e.semver,t.semver,r);return n>0?e:n<0||t.operator===">"&&e.operator===">="?t:e},sw=(e,t,r)=>{if(!e)return t;let n=yu(e.semver,t.semver,r);return n<0?e:n>0||t.operator==="<"&&e.operator==="<="?t:e};aw.exports=YO});var fw=p((oU,dw)=>{var gu=xr(),lw=Tn(),eT=ye(),uw=iu(),tT=Nt(),rT=Dg(),nT=$g(),oT=Fg(),iT=Wg(),sT=Jg(),aT=Gg(),cT=Xg(),lT=Qg(),uT=Oe(),dT=rv(),fT=ov(),pT=_s(),hT=cv(),mT=uv(),yT=Hn(),gT=Es(),vT=su(),wT=au(),bT=As(),ST=Rs(),_T=cu(),ET=wv(),AT=qn(),RT=Te(),CT=kn(),PT=Mv(),xT=Dv(),OT=$v(),TT=Fv(),IT=jv(),HT=xs(),qT=zv(),MT=Yv(),kT=ew(),DT=rw(),LT=cw();dw.exports={parse:tT,valid:rT,clean:nT,inc:oT,diff:iT,major:sT,minor:aT,patch:cT,prerelease:lT,compare:uT,rcompare:dT,compareLoose:fT,compareBuild:pT,sort:hT,rsort:mT,gt:yT,lt:gT,eq:vT,neq:wT,gte:bT,lte:ST,cmp:_T,coerce:ET,Comparator:AT,Range:RT,satisfies:CT,toComparators:PT,maxSatisfying:xT,minSatisfying:OT,minVersion:TT,validRange:IT,outside:HT,gtr:qT,ltr:MT,intersects:kT,simplifyRange:DT,subset:LT,SemVer:eT,re:gu.re,src:gu.src,tokens:gu.t,SEMVER_SPEC_VERSION:lw.SEMVER_SPEC_VERSION,RELEASE_TYPES:lw.RELEASE_TYPES,compareIdentifiers:uw.compareIdentifiers,rcompareIdentifiers:uw.rcompareIdentifiers}});var pw=p(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});var $T=fw(),NT=Le(),UT=al();function FT(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var KT=FT($T);function jT(e){let t={package:"shopify-app"},r=(o,i={})=>e.warning(o,{...t,...i});function n(o){return function(i,s){if(KT.default.gte(UT.SHOPIFY_REMIX_LIBRARY_VERSION,i))throw new NT.FeatureDeprecatedError(`Feature was deprecated in version ${i}`);return o(`[Deprecated | ${i}] ${s}`)}}return{...e,log:(o,i,s={})=>e.log(o,i,{...t,...s}),debug:(o,i={})=>e.debug(o,{...t,...i}),info:(o,i={})=>e.info(o,{...t,...i}),warning:r,error:(o,i={})=>e.error(o,{...t,...i}),deprecated:n(r)}}vu.overrideLogger=jT});var mw=p(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});var WT=(Pt(),P(Ct)),hw=Xi();function BT(e){let{api:t,config:r,logger:n}=e;return async function(i){let a=new URL(i.url).searchParams.get("shop");if(i.method==="GET"&&!a)return{};let c=a||(await i.formData()).get("shop");if(!c)return n.debug("Missing shop parameter",{shop:c}),{shop:hw.LoginErrorType.MissingShop};let l=c.replace(/^https?:\/\//,"").replace(/\/$/,""),u=c?.indexOf(".")===-1?`${l}.myshopify.com`:l,d=t.utils.sanitizeShop(u);if(!d)return n.debug("Invalid shop parameter",{shop:c}),{shop:hw.LoginErrorType.InvalidShop};let h=`${r.appUrl}${r.auth.path}?shop=${d}`;throw n.info(`Redirecting login request to ${h}`,{shop:d}),WT.redirect(h)}}wu.loginFactory=BT});var Su=p(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});async function JT(e,{api:t,config:r}){let n=t.session.getOfflineId(e);return await r.sessionStorage.loadSession(n)}bu.getOfflineSession=JT});var yw=p(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});var VT=Le(),GT=cs(),zT=Su();function XT(e){return async t=>{let r=await zT.getOfflineSession(t,e);if(!r)throw new VT.ShopifyError(`Could not find a session for shop ${t} when creating unauthenticated admin context`);return{session:r,admin:GT.adminClientFactory({params:e,session:r})}}}_u.unauthenticatedAdminContextFactory=XT});var gw=p(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});var YT=ds(),QT=kl(),ZT=fs(),e1=$l(),t1=Ul();function r1(e){return async function(r,n={}){var o;let{logger:i}=e,s=(o=n.corsHeaders)!==null&&o!==void 0?o:[];e1.rejectBotRequest(e,r),t1.respondToOptionsRequest(e,r,s);let a=ZT.getSessionTokenHeader(r);if(i.info("Authenticating checkout request"),!a)throw i.debug("Request did not contain a session token"),new Response(void 0,{status:401,statusText:"Unauthorized"});return{sessionToken:await QT.validateSessionToken(e,a,{checkAudience:!1}),cors:YT.ensureCORSHeadersFactory(e,r,s)}}}Eu.authenticateCheckoutFactory=r1});var Ru=p(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});var n1=Bt();function o1({params:e,session:t}){let{api:r}=e;return{graphql:async(n,o={})=>{let s=await new r.clients.Storefront({session:t,apiVersion:o.apiVersion}).query({data:{query:n,variables:o?.variables},tries:o.tries,extraHeaders:o.headers});return new Response(JSON.stringify(s.body),{headers:n1.flatHeaders(s.headers)})}}}Au.storefrontClientFactory=o1});var ww=p(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});var i1=cs(),s1=Ru();function a1(e){let{api:t,config:r,logger:n}=e;return async function(i){n.info("Authenticating app proxy request");let{searchParams:s}=new URL(i.url),a=Object.fromEntries(s.entries()),c=!1;try{c=await t.utils.validateHmac(a,{signator:"appProxy"})}catch(f){throw n.info(f.message),new Response(void 0,{status:400,statusText:"Bad Request"})}if(!c)throw n.info("App proxy request has invalid signature"),new Response(void 0,{status:400,statusText:"Bad Request"});let l=s.get("shop"),u=t.session.getOfflineId(l),d=await r.sessionStorage.loadSession(u);return d?{liquid:vw,session:d,admin:i1.adminClientFactory({params:e,session:d}),storefront:s1.storefrontClientFactory({params:e,session:d})}:{liquid:vw,session:void 0,admin:void 0,storefront:void 0}}}var vw=(e,t)=>{if(typeof t!="object")return new Response(e,{status:t||200,headers:{"Content-Type":"application/liquid"}});let{layout:r,...n}=t||{},o=r===!1?`{% layout none %} ${e}`:e,i=new Headers(n.headers);return i.set("Content-Type","application/liquid"),new Response(o,{...n,headers:i})};Cu.authenticateAppProxyFactory=a1});var bw=p(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var c1=gw(),l1=ww();function u1(e){let{logger:t}=e,r=c1.authenticateCheckoutFactory(e),n=(o,i)=>(t.deprecated("2.0.0","authenticate.public() will be deprecated in v2. Use authenticate.public.checkout() instead."),r(o,i));return n.checkout=r,n.appProxy=l1.authenticateAppProxyFactory(e),n}Pu.authenticatePublicFactory=u1});var Sw=p(xu=>{"use strict";Object.defineProperty(xu,"__esModule",{value:!0});var d1=Le(),f1=Ru(),p1=Su();function h1(e){return async t=>{let r=await p1.getOfflineSession(t,e);if(!r)throw new d1.ShopifyError(`Could not find a session for shop ${t} when creating unauthenticated storefront context`);return{session:r,storefront:f1.storefrontClientFactory({params:e,session:r})}}}xu.unauthenticatedStorefrontContextFactory=h1});var _w=p(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Aa();var Os=Le(),Ln=Xi(),m1=al(),y1=qm(),g1=bg(),v1=Sg(),w1=pw(),b1=Xl();Fo();var S1=mw(),_1=yw(),E1=bw(),A1=Sw();function R1(e){let t=x1(e),r=O1(e,t.config),n=w1.overrideLogger(t.logger);e.webhooks&&t.webhooks.addHandlers(e.webhooks);let o={api:t,config:r,logger:n},i=new g1.AuthStrategy(o),s={sessionStorage:r.sessionStorage,addDocumentResponseHeaders:b1.addDocumentResponseHeadersFactory(o),registerWebhooks:y1.registerWebhooksFactory(o),authenticate:{admin:i.authenticateAdmin.bind(i),public:E1.authenticatePublicFactory(o),webhook:v1.authenticateWebhookFactory(o)},unauthenticated:{admin:_1.unauthenticatedAdminContextFactory(o),storefront:A1.unauthenticatedStorefrontContextFactory(o)}};return(C1(s,e)||P1(s,e))&&(s.login=S1.loginFactory(o)),s}function C1(e,t){return t.distribution===Ln.AppDistribution.AppStore}function P1(e,t){return t.distribution===Ln.AppDistribution.SingleMerchant}function x1(e){var t,r;let n;try{n=new URL(e.appUrl)}catch{throw new Os.ShopifyError("Invalid appUrl provided. Please provide a valid URL.")}n.hostname==="localhost"&&!n.port&&process.env.PORT&&(n.port=process.env.PORT),e.appUrl=n.origin;let o=`Shopify Remix Library v${m1.SHOPIFY_REMIX_LIBRARY_VERSION}`;e.userAgentPrefix&&(o=`${e.userAgentPrefix} | ${o}`);let i={...e,hostName:n.host,hostScheme:n.protocol.replace(":",""),userAgentPrefix:o,isEmbeddedApp:(t=e.isEmbeddedApp)!==null&&t!==void 0?t:!0,apiVersion:(r=e.apiVersion)!==null&&r!==void 0?r:Os.LATEST_API_VERSION,isCustomStoreApp:e.distribution===Ln.AppDistribution.ShopifyAdmin};return Os.shopifyApi(i)}function O1(e,t){var r,n,o;if(!e.sessionStorage)throw new Os.ShopifyError("Please provide a valid session storage. Refer to https://github.com/Shopify/shopify-app-js/blob/main/README.md#session-storage-options for options.");let i=e.authPathPrefix||"/auth";return e.distribution=(r=e.distribution)!==null&&r!==void 0?r:Ln.AppDistribution.AppStore,{...e,...t,canUseLoginForm:e.distribution!==Ln.AppDistribution.ShopifyAdmin,useOnlineTokens:(n=e.useOnlineTokens)!==null&&n!==void 0?n:!1,hooks:(o=e.hooks)!==null&&o!==void 0?o:{},sessionStorage:e.sessionStorage,auth:{path:i,callbackPath:`${i}/callback`,patchSessionTokenPath:`${i}/session-token`,exitIframePath:`${i}/exit-iframe`,loginPath:`${i}/login`}}}Ou.shopifyApp=R1});var q1=p(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Aa();var T1=Bt(),$n=Le(),Ew=Xi(),I1=Hm(),H1=_w();T1.setAbstractRuntimeString(()=>"Remix");Object.defineProperty(Ne,"ApiVersion",{enumerable:!0,get:function(){return $n.ApiVersion}});Object.defineProperty(Ne,"BillingInterval",{enumerable:!0,get:function(){return $n.BillingInterval}});Object.defineProperty(Ne,"DeliveryMethod",{enumerable:!0,get:function(){return $n.DeliveryMethod}});Object.defineProperty(Ne,"LATEST_API_VERSION",{enumerable:!0,get:function(){return $n.LATEST_API_VERSION}});Object.defineProperty(Ne,"LogSeverity",{enumerable:!0,get:function(){return $n.LogSeverity}});Ne.AppDistribution=Ew.AppDistribution;Ne.LoginErrorType=Ew.LoginErrorType;Ne.boundary=I1.boundary;Ne.shopifyApp=H1.shopifyApp});export{Zw as a,q1 as b};
/*! Bundled license information:

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

@remix-run/server-runtime/dist/esm/warnings.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/cookies.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/formData.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/router/dist/router.js:
  (**
   * @remix-run/router v1.7.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/mode.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/errors.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/responses.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/entry.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/headers.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/invariant.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/routeMatching.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/data.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/routes.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/markup.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/serverHandoff.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/server.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions/cookieStorage.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions/memoryStorage.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/upload/errors.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/upload/memoryUploadHandler.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/dev.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/index.js:
  (**
   * @remix-run/server-runtime v1.19.3
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)
*/
